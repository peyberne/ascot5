<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: asigma/asigma_loc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0e13d5bea10d90f44ddddde8e7c2e8e5.html">asigma</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">asigma_loc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="asigma__loc_8c.html" title="Atomic reaction data from local files.">asigma_loc.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ascot5_8h_source.html">../ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">../error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interp_8h_source.html">../spline/interp.h</a>&quot;</code><br />
</div>
<p><a href="asigma__loc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structasigma__loc__offload__data.html">asigma_loc_offload_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local-files atomic reaction offload data.  <a href="structasigma__loc__offload__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structasigma__loc__data.html">asigma_loc_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local-files atomic reaction simulation data.  <a href="structasigma__loc__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad6ae96a2cb0590cd50dfa7d4141177fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asigma__loc_8h.html#ad6ae96a2cb0590cd50dfa7d4141177fb">asigma_loc_init_offload</a> (<a class="el" href="structasigma__loc__offload__data.html">asigma_loc_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:ad6ae96a2cb0590cd50dfa7d4141177fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize local file atomic data and check inputs.  <a href="asigma__loc_8h.html#ad6ae96a2cb0590cd50dfa7d4141177fb">More...</a><br /></td></tr>
<tr class="separator:ad6ae96a2cb0590cd50dfa7d4141177fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a7a72ac7558be5dc0868c54e1de880c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asigma__loc_8h.html#a0a7a72ac7558be5dc0868c54e1de880c">asigma_loc_free_offload</a> (<a class="el" href="structasigma__loc__offload__data.html">asigma_loc_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:a0a7a72ac7558be5dc0868c54e1de880c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free offload array and reset parameters.  <a href="asigma__loc_8h.html#a0a7a72ac7558be5dc0868c54e1de880c">More...</a><br /></td></tr>
<tr class="separator:a0a7a72ac7558be5dc0868c54e1de880c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b81320e02a2e9f940098fe4398b0751"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asigma__loc_8h.html#a6b81320e02a2e9f940098fe4398b0751">asigma_loc_init</a> (<a class="el" href="structasigma__loc__data.html">asigma_loc_data</a> *asgm_loc_data, <a class="el" href="structasigma__loc__offload__data.html">asigma_loc_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *offload_array)</td></tr>
<tr class="memdesc:a6b81320e02a2e9f940098fe4398b0751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize atomic reaction data struct on target.  <a href="asigma__loc_8h.html#a6b81320e02a2e9f940098fe4398b0751">More...</a><br /></td></tr>
<tr class="separator:a6b81320e02a2e9f940098fe4398b0751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f227311a33867c2430c1c32232f498"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asigma__loc_8h.html#aa2f227311a33867c2430c1c32232f498">asigma_loc_eval_sigma</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *sigma, int z_1, int a_1, int z_2, int a_2, int reac_type, <a class="el" href="structasigma__loc__data.html">asigma_loc_data</a> *asgm_loc_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> E_coll_per_amu, int *enable_atomic)</td></tr>
<tr class="memdesc:aa2f227311a33867c2430c1c32232f498"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate atomic reaction cross-section.  <a href="asigma__loc_8h.html#aa2f227311a33867c2430c1c32232f498">More...</a><br /></td></tr>
<tr class="separator:aa2f227311a33867c2430c1c32232f498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae93bf78b3c379165625874f2bdb22106"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="asigma__loc_8h.html#ae93bf78b3c379165625874f2bdb22106">asigma_loc_eval_sigmav</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *sigmav, int z_1, int a_1, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> m_1, int z_2, int a_2, int reac_type, <a class="el" href="structasigma__loc__data.html">asigma_loc_data</a> *asgm_loc_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> E, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> T_e, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> T_0, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> n_i, int *enable_atomic)</td></tr>
<tr class="memdesc:ae93bf78b3c379165625874f2bdb22106"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate atomic reaction rate coefficient.  <a href="asigma__loc_8h.html#ae93bf78b3c379165625874f2bdb22106">More...</a><br /></td></tr>
<tr class="separator:ae93bf78b3c379165625874f2bdb22106"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="asigma__loc_8c.html" title="Atomic reaction data from local files.">asigma_loc.c</a>. </p>

<p class="definition">Definition in file <a class="el" href="asigma__loc_8h_source.html">asigma_loc.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad6ae96a2cb0590cd50dfa7d4141177fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6ae96a2cb0590cd50dfa7d4141177fb">&#9670;&nbsp;</a></span>asigma_loc_init_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int asigma_loc_init_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structasigma__loc__offload__data.html">asigma_loc_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize local file atomic data and check inputs. </p>
<p>Before calling this function, the offload struct is expected to be fully initialized.</p>
<p>The offload array is expected to hold atomic data as [0] = znum for fast particle species [N_reac] = anum for fast particle species [2*N_reac] = znum for bulk particle species [3*N_reac] = anum for bulk particle species [4*N_reac] = reaction type [5*N_reac] = dimension of energy abscissa (N_E) [6*N_reac] = min value of energy abscissa [eV] [7*N_reac] = max value of energy abscissa [eV] [8*N_reac] = dimension of density abscissa (N_n) [9*N_reac] = min value of density abscissa [m^-3] [10*N_reac] = max value of density abscissa [m^-3] [11*N_reac] = dimension of temperature abscissa (N_T) [12*N_reac] = min value of temperature abscissa [eV] [13*N_reac] = max value of temperature abscissa [eV] [14*N_reac] = reaction probability data [(depends on reaction data type)] Each piece of data listed above is repeated for each reaction included. Hence the N_reac interval between the 14 first pieces of data. The memory space required for the last, reaction probability data, depends on the dimensionality of the abscissae. The memory requirement for the reaction data of the i_reac:th reaction is N_E[i_reac]*N_n[i_reac]*N_T[i_reac].</p>
<p>This function initializes splines to atomic reaction data, thus increasing the length of the offload array, and prints some values as sanity checks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if initialization success</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>In the part where the spline interpolations of the reaction data are initialized, it is assumed that, when there is one abscissa, it is energy, when there are two abscissae, they are, in order, energy and temperature, and, when there are three abscissae, they are, in order, energy, density and temperature. In the future, this may need to be made more general. For example, where we check the N:s, we can also extract and reorder the min:s and max:s depending on which N &gt; 1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="asigma__loc_8c_source.html#l00064">64</a> of file <a class="el" href="asigma__loc_8c_source.html">asigma_loc.c</a>.</p>

</div>
</div>
<a id="a0a7a72ac7558be5dc0868c54e1de880c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a7a72ac7558be5dc0868c54e1de880c">&#9670;&nbsp;</a></span>asigma_loc_free_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void asigma_loc_free_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structasigma__loc__offload__data.html">asigma_loc_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free offload array and reset parameters. </p>
<p>This function deallocates the offload_array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="asigma__loc_8c_source.html#l00229">229</a> of file <a class="el" href="asigma__loc_8c_source.html">asigma_loc.c</a>.</p>

</div>
</div>
<a id="a6b81320e02a2e9f940098fe4398b0751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b81320e02a2e9f940098fe4398b0751">&#9670;&nbsp;</a></span>asigma_loc_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void asigma_loc_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structasigma__loc__data.html">asigma_loc_data</a> *&#160;</td>
          <td class="paramname"><em>asgm_loc_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structasigma__loc__offload__data.html">asigma_loc_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize atomic reaction data struct on target. </p>
<p>This function copies atomic reaction data from the offload struct and the offload array to the struct on the target, and uses interpXDcomp_init_spline() functions to initialize the precalculated spline parameters of the reaction data in the spline structs within the data struct on the target.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">asgm_loc_data</td><td>pointer to data struct on target </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd><p class="startdd">Should we change from using reac_avail flag to having in asgm_data only those reactions that are available and truly initialized? Actually, that is already done, reac_avail is a relic. However, we might want to use reac_avail for something. </p>
<p class="interdd">Can we avoid the excess memory usage currently resulting from allocating all three spline structs for each reaction? </p>
<p class="enddd">(Same as above in <a class="el" href="asigma__loc_8c.html#ad6ae96a2cb0590cd50dfa7d4141177fb" title="Initialize local file atomic data and check inputs.">asigma_loc_init_offload()</a>) In the part where the spline interpolations of the reaction data are initialized, it is assumed that, when there is one abscissa, it is energy, when there are two abscissae, they are, in order, energy and temperature, and, when there are three abscissae, they are, in order, energy, density and temperature. In the future, this may need to be made more general. For example, where we check the N:s, we can also extract and reorder the min:s and max:s depending on which N &gt; 1. </p>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="asigma__loc_8c_source.html#l00263">263</a> of file <a class="el" href="asigma__loc_8c_source.html">asigma_loc.c</a>.</p>

</div>
</div>
<a id="aa2f227311a33867c2430c1c32232f498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2f227311a33867c2430c1c32232f498">&#9670;&nbsp;</a></span>asigma_loc_eval_sigma()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> asigma_loc_eval_sigma </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reac_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structasigma__loc__data.html">asigma_loc_data</a> *&#160;</td>
          <td class="paramname"><em>asgm_loc_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>E_coll_per_amu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>enable_atomic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate atomic reaction cross-section. </p>
<p>This function evaluates the cross-section (sigma) for the atomic reaction corresponding to the reaction identifiers given as parameters at the given mass-normalized collision energy.</p>
<p>This is a SIMD function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sigma</td><td>pointer to evaluated cross-section </td></tr>
    <tr><td class="paramname">z_1</td><td>atomic number of fast particle </td></tr>
    <tr><td class="paramname">a_1</td><td>atomic mass number of fast particle </td></tr>
    <tr><td class="paramname">z_2</td><td>atomic number of bulk particle </td></tr>
    <tr><td class="paramname">a_2</td><td>atomic mass number of bulk particle </td></tr>
    <tr><td class="paramname">reac_type</td><td>reaction type </td></tr>
    <tr><td class="paramname">asgm_loc_data</td><td>pointer to atomic data struct </td></tr>
    <tr><td class="paramname">E_coll_per_amu</td><td>energy per amu corresponding to collision speed </td></tr>
    <tr><td class="paramname">enable_atomic</td><td>pointer to atomic enable and functionality flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if evaluation succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="asigma__loc_8c_source.html#l00398">398</a> of file <a class="el" href="asigma__loc_8c_source.html">asigma_loc.c</a>.</p>

</div>
</div>
<a id="ae93bf78b3c379165625874f2bdb22106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae93bf78b3c379165625874f2bdb22106">&#9670;&nbsp;</a></span>asigma_loc_eval_sigmav()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> asigma_loc_eval_sigmav </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>sigmav</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>m_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reac_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structasigma__loc__data.html">asigma_loc_data</a> *&#160;</td>
          <td class="paramname"><em>asgm_loc_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>T_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>T_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>n_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>enable_atomic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate atomic reaction rate coefficient. </p>
<p>This function evaluates the rate coefficient (&lt;sigma*v&gt;) for the atomic reaction corresponding to the reaction identifiers given as parameters at the given fast particle energy and bulk plasma conditions.</p>
<p>This is a SIMD function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sigmav</td><td>pointer to evaluated rate coefficient </td></tr>
    <tr><td class="paramname">z_1</td><td>atomic number of fast particle </td></tr>
    <tr><td class="paramname">a_1</td><td>atomic mass number of fast particle </td></tr>
    <tr><td class="paramname">m_1</td><td>mass of fast particle </td></tr>
    <tr><td class="paramname">z_2</td><td>atomic number of bulk particle </td></tr>
    <tr><td class="paramname">a_2</td><td>atomic mass number of bulk particle </td></tr>
    <tr><td class="paramname">reac_type</td><td>reaction type </td></tr>
    <tr><td class="paramname">asgm_loc_data</td><td>pointer to atomic data struct </td></tr>
    <tr><td class="paramname">E</td><td>energy of fast particle </td></tr>
    <tr><td class="paramname">T_e</td><td>electron temperature of bulk plasma </td></tr>
    <tr><td class="paramname">T_0</td><td>temperature of bulk neutrals </td></tr>
    <tr><td class="paramname">n_i</td><td>ion density of bulk plasma </td></tr>
    <tr><td class="paramname">enable_atomic</td><td>pointer to atomic enable and functionality flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if evaluation succeeded</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Is there a cleaner and more general way to handle the isotopic invariance of beam-stopping data? </dd></dl>

<p class="definition">Definition at line <a class="el" href="asigma__loc_8c_source.html#l00490">490</a> of file <a class="el" href="asigma__loc_8c_source.html">asigma_loc.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
