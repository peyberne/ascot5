<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="diag_8c" kind="file" language="C++">
    <compoundname>diag.c</compoundname>
    <includes local="no">stdio.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">string.h</includes>
    <includes refid="ascot5_8h" local="yes">ascot5.h</includes>
    <includes refid="simulate_8h" local="yes">simulate.h</includes>
    <includes refid="B__field_8h" local="yes">B_field.h</includes>
    <includes refid="diag_8h" local="yes">diag.h</includes>
    <includes refid="diag__orb_8h" local="yes">diag/diag_orb.h</includes>
    <includes refid="dist__5D_8h" local="yes">diag/dist_5D.h</includes>
    <includes refid="dist__6D_8h" local="yes">diag/dist_6D.h</includes>
    <includes refid="dist__rho5D_8h" local="yes">diag/dist_rho5D.h</includes>
    <includes refid="dist__rho6D_8h" local="yes">diag/dist_rho6D.h</includes>
    <includes refid="dist__com_8h" local="yes">diag/dist_com.h</includes>
    <includes refid="diag__transcoef_8h" local="yes">diag/diag_transcoef.h</includes>
    <includes refid="particle_8h" local="yes">particle.h</includes>
    <incdepgraph>
      <node id="44">
        <label>diag/dist_rho5D.h</label>
        <link refid="dist__rho5D_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>plasma.h</label>
        <link refid="plasma_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
      </node>
      <node id="42">
        <label>diag/dist_5D.h</label>
        <link refid="dist__5D_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>diag.c</label>
        <link refid="diag_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="39">
        <label>particle.h</label>
        <link refid="particle_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="41">
        <label>diag.h</label>
        <link refid="diag_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>../spline/interp.h</label>
        <link refid="interp_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>simulate.h</label>
        <link refid="simulate_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>Bfield/B_GS.h</label>
        <link refid="B__GS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="29">
        <label>wall.h</label>
        <link refid="wall_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
      </node>
      <node id="36">
        <label>asigma.h</label>
        <link refid="asigma_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>plasma/plasma_1DS.h</label>
        <link refid="plasma__1DS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="35">
        <label>mhd/mhd_nonstat.h</label>
        <link refid="mhd__nonstat_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>stdlib.h</label>
      </node>
      <node id="50">
        <label>simulate/mccc/mccc.h</label>
        <link refid="mccc_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
      </node>
      <node id="37">
        <label>asigma/asigma_loc.h</label>
        <link refid="asigma__loc_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="38">
        <label>nbi.h</label>
        <link refid="nbi_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
      </node>
      <node id="47">
        <label>diag/diag_orb.h</label>
        <link refid="diag__orb_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>omp.h</label>
      </node>
      <node id="51">
        <label>mccc_wiener.h</label>
        <link refid="mccc__wiener_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="28">
        <label>neutral/N0_3D.h</label>
        <link refid="N0__3D_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>B_field.h</label>
        <link refid="B__field_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>mhd/mhd_stat.h</label>
        <link refid="mhd__stat_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>Efield/E_1DS.h</label>
        <link refid="E__1DS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>neutral/N0_1D.h</label>
        <link refid="N0__1D_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>plasma/plasma_1Dt.h</label>
        <link refid="plasma__1Dt_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>string.h</label>
      </node>
      <node id="26">
        <label>neutral.h</label>
        <link refid="neutral_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
      </node>
      <node id="40">
        <label>random.h</label>
        <link refid="random_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>error.h</label>
        <link refid="error_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="46">
        <label>diag/dist_com.h</label>
        <link refid="dist__com_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="48">
        <label>diag/diag_transcoef.h</label>
        <link refid="diag__transcoef_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>E_field.h</label>
        <link refid="E__field_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>plasma/plasma_1D.h</label>
        <link refid="plasma__1D_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>time.h</label>
      </node>
      <node id="18">
        <label>Bfield/B_TC.h</label>
        <link refid="B__TC_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>../linint/linint.h</label>
        <link refid="linint_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>Bfield/B_2DS.h</label>
        <link refid="B__2DS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="33">
        <label>mhd.h</label>
        <link refid="mhd_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>Efield/E_TC.h</label>
        <link refid="E__TC_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="32">
        <label>boozer.h</label>
        <link refid="boozer_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>Bfield/B_3DS.h</label>
        <link refid="B__3DS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>math.h</label>
        <link refid="math_8h"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="43">
        <label>diag/dist_6D.h</label>
        <link refid="dist__6D_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>wall/wall_3d.h</label>
        <link refid="wall__3d_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="49">
        <label>offload.h</label>
        <link refid="offload_8h"/>
      </node>
      <node id="2">
        <label>stdio.h</label>
      </node>
      <node id="45">
        <label>diag/dist_rho6D.h</label>
        <link refid="dist__rho6D_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>Bfield/B_STS.h</label>
        <link refid="B__STS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="30">
        <label>wall/wall_2d.h</label>
        <link refid="wall__2d_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>ascot5.h</label>
        <link refid="ascot5_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="func">
      <memberdef kind="function" id="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_arraysum</definition>
        <argsstring>(int start, int stop, real *array1, real *array2)</argsstring>
        <name>diag_arraysum</name>
        <param>
          <type>int</type>
          <declname>start</declname>
        </param>
        <param>
          <type>int</type>
          <declname>stop</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> *</type>
          <declname>array1</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> *</type>
          <declname>array2</declname>
        </param>
        <briefdescription>
<para>Simple helper function for summing elements of two arrays of same size. </para>
        </briefdescription>
        <detaileddescription>
<para>This function is indented for summing distribution ordinates. Indexing starts from 1 and indices given as arguments are inclusive.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>start</parametername>
</parameternamelist>
<parameterdescription>
<para>index to array element where summation begins </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>stop</parametername>
</parameternamelist>
<parameterdescription>
<para>index to array element where summation ends </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>array1</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to array where array2 is summed to </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>array2</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to array which is to be summed </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="402" column="6" bodyfile="diag.c" bodystart="402" bodyend="406" declfile="diag.c" declline="29" declcolumn="6"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1a4570a476d5bb4349ef4baa45b47e8847" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int diag_init_offload</definition>
        <argsstring>(diag_offload_data *data, real **offload_array, int Nmrk)</argsstring>
        <name>diag_init_offload</name>
        <param>
          <type><ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <param>
          <type>int</type>
          <declname>Nmrk</declname>
        </param>
        <briefdescription>
<para>Initializes offload array from offload data. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>diagnostics offload data </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload array which is allocated here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Nmrk</parametername>
</parameternamelist>
<parameterdescription>
<para>number of markers that will be simulated</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if initialization succeeded </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="40" column="5" bodyfile="diag.c" bodystart="40" bodyend="132"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1a3b90c421f536fac0c72366c6ca4d1e76" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_free_offload</definition>
        <argsstring>(diag_offload_data *data, real **offload_array)</argsstring>
        <name>diag_free_offload</name>
        <param>
          <type><ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <briefdescription>
<para>Frees the offload array. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>diagnostics offload data </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>offload array </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="140" column="6" bodyfile="diag.c" bodystart="140" bodyend="143"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1a73089778ca8720e87c651a4dd07c01f0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_init</definition>
        <argsstring>(diag_data *data, diag_offload_data *offload_data, real *offload_array)</argsstring>
        <name>diag_init</name>
        <param>
          <type><ref refid="structdiag__data" kindref="compound">diag_data</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref> *</type>
          <declname>offload_data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> *</type>
          <declname>offload_array</declname>
        </param>
        <briefdescription>
<para>Initializes diagnostics from offload data. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>diagnostics data </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_data</parametername>
</parameternamelist>
<parameterdescription>
<para>diagnostics offload data </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>offload array </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="152" column="6" bodyfile="diag.c" bodystart="152" bodyend="197"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1addc5ab98500383d3197d6388ad316fd4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_free</definition>
        <argsstring>(diag_data *data)</argsstring>
        <name>diag_free</name>
        <param>
          <type><ref refid="structdiag__data" kindref="compound">diag_data</ref> *</type>
          <declname>data</declname>
        </param>
        <briefdescription>
<para>Free diagnostics data. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>diagnostics data struct </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="204" column="6" bodyfile="diag.c" bodystart="204" bodyend="211"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1a04ac8d3800297d9cff3472e5908fcb6b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_update_fo</definition>
        <argsstring>(diag_data *data, B_field_data *Bdata, particle_simd_fo *p_f, particle_simd_fo *p_i)</argsstring>
        <name>diag_update_fo</name>
        <param>
          <type><ref refid="structdiag__data" kindref="compound">diag_data</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="structB__field__data" kindref="compound">B_field_data</ref> *</type>
          <declname>Bdata</declname>
        </param>
        <param>
          <type><ref refid="structparticle__simd__fo" kindref="compound">particle_simd_fo</ref> *</type>
          <declname>p_f</declname>
        </param>
        <param>
          <type><ref refid="structparticle__simd__fo" kindref="compound">particle_simd_fo</ref> *</type>
          <declname>p_i</declname>
        </param>
        <briefdescription>
<para>Collects diagnostics when marker represents a particle. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>diagnostics data struct </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Bdata</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to magnetic field data </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>p_f</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to SIMD struct storing marker states at the end of current time-step </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>p_i</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to SIMD struct storing marker states at the beginning of current time-step </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="223" column="6" bodyfile="diag.c" bodystart="223" bodyend="252"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1afa85ba6c77449ad4246d57685297b6b5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_update_gc</definition>
        <argsstring>(diag_data *data, B_field_data *Bdata, particle_simd_gc *p_f, particle_simd_gc *p_i)</argsstring>
        <name>diag_update_gc</name>
        <param>
          <type><ref refid="structdiag__data" kindref="compound">diag_data</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="structB__field__data" kindref="compound">B_field_data</ref> *</type>
          <declname>Bdata</declname>
        </param>
        <param>
          <type><ref refid="structparticle__simd__gc" kindref="compound">particle_simd_gc</ref> *</type>
          <declname>p_f</declname>
        </param>
        <param>
          <type><ref refid="structparticle__simd__gc" kindref="compound">particle_simd_gc</ref> *</type>
          <declname>p_i</declname>
        </param>
        <briefdescription>
<para>Collects diagnostics when marker represents a guiding center. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to diagnostics data struct </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Bdata</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to magnetic field data </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>p_f</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to SIMD struct storing marker states at the end of current time-step </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>p_i</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to SIMD struct storing marker states at the beginning of current time-step </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="264" column="6" bodyfile="diag.c" bodystart="264" bodyend="293"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1af2c134a61f0e1529ba5eb214989e9c34" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_update_ml</definition>
        <argsstring>(diag_data *data, particle_simd_ml *p_f, particle_simd_ml *p_i)</argsstring>
        <name>diag_update_ml</name>
        <param>
          <type><ref refid="structdiag__data" kindref="compound">diag_data</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="structparticle__simd__ml" kindref="compound">particle_simd_ml</ref> *</type>
          <declname>p_f</declname>
        </param>
        <param>
          <type><ref refid="structparticle__simd__ml" kindref="compound">particle_simd_ml</ref> *</type>
          <declname>p_i</declname>
        </param>
        <briefdescription>
<para>Collects diagnostics when marker represents a magnetic field line. </para>
        </briefdescription>
        <detaileddescription>
<para>Distributions are not updated for magnetic field lines.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to diagnostics data struct </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>p_f</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to SIMD struct storing marker states at the end of current time-step </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>p_i</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to SIMD struct storing marker states at the beginning of current time-step </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="306" column="6" bodyfile="diag.c" bodystart="306" bodyend="315"/>
      </memberdef>
      <memberdef kind="function" id="diag_8c_1a347467d2010f69e48514dfdf7003994d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void diag_sum</definition>
        <argsstring>(diag_offload_data *data, real *array1, real *array2)</argsstring>
        <name>diag_sum</name>
        <param>
          <type><ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref> *</type>
          <declname>data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> *</type>
          <declname>array1</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> *</type>
          <declname>array2</declname>
        </param>
        <briefdescription>
<para>Sum offload data arrays as one. </para>
        </briefdescription>
        <detaileddescription>
<para>The data in both arrays have identical order so distributions can be summed trivially. For orbits and transport coefficients the first array already have space for appending the orbit data from the second array, so we only need to move those elements.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to diagnostics data struct </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>array1</parametername>
</parameternamelist>
<parameterdescription>
<para>the array to which array2 is summed </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>array2</parametername>
</parameternamelist>
<parameterdescription>
<para>the array which is to be summed </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="diag.c" line="329" column="6" bodyfile="diag.c" bodystart="329" bodyend="389"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Interface for simulation diagnostics. </para>
    </briefdescription>
    <detaileddescription>
<para>Ascot standard output consists of inistate and endstate. Any other output is generated by &quot;diagnostics&quot; that are updated during the simulation. All diagnostics are accessed via this interface. To implement a new diagnostics, it is enough that one add calls to that diagnostics routines here.</para>
<para>One limitation for diagnostic data is that the size of the data must be known before simulation begins so that offloading of that data is possible. </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ascot5_8h" kindref="compound">ascot5.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="simulate_8h" kindref="compound">simulate.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="B__field_8h" kindref="compound">B_field.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="diag_8h" kindref="compound">diag.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="diag__orb_8h" kindref="compound">diag/diag_orb.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dist__5D_8h" kindref="compound">diag/dist_5D.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dist__6D_8h" kindref="compound">diag/dist_6D.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dist__rho5D_8h" kindref="compound">diag/dist_rho5D.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dist__rho6D_8h" kindref="compound">diag/dist_rho6D.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dist__com_8h" kindref="compound">diag/dist_com.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="diag__transcoef_8h" kindref="compound">diag/diag_transcoef.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="particle_8h" kindref="compound">particle.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" kindref="member">diag_arraysum</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stop,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>array1,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>array2);</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="40" refid="diag_8c_1a4570a476d5bb4349ef4baa45b47e8847" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1a4570a476d5bb4349ef4baa45b47e8847" kindref="member">diag_init_offload</ref>(<ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref>*<sp/>data,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>Nmrk){</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Determine<sp/>how<sp/>long<sp/>array<sp/>we<sp/>need<sp/>and<sp/>allocate<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1aabca1d9e3ef4d773892d2e4365859a67" kindref="member">dist5D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1a1681c128e1765616e9f082a0e7b6b34c" kindref="member">offload_dist5D_index</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1a3a4cf2862747e9526878fc6872aa0031" kindref="member">n_r</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1a4b4d47dcfd64dd5f62485b3639a8e0a8" kindref="member">n_phi</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1a35da14d74409c4e4e05f736202dd4bfe" kindref="member">n_z</ref></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1a13905a27c3413aa064c852ba4a3c1330" kindref="member">n_ppara</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1aec2faec072adcd6eaf93e511a6b343c5" kindref="member">n_pperp</ref></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1abec2d6748b7f9a08b900b4ee362da465" kindref="member">n_time</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1ad5462a6532aa2dfc348c193c478d805b" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1aef02e17e9aaecc7439810fc422c6ce60" kindref="member">dist6D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1ae77cece5bd97a7dd75b581ae040f34c7" kindref="member">offload_dist6D_index</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1ae4cc22ca131c747a57843e41b0c2887b" kindref="member">n_r</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1ad8b1e56d6d59d6a88fd9bf58d7b7f972" kindref="member">n_phi</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a875dbffcf0e35cba44d60a9f1561cc61" kindref="member">n_z</ref></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1acdb3b4f79620dcb70f70091c6a43a40a" kindref="member">n_pr</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1af5ea03eb93a8e2d21bdb0651c51a6433" kindref="member">n_pphi</ref></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a70a07553fac59c0c44e7a5b81a09d971" kindref="member">n_pz</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a6430347bdc5c63f3ef9c5f5de04e4763" kindref="member">n_time</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a5ff7cc50aa86c861bd55e5d99d4c2636" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1aa9ec9d30ef45b3cb2146b76d6018740d" kindref="member">distrho5D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1a006f335c854e8d50b4fe29327be4b4c8" kindref="member">offload_distrho5D_index</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a5729fc92313e4f766bf8d45ae9216d9a" kindref="member">n_rho</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a86dac7be95994539aac309a226b2a30f" kindref="member">n_theta</ref></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a335980df7f29c080b6a2b19830e40b50" kindref="member">n_phi</ref></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a488c833902fe84a74dcb358941ce88d6" kindref="member">n_ppara</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a2f3893f49ccc9c8a41366e7e2d03b9ce" kindref="member">n_pperp</ref></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a2350944e35a04683e54a770d938013f0" kindref="member">n_time</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a91ff0c7918fc424c4141f64654d2a69a" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1a34703f180dfda6f4f9fba6115ee3fc93" kindref="member">distrho6D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1aa5abbb3d09b3f5c69e2c01762a23d459" kindref="member">offload_distrho6D_index</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1aa277d7c23a630d9e0b3560a7728c6573" kindref="member">n_rho</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1ac085b6f75b2c1d0a85f88e0fad3dc450" kindref="member">n_theta</ref></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1adada4ed11a9fe6f34f6e2cd0567b5ed5" kindref="member">n_phi</ref></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1af6320b429c9e94bee3d04cc25d5d7247" kindref="member">n_pr</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1aacc6f348648643bf8e39f569c5ede00c" kindref="member">n_pphi</ref></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1a03e6b1aec9b5fa5f9ab8148034bd984c" kindref="member">n_pz</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1af032038494d6076eb4f4ea8831a7f82e" kindref="member">n_time</ref></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1a0cb41a1276dc60bebbce571a2cea4793" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1a6d33055c4c451d1b0970f096bd56ca97" kindref="member">distCOM_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1a291c5ebc855f798149390b11792da9c8" kindref="member">offload_distCOM_index</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>data-&gt;<ref refid="structdiag__offload__data_1aefa9d5d9474a314c58ff24f50753900b" kindref="member">distCOM</ref>.<ref refid="structdist__COM__offload__data_1a6f392eb71b5469e74365988d93cb261e" kindref="member">n_mu</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aefa9d5d9474a314c58ff24f50753900b" kindref="member">distCOM</ref>.<ref refid="structdist__COM__offload__data_1afb6ff76ded5e23f750f718ad13b74e6d" kindref="member">n_Ekin</ref></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aefa9d5d9474a314c58ff24f50753900b" kindref="member">distCOM</ref>.<ref refid="structdist__COM__offload__data_1aba0a6dfaf56aa2f0eb2ff9ecbe2808f7" kindref="member">n_Ptor</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1a0e1a20cd89d005986cae64545761f5c1" kindref="member">offload_dist_length</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1ad9102563ea0becdd37e81ea4626c3084" kindref="member">diagorb_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1a6528f5757dee549f1a98a4a522b09ccf" kindref="member">offload_diagorb_index</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a9d439e4f64efefde32da8a3643caf137" kindref="member">Nmrk</ref><sp/>=<sp/>Nmrk;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a095e1e9a845149a1748ae4b5b3f07592" kindref="member">record_mode</ref>)<sp/>{</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="simulate_8h_1a61dadd085c1777f559549e05962b2c9ea11f071e38be84de6b29ac4882c2e024f" kindref="member">simulate_mode_fo</ref>:</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1ab2e46e37a9d0c3cb3035bd6556f7a26e" kindref="member">Nfld</ref><sp/>=<sp/><ref refid="diag__orb_8h_1a6cb845d3090e83d3f54a0e04ad3f90bf" kindref="member">DIAG_ORB_FOFIELDS</ref>;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="simulate_8h_1a61dadd085c1777f559549e05962b2c9eac0a6480e647e3fbeeea8a2bc4127e2a3" kindref="member">simulate_mode_gc</ref>:</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1ab2e46e37a9d0c3cb3035bd6556f7a26e" kindref="member">Nfld</ref><sp/>=<sp/><ref refid="diag__orb_8h_1a613ad380622f631b76c42f9d53d66497" kindref="member">DIAG_ORB_GCFIELDS</ref>;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="simulate_8h_1a61dadd085c1777f559549e05962b2c9ea776d1e6a9397782eec6f44a14dec65c8" kindref="member">simulate_mode_ml</ref>:</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1ab2e46e37a9d0c3cb3035bd6556f7a26e" kindref="member">Nfld</ref><sp/>=<sp/><ref refid="diag__orb_8h_1a90da019635b1585981697a1c4f01e6b1" kindref="member">DIAG_ORB_MLFIELDS</ref>;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="simulate_8h_1a61dadd085c1777f559549e05962b2c9eac788923fd31e2e061b73241d459e4590" kindref="member">simulate_mode_hybrid</ref>:</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1ab2e46e37a9d0c3cb3035bd6556f7a26e" kindref="member">Nfld</ref><sp/>=<sp/><ref refid="diag__orb_8h_1a0a7bc451bde5977f421b65152064fee4" kindref="member">DIAG_ORB_HYBRIDFIELDS</ref>;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a138f8d3b8528d0791e8d8fd1358584e0" kindref="member">mode</ref><sp/>==<sp/><ref refid="diag__orb_8h_1a07d8a8dfc606dbcbd5aa247273f82347" kindref="member">DIAG_ORB_POINCARE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>(data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1ab2e46e37a9d0c3cb3035bd6556f7a26e" kindref="member">Nfld</ref>+2)</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a9d439e4f64efefde32da8a3643caf137" kindref="member">Nmrk</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a26e54630ba9ed82db45609eb56d17b15" kindref="member">Npnt</ref>;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a138f8d3b8528d0791e8d8fd1358584e0" kindref="member">mode</ref><sp/>==<sp/><ref refid="diag__orb_8h_1a40ef1e8d5e8fea99b01ffb623bbc8732" kindref="member">DIAG_ORB_INTERVAL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1ab2e46e37a9d0c3cb3035bd6556f7a26e" kindref="member">Nfld</ref></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a9d439e4f64efefde32da8a3643caf137" kindref="member">Nmrk</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a26e54630ba9ed82db45609eb56d17b15" kindref="member">Npnt</ref>;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1a5d8020ce200dc6c1b87b2a83cfda2527" kindref="member">diagtrcof_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1a29cc0b194c237c7a9575e669fe84f3bf" kindref="member">offload_diagtrcof_index</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1a6a59753e72823958726cc4fe2fb67f17" kindref="member">diagtrcof</ref>.<ref refid="structdiag__transcoef__offload__data_1a48f656b4352359b467791dac8ecf6df6" kindref="member">Nmrk</ref><sp/>=<sp/>Nmrk;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>3*data-&gt;<ref refid="structdiag__offload__data_1a6a59753e72823958726cc4fe2fb67f17" kindref="member">diagtrcof</ref>.<ref refid="structdiag__transcoef__offload__data_1a48f656b4352359b467791dac8ecf6df6" kindref="member">Nmrk</ref>;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__offload__data_1ab0497f303ab592808583fd85ab86bb6f" kindref="member">offload_array_length</ref><sp/>=<sp/>n;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>*offload_array<sp/>=<sp/>malloc(n<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>));</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*offload_array<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(*offload_array,<sp/>0,<sp/>n<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>));</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="132"><highlight class="normal">}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="diag_8c_1a3b90c421f536fac0c72366c6ca4d1e76" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1a3b90c421f536fac0c72366c6ca4d1e76" kindref="member">diag_free_offload</ref>(<ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref>*<sp/>data,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array)<sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/>free(*offload_array);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>*offload_array<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="143"><highlight class="normal">}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="152" refid="diag_8c_1a73089778ca8720e87c651a4dd07c01f0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1a73089778ca8720e87c651a4dd07c01f0" kindref="member">diag_init</ref>(<ref refid="structdiag__data" kindref="compound">diag_data</ref>*<sp/>data,<sp/><ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>offload_array)<sp/>{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__data_1afe7732925ce8b63bb7dc90f76e6d92c3" kindref="member">diagorb_collect</ref><sp/><sp/><sp/>=<sp/>offload_data-&gt;<ref refid="structdiag__offload__data_1ad9102563ea0becdd37e81ea4626c3084" kindref="member">diagorb_collect</ref>;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__data_1a9a8ec4af89baefbd9b1230f3bdb342e4" kindref="member">dist5D_collect</ref><sp/><sp/><sp/><sp/>=<sp/>offload_data-&gt;<ref refid="structdiag__offload__data_1aabca1d9e3ef4d773892d2e4365859a67" kindref="member">dist5D_collect</ref>;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__data_1aacbd161846bc2fc1647e23af9b275536" kindref="member">dist6D_collect</ref><sp/><sp/><sp/><sp/>=<sp/>offload_data-&gt;<ref refid="structdiag__offload__data_1aef02e17e9aaecc7439810fc422c6ce60" kindref="member">dist6D_collect</ref>;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__data_1a2c1f3a2fc7107fc3ebb90b10c587e75a" kindref="member">distrho5D_collect</ref><sp/>=<sp/>offload_data-&gt;<ref refid="structdiag__offload__data_1aa9ec9d30ef45b3cb2146b76d6018740d" kindref="member">distrho5D_collect</ref>;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__data_1a464f29b50aa62b6b34cf6744d59c26a0" kindref="member">distrho6D_collect</ref><sp/>=<sp/>offload_data-&gt;<ref refid="structdiag__offload__data_1a34703f180dfda6f4f9fba6115ee3fc93" kindref="member">distrho6D_collect</ref>;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__data_1abee2160dfb14953fb79d3ece806e452a" kindref="member">distCOM_collect</ref><sp/><sp/><sp/>=<sp/>offload_data-&gt;<ref refid="structdiag__offload__data_1a6d33055c4c451d1b0970f096bd56ca97" kindref="member">distCOM_collect</ref>;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="structdiag__data_1a373dd395e8bd46580108490ef954a14b" kindref="member">diagtrcof_collect</ref><sp/>=<sp/>offload_data-&gt;<ref refid="structdiag__offload__data_1a5d8020ce200dc6c1b87b2a83cfda2527" kindref="member">diagtrcof_collect</ref>;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a9a8ec4af89baefbd9b1230f3bdb342e4" kindref="member">dist5D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__5D_8c_1a5324e9964aa2c3f42080d062800bdb45" kindref="member">dist_5D_init</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a8ae667a755df6d70e98f4d812aa02edc" kindref="member">dist5D</ref>,<sp/>&amp;offload_data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>,</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;offload_array[offload_data-&gt;<ref refid="structdiag__offload__data_1a1681c128e1765616e9f082a0e7b6b34c" kindref="member">offload_dist5D_index</ref>]);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1aacbd161846bc2fc1647e23af9b275536" kindref="member">dist6D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__6D_8c_1a27b876904f02e94ebbf9c47226bf815b" kindref="member">dist_6D_init</ref>(&amp;data-&gt;<ref refid="structdiag__data_1ac00260be10da2818283b9d0d9c32ea00" kindref="member">dist6D</ref>,<sp/>&amp;offload_data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>,</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;offload_array[offload_data-&gt;<ref refid="structdiag__offload__data_1ae77cece5bd97a7dd75b581ae040f34c7" kindref="member">offload_dist6D_index</ref>]);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a2c1f3a2fc7107fc3ebb90b10c587e75a" kindref="member">distrho5D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__rho5D_8c_1a7c6dec909849d0523a6fc0cb141db864" kindref="member">dist_rho5D_init</ref>(&amp;data-&gt;<ref refid="structdiag__data_1ae673a89f3562dfa5d07c2ae1da488791" kindref="member">distrho5D</ref>,<sp/>&amp;offload_data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>,</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;offload_array[offload_data-&gt;<ref refid="structdiag__offload__data_1a006f335c854e8d50b4fe29327be4b4c8" kindref="member">offload_distrho5D_index</ref>]);</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a464f29b50aa62b6b34cf6744d59c26a0" kindref="member">distrho6D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__rho6D_8c_1accff76e2317b68ac9463d85b29b911f1" kindref="member">dist_rho6D_init</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a7234712930163d7f2322b4131771bfdf" kindref="member">distrho6D</ref>,<sp/>&amp;offload_data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>,</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;offload_array[offload_data-&gt;<ref refid="structdiag__offload__data_1aa5abbb3d09b3f5c69e2c01762a23d459" kindref="member">offload_distrho6D_index</ref>]);</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1abee2160dfb14953fb79d3ece806e452a" kindref="member">distCOM_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__com_8c_1a87cd25d8368af9725df29f0583046596" kindref="member">dist_COM_init</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a07b5d23fd4a990a5785e8fb72a7ad611" kindref="member">distCOM</ref>,<sp/>&amp;offload_data-&gt;<ref refid="structdiag__offload__data_1aefa9d5d9474a314c58ff24f50753900b" kindref="member">distCOM</ref>,</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;offload_array[offload_data-&gt;<ref refid="structdiag__offload__data_1a291c5ebc855f798149390b11792da9c8" kindref="member">offload_distCOM_index</ref>]);</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1afe7732925ce8b63bb7dc90f76e6d92c3" kindref="member">diagorb_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__orb_8c_1a6936d74e0248518a3d0d2e5cf09dca1f" kindref="member">diag_orb_init</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a490d4832525440e48ea526e66c3814aa" kindref="member">diagorb</ref>,<sp/>&amp;offload_data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;offload_array[offload_data-&gt;<ref refid="structdiag__offload__data_1a6528f5757dee549f1a98a4a522b09ccf" kindref="member">offload_diagorb_index</ref>]);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a373dd395e8bd46580108490ef954a14b" kindref="member">diagtrcof_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__transcoef_8c_1ab8d983ad1ded176a70aa7fe8df781eae" kindref="member">diag_transcoef_init</ref>(</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;data-&gt;<ref refid="structdiag__data_1a37e300dcc02773c63083db3ddebfe79d" kindref="member">diagtrcof</ref>,<sp/>&amp;offload_data-&gt;<ref refid="structdiag__offload__data_1a6a59753e72823958726cc4fe2fb67f17" kindref="member">diagtrcof</ref>,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;offload_array[offload_data-&gt;<ref refid="structdiag__offload__data_1a29cc0b194c237c7a9575e669fe84f3bf" kindref="member">offload_diagtrcof_index</ref>]);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="197"><highlight class="normal">}</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="204" refid="diag_8c_1addc5ab98500383d3197d6388ad316fd4" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1addc5ab98500383d3197d6388ad316fd4" kindref="member">diag_free</ref>(<ref refid="structdiag__data" kindref="compound">diag_data</ref>*<sp/>data)<sp/>{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1afe7732925ce8b63bb7dc90f76e6d92c3" kindref="member">diagorb_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__orb_8c_1ad53ee5833f2b49b7733e9415db40b65b" kindref="member">diag_orb_free</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a490d4832525440e48ea526e66c3814aa" kindref="member">diagorb</ref>);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a373dd395e8bd46580108490ef954a14b" kindref="member">diagtrcof_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__transcoef_8c_1a914f9c237bb8563cf0ea18138ed879d4" kindref="member">diag_transcoef_free</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a37e300dcc02773c63083db3ddebfe79d" kindref="member">diagtrcof</ref>);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="211"><highlight class="normal">}</highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="223" refid="diag_8c_1a04ac8d3800297d9cff3472e5908fcb6b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1a04ac8d3800297d9cff3472e5908fcb6b" kindref="member">diag_update_fo</ref>(<ref refid="structdiag__data" kindref="compound">diag_data</ref>*<sp/>data,<sp/><ref refid="structB__field__data" kindref="compound">B_field_data</ref>*<sp/>Bdata,<sp/><ref refid="structparticle__simd__fo" kindref="compound">particle_simd_fo</ref>*<sp/>p_f,</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structparticle__simd__fo" kindref="compound">particle_simd_fo</ref>*<sp/>p_i)<sp/>{</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1afe7732925ce8b63bb7dc90f76e6d92c3" kindref="member">diagorb_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__orb_8c_1a0d84de2c2b8b2f24c90a32609ee43576" kindref="member">diag_orb_update_fo</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a490d4832525440e48ea526e66c3814aa" kindref="member">diagorb</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a9a8ec4af89baefbd9b1230f3bdb342e4" kindref="member">dist5D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__5D_8c_1a79bdbcde10462af101c7909fc9fe2595" kindref="member">dist_5D_update_fo</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a8ae667a755df6d70e98f4d812aa02edc" kindref="member">dist5D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1aacbd161846bc2fc1647e23af9b275536" kindref="member">dist6D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__6D_8c_1a091dce3774bd63f0a569f272293930e0" kindref="member">dist_6D_update_fo</ref>(&amp;data-&gt;<ref refid="structdiag__data_1ac00260be10da2818283b9d0d9c32ea00" kindref="member">dist6D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a2c1f3a2fc7107fc3ebb90b10c587e75a" kindref="member">distrho5D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__rho5D_8c_1ad465bf139fe6990120c779fff785f973" kindref="member">dist_rho5D_update_fo</ref>(&amp;data-&gt;<ref refid="structdiag__data_1ae673a89f3562dfa5d07c2ae1da488791" kindref="member">distrho5D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a464f29b50aa62b6b34cf6744d59c26a0" kindref="member">distrho6D_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__rho6D_8c_1ad9099546b269bfdcea402970f4fa42c4" kindref="member">dist_rho6D_update_fo</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a7234712930163d7f2322b4131771bfdf" kindref="member">distrho6D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1abee2160dfb14953fb79d3ece806e452a" kindref="member">distCOM_collect</ref>){</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__com_8c_1a1bae36f974e97305f49fc663c5cae76c" kindref="member">dist_COM_update_fo</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a07b5d23fd4a990a5785e8fb72a7ad611" kindref="member">distCOM</ref>,<sp/>Bdata,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a373dd395e8bd46580108490ef954a14b" kindref="member">diagtrcof_collect</ref>){</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__transcoef_8c_1a87f98b46dade3b9864da7a7b8403371b" kindref="member">diag_transcoef_update_fo</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a37e300dcc02773c63083db3ddebfe79d" kindref="member">diagtrcof</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="252"><highlight class="normal">}</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="264" refid="diag_8c_1afa85ba6c77449ad4246d57685297b6b5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1afa85ba6c77449ad4246d57685297b6b5" kindref="member">diag_update_gc</ref>(<ref refid="structdiag__data" kindref="compound">diag_data</ref>*<sp/>data,<sp/><ref refid="structB__field__data" kindref="compound">B_field_data</ref>*<sp/>Bdata,<sp/><ref refid="structparticle__simd__gc" kindref="compound">particle_simd_gc</ref>*<sp/>p_f,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structparticle__simd__gc" kindref="compound">particle_simd_gc</ref>*<sp/>p_i)<sp/>{</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1afe7732925ce8b63bb7dc90f76e6d92c3" kindref="member">diagorb_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__orb_8c_1ac7d9b89830179893c09ca5d39f3b944c" kindref="member">diag_orb_update_gc</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a490d4832525440e48ea526e66c3814aa" kindref="member">diagorb</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a9a8ec4af89baefbd9b1230f3bdb342e4" kindref="member">dist5D_collect</ref>){</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__5D_8c_1a1c4dc3fabef916fe84509c29767cc46b" kindref="member">dist_5D_update_gc</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a8ae667a755df6d70e98f4d812aa02edc" kindref="member">dist5D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1aacbd161846bc2fc1647e23af9b275536" kindref="member">dist6D_collect</ref>){</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__6D_8c_1a35535ad5fa72126cc8379a882708cfc0" kindref="member">dist_6D_update_gc</ref>(&amp;data-&gt;<ref refid="structdiag__data_1ac00260be10da2818283b9d0d9c32ea00" kindref="member">dist6D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a2c1f3a2fc7107fc3ebb90b10c587e75a" kindref="member">distrho5D_collect</ref>){</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__rho5D_8c_1a6fee10a74bc7bdc9e880a3aad56d0d2f" kindref="member">dist_rho5D_update_gc</ref>(&amp;data-&gt;<ref refid="structdiag__data_1ae673a89f3562dfa5d07c2ae1da488791" kindref="member">distrho5D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a464f29b50aa62b6b34cf6744d59c26a0" kindref="member">distrho6D_collect</ref>){</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__rho6D_8c_1a98497b938d8547e5b81afb5c34003df9" kindref="member">dist_rho6D_update_gc</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a7234712930163d7f2322b4131771bfdf" kindref="member">distrho6D</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1abee2160dfb14953fb79d3ece806e452a" kindref="member">distCOM_collect</ref>){</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dist__com_8c_1aef2605581d2132bc8986dc29595c1e21" kindref="member">dist_COM_update_gc</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a07b5d23fd4a990a5785e8fb72a7ad611" kindref="member">distCOM</ref>,<sp/>Bdata,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a373dd395e8bd46580108490ef954a14b" kindref="member">diagtrcof_collect</ref>){</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__transcoef_8c_1a68ee7043ac4a17a086e768c53fefa6a2" kindref="member">diag_transcoef_update_gc</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a37e300dcc02773c63083db3ddebfe79d" kindref="member">diagtrcof</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="293"><highlight class="normal">}</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="306" refid="diag_8c_1af2c134a61f0e1529ba5eb214989e9c34" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1af2c134a61f0e1529ba5eb214989e9c34" kindref="member">diag_update_ml</ref>(<ref refid="structdiag__data" kindref="compound">diag_data</ref>*<sp/>data,<sp/><ref refid="structparticle__simd__ml" kindref="compound">particle_simd_ml</ref>*<sp/>p_f,</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structparticle__simd__ml" kindref="compound">particle_simd_ml</ref>*<sp/>p_i)<sp/>{</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1afe7732925ce8b63bb7dc90f76e6d92c3" kindref="member">diagorb_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__orb_8c_1a708a474e8c0f4dbc31d68c0cc5803ef6" kindref="member">diag_orb_update_ml</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a490d4832525440e48ea526e66c3814aa" kindref="member">diagorb</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__data_1a373dd395e8bd46580108490ef954a14b" kindref="member">diagtrcof_collect</ref>){</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag__transcoef_8c_1a1676a3bc35d3f74186e01b0009d951be" kindref="member">diag_transcoef_update_ml</ref>(&amp;data-&gt;<ref refid="structdiag__data_1a37e300dcc02773c63083db3ddebfe79d" kindref="member">diagtrcof</ref>,<sp/>p_f,<sp/>p_i);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="315"><highlight class="normal">}</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="329" refid="diag_8c_1a347467d2010f69e48514dfdf7003994d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1a347467d2010f69e48514dfdf7003994d" kindref="member">diag_sum</ref>(<ref refid="structdiag__offload__data" kindref="compound">diag_offload_data</ref>*<sp/>data,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>array1,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>array2)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1ad9102563ea0becdd37e81ea4626c3084" kindref="member">diagorb_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arr_start<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1a6528f5757dee549f1a98a4a522b09ccf" kindref="member">offload_diagorb_index</ref>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arr_length<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1ab2e46e37a9d0c3cb3035bd6556f7a26e" kindref="member">Nfld</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a9d439e4f64efefde32da8a3643caf137" kindref="member">Nmrk</ref></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1afb9eada4ecfb08dbba726e86dab88658" kindref="member">diagorb</ref>.<ref refid="structdiag__orb__offload__data_1a26e54630ba9ed82db45609eb56d17b15" kindref="member">Npnt</ref>;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(&amp;(array1[arr_start+arr_length]),</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(array2[arr_start]),</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arr_length*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>));</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1a5d8020ce200dc6c1b87b2a83cfda2527" kindref="member">diagtrcof_collect</ref>)<sp/>{</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arr_start<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1a29cc0b194c237c7a9575e669fe84f3bf" kindref="member">offload_diagtrcof_index</ref>;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arr_length<sp/>=<sp/>3<sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a6a59753e72823958726cc4fe2fb67f17" kindref="member">diagtrcof</ref>.<ref refid="structdiag__transcoef__offload__data_1a48f656b4352359b467791dac8ecf6df6" kindref="member">Nmrk</ref>;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(&amp;(array1[arr_start+arr_length]),</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(array2[arr_start]),</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arr_length*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>));</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1aabca1d9e3ef4d773892d2e4365859a67" kindref="member">dist5D_collect</ref>){</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1a1681c128e1765616e9f082a0e7b6b34c" kindref="member">offload_dist5D_index</ref>;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stop<sp/>=<sp/>start<sp/>+<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1a3a4cf2862747e9526878fc6872aa0031" kindref="member">n_r</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1a35da14d74409c4e4e05f736202dd4bfe" kindref="member">n_z</ref></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1a13905a27c3413aa064c852ba4a3c1330" kindref="member">n_ppara</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1aec2faec072adcd6eaf93e511a6b343c5" kindref="member">n_pperp</ref></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1abec2d6748b7f9a08b900b4ee362da465" kindref="member">n_time</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a797a776879d2af4fcb3c895819eb95f2" kindref="member">dist5D</ref>.<ref refid="structdist__5D__offload__data_1ad5462a6532aa2dfc348c193c478d805b" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" kindref="member">diag_arraysum</ref>(start,<sp/>stop,<sp/>array1,<sp/>array2);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1aef02e17e9aaecc7439810fc422c6ce60" kindref="member">dist6D_collect</ref>){</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1ae77cece5bd97a7dd75b581ae040f34c7" kindref="member">offload_dist6D_index</ref>;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stop<sp/>=<sp/>start<sp/>+<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1ae4cc22ca131c747a57843e41b0c2887b" kindref="member">n_r</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1ad8b1e56d6d59d6a88fd9bf58d7b7f972" kindref="member">n_phi</ref></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a875dbffcf0e35cba44d60a9f1561cc61" kindref="member">n_z</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1acdb3b4f79620dcb70f70091c6a43a40a" kindref="member">n_pr</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1af5ea03eb93a8e2d21bdb0651c51a6433" kindref="member">n_pphi</ref></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a70a07553fac59c0c44e7a5b81a09d971" kindref="member">n_pz</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a6430347bdc5c63f3ef9c5f5de04e4763" kindref="member">n_time</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aab6d8ccb419024ed0aed5ed297ed60e0" kindref="member">dist6D</ref>.<ref refid="structdist__6D__offload__data_1a5ff7cc50aa86c861bd55e5d99d4c2636" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" kindref="member">diag_arraysum</ref>(start,<sp/>stop,<sp/>array1,<sp/>array2);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1aa9ec9d30ef45b3cb2146b76d6018740d" kindref="member">distrho5D_collect</ref>){</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1a006f335c854e8d50b4fe29327be4b4c8" kindref="member">offload_distrho5D_index</ref>;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stop<sp/>=<sp/>start<sp/>+<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a5729fc92313e4f766bf8d45ae9216d9a" kindref="member">n_rho</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a86dac7be95994539aac309a226b2a30f" kindref="member">n_theta</ref></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a335980df7f29c080b6a2b19830e40b50" kindref="member">n_phi</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a488c833902fe84a74dcb358941ce88d6" kindref="member">n_ppara</ref></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a2f3893f49ccc9c8a41366e7e2d03b9ce" kindref="member">n_pperp</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a2350944e35a04683e54a770d938013f0" kindref="member">n_time</ref></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1a24acffe3a913af12d563307b20e55a70" kindref="member">distrho5D</ref>.<ref refid="structdist__rho5D__offload__data_1a91ff0c7918fc424c4141f64654d2a69a" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" kindref="member">diag_arraysum</ref>(start,<sp/>stop,<sp/>array1,<sp/>array2);</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1a34703f180dfda6f4f9fba6115ee3fc93" kindref="member">distrho6D_collect</ref>){</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1aa5abbb3d09b3f5c69e2c01762a23d459" kindref="member">offload_distrho6D_index</ref>;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stop<sp/>=<sp/>start<sp/>+<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1aa277d7c23a630d9e0b3560a7728c6573" kindref="member">n_rho</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1ac085b6f75b2c1d0a85f88e0fad3dc450" kindref="member">n_theta</ref></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1adada4ed11a9fe6f34f6e2cd0567b5ed5" kindref="member">n_phi</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1af6320b429c9e94bee3d04cc25d5d7247" kindref="member">n_pr</ref></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1aacc6f348648643bf8e39f569c5ede00c" kindref="member">n_pphi</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1a03e6b1aec9b5fa5f9ab8148034bd984c" kindref="member">n_pz</ref></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1af032038494d6076eb4f4ea8831a7f82e" kindref="member">n_time</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1ab3ffe4ce6f3c8a507fe4c0e38f9f928b" kindref="member">distrho6D</ref>.<ref refid="structdist__rho6D__offload__data_1a0cb41a1276dc60bebbce571a2cea4793" kindref="member">n_q</ref>;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" kindref="member">diag_arraysum</ref>(start,<sp/>stop,<sp/>array1,<sp/>array2);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(data-&gt;<ref refid="structdiag__offload__data_1a6d33055c4c451d1b0970f096bd56ca97" kindref="member">distCOM_collect</ref>){</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/>data-&gt;<ref refid="structdiag__offload__data_1a291c5ebc855f798149390b11792da9c8" kindref="member">offload_distCOM_index</ref>;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stop<sp/>=<sp/>start<sp/>+<sp/>data-&gt;<ref refid="structdiag__offload__data_1aefa9d5d9474a314c58ff24f50753900b" kindref="member">distCOM</ref>.<ref refid="structdist__COM__offload__data_1a6f392eb71b5469e74365988d93cb261e" kindref="member">n_mu</ref><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aefa9d5d9474a314c58ff24f50753900b" kindref="member">distCOM</ref>.<ref refid="structdist__COM__offload__data_1afb6ff76ded5e23f750f718ad13b74e6d" kindref="member">n_Ekin</ref></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>data-&gt;<ref refid="structdiag__offload__data_1aefa9d5d9474a314c58ff24f50753900b" kindref="member">distCOM</ref>.<ref refid="structdist__COM__offload__data_1aba0a6dfaf56aa2f0eb2ff9ecbe2808f7" kindref="member">n_Ptor</ref>;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" kindref="member">diag_arraysum</ref>(start,<sp/>stop,<sp/>array1,<sp/>array2);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="389"><highlight class="normal">}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="402" refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="diag_8c_1a8e32721111ea1dc5d2692b17f90802c0" kindref="member">diag_arraysum</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>stop,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>array1,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>array2)<sp/>{</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>start;<sp/>i<sp/>&lt;<sp/>stop;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array1[i]<sp/>+=<sp/>array2[i];</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="406"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="diag.c"/>
  </compounddef>
</doxygen>
