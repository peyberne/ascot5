<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="suzuki_8c" kind="file" language="C++">
    <compoundname>suzuki.c</compoundname>
    <includes refid="math_8h" local="no">math.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes refid="ascot5_8h" local="yes">ascot5.h</includes>
    <includes refid="consts_8h" local="yes">consts.h</includes>
    <includes refid="error_8h" local="yes">error.h</includes>
    <includes refid="suzuki_8h" local="yes">suzuki.h</includes>
    <incdepgraph>
      <node id="1">
        <label>suzuki.c</label>
        <link refid="suzuki_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>suzuki.h</label>
        <link refid="suzuki_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>stdlib.h</label>
      </node>
      <node id="4">
        <label>omp.h</label>
      </node>
      <node id="8">
        <label>consts.h</label>
        <link refid="consts_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>error.h</label>
        <link refid="error_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>time.h</label>
      </node>
      <node id="2">
        <label>math.h</label>
        <link refid="math_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>stdio.h</label>
      </node>
      <node id="3">
        <label>ascot5.h</label>
        <link refid="ascot5_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="var">
      <memberdef kind="variable" id="suzuki_8c_1a6acdaabc073daeabb9582ea7632b205f" prot="public" static="no" mutable="no">
        <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
        <definition>real A_highE[3][10]</definition>
        <argsstring>[3][10]</argsstring>
        <name>A_highE</name>
        <initializer>= {
{12.7, 1.25, 0.452, 0.0105, 0.547, -0.102,   0.360, -0.0298, -0.0959, 4.21e-3},
{14.1, 1.11, 0.408, 0.0105, 0.547, -0.0403,  0.345, -0.0288, -0.0971, 4.74e-3},
{12.7, 1.26, 0.449, 0.0105, 0.547, -0.00577, 0.336, -0.0282, -0.0974, 4.87e-3}
}</initializer>
        <briefdescription>
<para>Fitting parameters for Aijk in equation 28. </para>
        </briefdescription>
        <detaileddescription>
<para>Table 2a from Suzuki&apos;s paper for H, D, and T. Note the last column in the paper is for different magnetic field magnitude, whose effect was negligible and so that is not included here.</para>
<para>These values are valid in range 100 &lt; E (keV/amu) &lt; 10000. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="31" column="6" bodyfile="suzuki.c" bodystart="31" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="suzuki_8c_1a09a99dcb36ce26b7ad51499718690854" prot="public" static="no" mutable="no">
        <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
        <definition>real A_lowE[3][10]</definition>
        <argsstring>[3][10]</argsstring>
        <name>A_lowE</name>
        <initializer>= {
{-52.9, -1.36, 0.0719, 0.0137, 0.454, 0.403, -0.220, 0.0666, -0.0677, -1.48e-3},
{-67.9, -1.22, 0.0814, 0.0139, 0.454, 0.465, -0.273, 0.0751, -0.0630, -5.08e-4},
{-74.2, -1.18, 0.0843, 0.0139, 0.453, 0.491, -0.294, 0.0788, -0.0612, -1.85e-4}
}</initializer>
        <briefdescription>
<para>Fitting parameters for Aijk in equation 28. </para>
        </briefdescription>
        <detaileddescription>
<para>Table 3a from Suzuki&apos;s paper for H, D, and T. Note the last column in the paper is for different magnetic field magnitude, whose effect was negligible and so that is not included here.</para>
<para>These values are valid in range 10 &lt; E (keV/amu) &lt; 100. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="46" column="6" bodyfile="suzuki.c" bodystart="46" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="suzuki_8c_1a8a4808c7463961718f1e5f1d808b9d0b" prot="public" static="no" mutable="no">
        <type><ref refid="ascot5_8h_1a865b01f4cbb6f2bb3270e094934d3263" kindref="member">integer</ref></type>
        <definition>integer Z_imp[]</definition>
        <argsstring>[]</argsstring>
        <name>Z_imp</name>
        <initializer>= {   2,   6,   6,   4,   8,   7,   3,   5,  26 }</initializer>
        <briefdescription>
<para>Charge number corresponding to the tabulated values of Bijk. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="55" column="9" bodyfile="suzuki.c" bodystart="55" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="suzuki_8c_1a109ab95af25804fb2a466ef455c6a4da" prot="public" static="no" mutable="no">
        <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
        <definition>real Zeffmin_imp[]</definition>
        <argsstring>[]</argsstring>
        <name>Zeffmin_imp</name>
        <initializer>= { 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0 }</initializer>
        <briefdescription>
<para>Minimum valid Zeff corresponding to the tabulated values of Bijk. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="60" column="6" bodyfile="suzuki.c" bodystart="60" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="suzuki_8c_1a4bfd1c5469ef526248d81f55c085ecb6" prot="public" static="no" mutable="no">
        <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
        <definition>real Zeffmax_imp[]</definition>
        <argsstring>[]</argsstring>
        <name>Zeffmax_imp</name>
        <initializer>= { 2.1, 5.0, 6.0, 4.0, 5.0, 5.0, 3.0, 5.0, 5.0 }</initializer>
        <briefdescription>
<para>Maximum valid Zeff corresponding to the tabulated values of Bijk. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="65" column="6" bodyfile="suzuki.c" bodystart="65" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="suzuki_8c_1a442ae8dedc39da181cb907c9c7d8bf08" prot="public" static="no" mutable="no">
        <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
        <definition>real B_highE[9][12]</definition>
        <argsstring>[9][12]</argsstring>
        <name>B_highE</name>
        <initializer>= {
    {  0.231,     0.343,    -0.185,    -0.162e-1,  0.105,    -0.703e-1,
       0.531e-1,  0.342e-2, -0.838e-2,  0.415e-2, -0.335e-2, -0.221e-3 },
    { -0.101e1,  -0.865e-2, -0.124,    -0.145e-1,  0.391,     0.161e-1,
       0.298e-1,  0.332e-2, -0.248e-1, -0.104e-2, -0.152e-2, -0.189e-3 },
    { -0.100e1,  -0.255e-1, -0.125,    -0.142e-1,  0.388,     0.206e-1,
       0.297e-1,  0.326e-2, -0.246e-1, -0.131e-2, -0.148e-2, -0.180e-3 },
    { -0.613,     0.552e-1, -0.167,    -0.159e-1,  0.304,     0.154e-2,
       0.436e-1,  0.378e-2, -0.201e-1, -0.216e-3, -0.251e-2, -0.227e-3 },
    { -0.102e1,  -0.148e-1, -0.674e-1, -0.917e-2,  0.359,     0.143e-1,
       0.139e-1,  0.184e-2, -0.209e-1, -0.732e-3, -0.502e-3, -0.949e-4 },
    { -0.102e1,  -0.139e-1, -0.979e-1, -0.117e-1,  0.375,     0.156e-1,
       0.224e-1,  0.254e-2, -0.226e-1, -0.889e-3, -0.104e-2, -0.139e-3 },
    { -0.441,     0.129,    -0.170,    -0.162e-1,  0.277,    -0.156e-1,
       0.466e-1,  0.379e-2, -0.193e-1,  0.753e-3, -0.286e-2, -0.239e-3 },
    { -0.732,     0.183e-1, -0.155,    -0.172e-1,  0.321,     0.946e-2,
       0.397e-1,  0.420e-2, -0.204e-1, -0.619e-3, -0.224e-2, -0.254e-3 },
    { -0.820,    -0.636e-2,  0.542e-1,  0.395e-2,  0.202,     0.806e-3,
      -0.200e-2, -0.178e-2, -0.610e-2,  0.651e-3,  0.175e-2,  0.146e-3 }
}</initializer>
        <briefdescription>
<para>Fitting parameters for Bijk in equation 28. </para>
        </briefdescription>
        <detaileddescription>
<para>Table 2bc (partially) from Suzuki&apos;s paper for H, D, and T.</para>
<para>These values are valid in range 100 &lt; E (keV/amu) &lt; 10000. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="74" column="6" bodyfile="suzuki.c" bodystart="74" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="suzuki_8c_1a55b777f29d9f720c74af9f72aed7425c" prot="public" static="no" mutable="no">
        <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
        <definition>real B_lowE[9][12]</definition>
        <argsstring>[9][12]</argsstring>
        <name>B_lowE</name>
        <initializer>= {
    { -0.792,     0.420e-1,  0.530e-1,  -0.139e-1,  0.301,    -0.264e-1,
      -0.299e-1,  0.607e-2,  0.272e-3,   0.611e-2,  0.347e-2, -0.919e-3 },
    {  0.161,     0.598e-1, -0.336e-2,  -0.426e-2, -0.157,    -0.396e-1,
       0.460e-2,  0.219e-2,  0.391e-1,   0.711e-2, -0.144e-2, -0.385e-3 },
    {  0.158,     0.554e-1, -0.431e-2,  -0.335e-2, -0.155,    -0.374e-1,
       0.537e-2,  0.174e-2,  0.388e-1,   0.683e-2, -0.160e-2, -0.322e-3 },
    {  0.112,     0.495e-1,  0.116e-1,  -0.286e-2, -0.149,    -0.331e-1,
      -0.426e-2,  0.980e-3,  0.447e-1,   0.652e-2, -0.356e-3, -0.203e-3 },
    {  0.111,     0.541e-1, -0.346e-3,  -0.368e-2, -0.108,    -0.347e-1,
       0.193e-2,  0.181e-2,  0.280e-1,   0.604e-2, -0.841e-3, -0.317e-3 },
    {  0.139,     0.606e-1, -0.306e-2,  -0.455e-2, -0.133,    -0.394e-1,
       0.399e-2,  0.236e-2,  0.335e-1,   0.690e-2, -0.124e-2, -0.405e-3 },
    {  0.112,     0.495e-1,  0.116e-1,  -0.286e-2, -0.149,    -0.331e-1,
      -0.426e-2,  0.980e-3,  0.447e-1,   0.652e-2, -0.356e-3, -0.203e-3 },
    {  0.122,     0.527e-1, -0.430e-3,  -0.318e-2, -0.151,    -0.364e-1,
       0.343e-2,  0.151e-2,  0.420e-1,   0.692e-2, -0.141e-2, -0.290e-3 },
    { -0.110e-1,  0.202e-1,  0.946e-3,  -0.409e-2, -0.666e-2, -0.117e-1,
      -0.236e-3,  0.202e-2,  0.408e-2,   0.185e-2, -0.648e-4, -0.313e-3 }
}</initializer>
        <briefdescription>
<para>Fitting parameters for Bijk in equation 28. </para>
        </briefdescription>
        <detaileddescription>
<para>Table 3bc (partially) from Suzuki&apos;s paper for H, D, and T.</para>
<para>These values are valid in range 10 &lt; E (keV/amu) &lt; 100. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="102" column="6" bodyfile="suzuki.c" bodystart="102" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="suzuki_8c_1a3137723600419f37e26a80691bb5bb0f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="error_8h_1a3bca029fa2975420f00b89f3cb38872e" kindref="member">a5err</ref></type>
        <definition>a5err suzuki_sigmav</definition>
        <argsstring>(real *sigmav, real EperAmu, real ne, real te, integer nion, real *ni, const int *Anum, const int *Znum)</argsstring>
        <name>suzuki_sigmav</name>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> *</type>
          <declname>sigmav</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
          <declname>EperAmu</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
          <declname>ne</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref></type>
          <declname>te</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a865b01f4cbb6f2bb3270e094934d3263" kindref="member">integer</ref></type>
          <declname>nion</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> *</type>
          <declname>ni</declname>
        </param>
        <param>
          <type>const int *</type>
          <declname>Anum</declname>
        </param>
        <param>
          <type>const int *</type>
          <declname>Znum</declname>
        </param>
        <briefdescription>
<para>Calculate beam-stopping cross-section according to Suzuki model. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>sigmav</parametername>
</parameternamelist>
<parameterdescription>
<para>evaluated beam stopping cross section [cm^2] </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>EperAmu</parametername>
</parameternamelist>
<parameterdescription>
<para>test particle energy divided by its atomic mass number [J] </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ne</parametername>
</parameternamelist>
<parameterdescription>
<para>electron particle density [m^-3] </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>te</parametername>
</parameternamelist>
<parameterdescription>
<para>electron temperature [J] </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>nion</parametername>
</parameternamelist>
<parameterdescription>
<para>number of ion species present in the plasma </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ni</parametername>
</parameternamelist>
<parameterdescription>
<para>densities of the ion species with at least single hydrogen species </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Anum</parametername>
</parameternamelist>
<parameterdescription>
<para>ion species&apos; atomic mass number </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>Znum</parametername>
</parameternamelist>
<parameterdescription>
<para>ion species&apos; charge number</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if evaluation was succesfull </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="suzuki.c" line="138" column="7" bodyfile="suzuki.c" bodystart="138" bodyend="243"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Suzuki beam-stopping coefficients. </para>
    </briefdescription>
    <detaileddescription>
<para>The data and model is from S Suzuki et al 1998 Plasma Phys. Control. Fusion 40 2097 doi.org/10.1088/0741-3335/40/12/009</para>
<para>The model calculates beam-stopping coefficients for hydrogen beams in hydrogen plasma with impurities present.</para>
<para>Available impurities are: He, Li, Be, B, C, N, O, Fe. </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="math_8h" kindref="compound">math.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ascot5_8h" kindref="compound">ascot5.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="consts_8h" kindref="compound">consts.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="error_8h" kindref="compound">error.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="suzuki_8h" kindref="compound">suzuki.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="31" refid="suzuki_8c_1a6acdaabc073daeabb9582ea7632b205f" refkind="member"><highlight class="normal"><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/><ref refid="suzuki_8c_1a6acdaabc073daeabb9582ea7632b205f" kindref="member">A_highE</ref>[3][10]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="32"><highlight class="normal">{12.7,<sp/>1.25,<sp/>0.452,<sp/>0.0105,<sp/>0.547,<sp/>-0.102,<sp/><sp/><sp/>0.360,<sp/>-0.0298,<sp/>-0.0959,<sp/>4.21e-3},</highlight></codeline>
<codeline lineno="33"><highlight class="normal">{14.1,<sp/>1.11,<sp/>0.408,<sp/>0.0105,<sp/>0.547,<sp/>-0.0403,<sp/><sp/>0.345,<sp/>-0.0288,<sp/>-0.0971,<sp/>4.74e-3},</highlight></codeline>
<codeline lineno="34"><highlight class="normal">{12.7,<sp/>1.26,<sp/>0.449,<sp/>0.0105,<sp/>0.547,<sp/>-0.00577,<sp/>0.336,<sp/>-0.0282,<sp/>-0.0974,<sp/>4.87e-3}</highlight></codeline>
<codeline lineno="35"><highlight class="normal">};</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="46" refid="suzuki_8c_1a09a99dcb36ce26b7ad51499718690854" refkind="member"><highlight class="normal"><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/><ref refid="suzuki_8c_1a09a99dcb36ce26b7ad51499718690854" kindref="member">A_lowE</ref>[3][10]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal">{-52.9,<sp/>-1.36,<sp/>0.0719,<sp/>0.0137,<sp/>0.454,<sp/>0.403,<sp/>-0.220,<sp/>0.0666,<sp/>-0.0677,<sp/>-1.48e-3},</highlight></codeline>
<codeline lineno="48"><highlight class="normal">{-67.9,<sp/>-1.22,<sp/>0.0814,<sp/>0.0139,<sp/>0.454,<sp/>0.465,<sp/>-0.273,<sp/>0.0751,<sp/>-0.0630,<sp/>-5.08e-4},</highlight></codeline>
<codeline lineno="49"><highlight class="normal">{-74.2,<sp/>-1.18,<sp/>0.0843,<sp/>0.0139,<sp/>0.453,<sp/>0.491,<sp/>-0.294,<sp/>0.0788,<sp/>-0.0612,<sp/>-1.85e-4}</highlight></codeline>
<codeline lineno="50"><highlight class="normal">};</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="suzuki_8c_1a8a4808c7463961718f1e5f1d808b9d0b" refkind="member"><highlight class="normal"><ref refid="ascot5_8h_1a865b01f4cbb6f2bb3270e094934d3263" kindref="member">integer</ref><sp/><ref refid="suzuki_8c_1a8a4808c7463961718f1e5f1d808b9d0b" kindref="member">Z_imp</ref>[]<sp/><sp/><sp/><sp/>=<sp/>{<sp/><sp/><sp/>2,<sp/><sp/><sp/>6,<sp/><sp/><sp/>6,<sp/><sp/><sp/>4,<sp/><sp/><sp/>8,<sp/><sp/><sp/>7,<sp/><sp/><sp/>3,<sp/><sp/><sp/>5,<sp/><sp/>26<sp/>};</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="60" refid="suzuki_8c_1a109ab95af25804fb2a466ef455c6a4da" refkind="member"><highlight class="normal"><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/><ref refid="suzuki_8c_1a109ab95af25804fb2a466ef455c6a4da" kindref="member">Zeffmin_imp</ref>[]<sp/>=<sp/>{<sp/>1.0,<sp/>1.0,<sp/>5.0,<sp/>1.0,<sp/>1.0,<sp/>1.0,<sp/>1.0,<sp/>1.0,<sp/>1.0<sp/>};</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="suzuki_8c_1a4bfd1c5469ef526248d81f55c085ecb6" refkind="member"><highlight class="normal"><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/><ref refid="suzuki_8c_1a4bfd1c5469ef526248d81f55c085ecb6" kindref="member">Zeffmax_imp</ref>[]<sp/>=<sp/>{<sp/>2.1,<sp/>5.0,<sp/>6.0,<sp/>4.0,<sp/>5.0,<sp/>5.0,<sp/>3.0,<sp/>5.0,<sp/>5.0<sp/>};</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="suzuki_8c_1a442ae8dedc39da181cb907c9c7d8bf08" refkind="member"><highlight class="normal"><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/><ref refid="suzuki_8c_1a442ae8dedc39da181cb907c9c7d8bf08" kindref="member">B_highE</ref>[9][12]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.231,<sp/><sp/><sp/><sp/><sp/>0.343,<sp/><sp/><sp/><sp/>-0.185,<sp/><sp/><sp/><sp/>-0.162e-1,<sp/><sp/>0.105,<sp/><sp/><sp/><sp/>-0.703e-1,</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.531e-1,<sp/><sp/>0.342e-2,<sp/>-0.838e-2,<sp/><sp/>0.415e-2,<sp/>-0.335e-2,<sp/>-0.221e-3<sp/>},</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.101e1,<sp/><sp/>-0.865e-2,<sp/>-0.124,<sp/><sp/><sp/><sp/>-0.145e-1,<sp/><sp/>0.391,<sp/><sp/><sp/><sp/><sp/>0.161e-1,</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.298e-1,<sp/><sp/>0.332e-2,<sp/>-0.248e-1,<sp/>-0.104e-2,<sp/>-0.152e-2,<sp/>-0.189e-3<sp/>},</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.100e1,<sp/><sp/>-0.255e-1,<sp/>-0.125,<sp/><sp/><sp/><sp/>-0.142e-1,<sp/><sp/>0.388,<sp/><sp/><sp/><sp/><sp/>0.206e-1,</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.297e-1,<sp/><sp/>0.326e-2,<sp/>-0.246e-1,<sp/>-0.131e-2,<sp/>-0.148e-2,<sp/>-0.180e-3<sp/>},</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.613,<sp/><sp/><sp/><sp/><sp/>0.552e-1,<sp/>-0.167,<sp/><sp/><sp/><sp/>-0.159e-1,<sp/><sp/>0.304,<sp/><sp/><sp/><sp/><sp/>0.154e-2,</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.436e-1,<sp/><sp/>0.378e-2,<sp/>-0.201e-1,<sp/>-0.216e-3,<sp/>-0.251e-2,<sp/>-0.227e-3<sp/>},</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.102e1,<sp/><sp/>-0.148e-1,<sp/>-0.674e-1,<sp/>-0.917e-2,<sp/><sp/>0.359,<sp/><sp/><sp/><sp/><sp/>0.143e-1,</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.139e-1,<sp/><sp/>0.184e-2,<sp/>-0.209e-1,<sp/>-0.732e-3,<sp/>-0.502e-3,<sp/>-0.949e-4<sp/>},</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.102e1,<sp/><sp/>-0.139e-1,<sp/>-0.979e-1,<sp/>-0.117e-1,<sp/><sp/>0.375,<sp/><sp/><sp/><sp/><sp/>0.156e-1,</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.224e-1,<sp/><sp/>0.254e-2,<sp/>-0.226e-1,<sp/>-0.889e-3,<sp/>-0.104e-2,<sp/>-0.139e-3<sp/>},</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.441,<sp/><sp/><sp/><sp/><sp/>0.129,<sp/><sp/><sp/><sp/>-0.170,<sp/><sp/><sp/><sp/>-0.162e-1,<sp/><sp/>0.277,<sp/><sp/><sp/><sp/>-0.156e-1,</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.466e-1,<sp/><sp/>0.379e-2,<sp/>-0.193e-1,<sp/><sp/>0.753e-3,<sp/>-0.286e-2,<sp/>-0.239e-3<sp/>},</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.732,<sp/><sp/><sp/><sp/><sp/>0.183e-1,<sp/>-0.155,<sp/><sp/><sp/><sp/>-0.172e-1,<sp/><sp/>0.321,<sp/><sp/><sp/><sp/><sp/>0.946e-2,</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.397e-1,<sp/><sp/>0.420e-2,<sp/>-0.204e-1,<sp/>-0.619e-3,<sp/>-0.224e-2,<sp/>-0.254e-3<sp/>},</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.820,<sp/><sp/><sp/><sp/>-0.636e-2,<sp/><sp/>0.542e-1,<sp/><sp/>0.395e-2,<sp/><sp/>0.202,<sp/><sp/><sp/><sp/><sp/>0.806e-3,</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-0.200e-2,<sp/>-0.178e-2,<sp/>-0.610e-2,<sp/><sp/>0.651e-3,<sp/><sp/>0.175e-2,<sp/><sp/>0.146e-3<sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal">};</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="102" refid="suzuki_8c_1a55b777f29d9f720c74af9f72aed7425c" refkind="member"><highlight class="normal"><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/><ref refid="suzuki_8c_1a55b777f29d9f720c74af9f72aed7425c" kindref="member">B_lowE</ref>[9][12]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.792,<sp/><sp/><sp/><sp/><sp/>0.420e-1,<sp/><sp/>0.530e-1,<sp/><sp/>-0.139e-1,<sp/><sp/>0.301,<sp/><sp/><sp/><sp/>-0.264e-1,</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-0.299e-1,<sp/><sp/>0.607e-2,<sp/><sp/>0.272e-3,<sp/><sp/><sp/>0.611e-2,<sp/><sp/>0.347e-2,<sp/>-0.919e-3<sp/>},</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.161,<sp/><sp/><sp/><sp/><sp/>0.598e-1,<sp/>-0.336e-2,<sp/><sp/>-0.426e-2,<sp/>-0.157,<sp/><sp/><sp/><sp/>-0.396e-1,</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.460e-2,<sp/><sp/>0.219e-2,<sp/><sp/>0.391e-1,<sp/><sp/><sp/>0.711e-2,<sp/>-0.144e-2,<sp/>-0.385e-3<sp/>},</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.158,<sp/><sp/><sp/><sp/><sp/>0.554e-1,<sp/>-0.431e-2,<sp/><sp/>-0.335e-2,<sp/>-0.155,<sp/><sp/><sp/><sp/>-0.374e-1,</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.537e-2,<sp/><sp/>0.174e-2,<sp/><sp/>0.388e-1,<sp/><sp/><sp/>0.683e-2,<sp/>-0.160e-2,<sp/>-0.322e-3<sp/>},</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.112,<sp/><sp/><sp/><sp/><sp/>0.495e-1,<sp/><sp/>0.116e-1,<sp/><sp/>-0.286e-2,<sp/>-0.149,<sp/><sp/><sp/><sp/>-0.331e-1,</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-0.426e-2,<sp/><sp/>0.980e-3,<sp/><sp/>0.447e-1,<sp/><sp/><sp/>0.652e-2,<sp/>-0.356e-3,<sp/>-0.203e-3<sp/>},</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.111,<sp/><sp/><sp/><sp/><sp/>0.541e-1,<sp/>-0.346e-3,<sp/><sp/>-0.368e-2,<sp/>-0.108,<sp/><sp/><sp/><sp/>-0.347e-1,</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.193e-2,<sp/><sp/>0.181e-2,<sp/><sp/>0.280e-1,<sp/><sp/><sp/>0.604e-2,<sp/>-0.841e-3,<sp/>-0.317e-3<sp/>},</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.139,<sp/><sp/><sp/><sp/><sp/>0.606e-1,<sp/>-0.306e-2,<sp/><sp/>-0.455e-2,<sp/>-0.133,<sp/><sp/><sp/><sp/>-0.394e-1,</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.399e-2,<sp/><sp/>0.236e-2,<sp/><sp/>0.335e-1,<sp/><sp/><sp/>0.690e-2,<sp/>-0.124e-2,<sp/>-0.405e-3<sp/>},</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.112,<sp/><sp/><sp/><sp/><sp/>0.495e-1,<sp/><sp/>0.116e-1,<sp/><sp/>-0.286e-2,<sp/>-0.149,<sp/><sp/><sp/><sp/>-0.331e-1,</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-0.426e-2,<sp/><sp/>0.980e-3,<sp/><sp/>0.447e-1,<sp/><sp/><sp/>0.652e-2,<sp/>-0.356e-3,<sp/>-0.203e-3<sp/>},</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><sp/>0.122,<sp/><sp/><sp/><sp/><sp/>0.527e-1,<sp/>-0.430e-3,<sp/><sp/>-0.318e-2,<sp/>-0.151,<sp/><sp/><sp/><sp/>-0.364e-1,</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.343e-2,<sp/><sp/>0.151e-2,<sp/><sp/>0.420e-1,<sp/><sp/><sp/>0.692e-2,<sp/>-0.141e-2,<sp/>-0.290e-3<sp/>},</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/>-0.110e-1,<sp/><sp/>0.202e-1,<sp/><sp/>0.946e-3,<sp/><sp/>-0.409e-2,<sp/>-0.666e-2,<sp/>-0.117e-1,</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>-0.236e-3,<sp/><sp/>0.202e-2,<sp/><sp/>0.408e-2,<sp/><sp/><sp/>0.185e-2,<sp/>-0.648e-4,<sp/>-0.313e-3<sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal">};</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="138" refid="suzuki_8c_1a3137723600419f37e26a80691bb5bb0f" refkind="member"><highlight class="normal"><ref refid="error_8h_1a3bca029fa2975420f00b89f3cb38872e" kindref="member">a5err</ref><sp/><ref refid="suzuki_8c_1a3137723600419f37e26a80691bb5bb0f" kindref="member">suzuki_sigmav</ref>(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>sigmav,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>EperAmu,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>ne,<sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>te,<sp/><ref refid="ascot5_8h_1a865b01f4cbb6f2bb3270e094934d3263" kindref="member">integer</ref><sp/>nion,</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>ni,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>Anum,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>Znum)<sp/>{</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="error_8h_1a3bca029fa2975420f00b89f3cb38872e" kindref="member">a5err</ref><sp/>err<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Convert<sp/>eperamu<sp/>to<sp/>keV<sp/>and<sp/>te<sp/>to<sp/>eV<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>EperAmu<sp/>/=<sp/>(1e3*<ref refid="consts_8h_1aa2d52037e91528e354a59fc909365f7c" kindref="member">CONST_E</ref>);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>te<sp/>/=<sp/><ref refid="consts_8h_1aa2d52037e91528e354a59fc909365f7c" kindref="member">CONST_E</ref>;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ind_H[3];<sp/></highlight><highlight class="comment">/*<sp/>Indices<sp/>of<sp/>possible<sp/>hydrogen<sp/>species<sp/>H,<sp/>D,<sp/>and<sp/>T<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n_H<sp/>=<sp/>0;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Total<sp/>number<sp/>of<sp/>hydrogen<sp/>species<sp/>(max<sp/>3)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ind_Z[<ref refid="ascot5_8h_1a9a9ccddfec36bf0f49a168a9dcb8f87e" kindref="member">MAX_SPECIES</ref>];<sp/></highlight><highlight class="comment">/*<sp/>Indices<sp/>of<sp/>impurity<sp/>species<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n_Z<sp/>=<sp/>0;<sp/><sp/></highlight><highlight class="comment">/*<sp/>Total<sp/>number<sp/>of<sp/>impurity<sp/>species<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Separate<sp/>ions<sp/>into<sp/>hydrogen<sp/>species<sp/>and<sp/>impurities<sp/>and<sp/>calculate</highlight></codeline>
<codeline lineno="151"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>their<sp/>total<sp/>densities<sp/>and<sp/>Zeff<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>dens_H<sp/>=<sp/>0.0,<sp/>dens_Z<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>Zeff_sum1<sp/>=<sp/>0.0,<sp/>Zeff_sum2<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>nion;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(Znum[i]<sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind_H[n_H]<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dens_H<sp/>+=<sp/>ni[i];</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_H++;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind_Z[n_Z]<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dens_Z<sp/>+=<sp/>ni[i];</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_Z++;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Zeff_sum1<sp/>+=<sp/>ni[i]<sp/>*<sp/>Znum[i]<sp/>*<sp/>Znum[i];</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Zeff_sum2<sp/>+=<sp/>ni[i]<sp/>*<sp/>Znum[i];</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>Zeff<sp/>=<sp/>Zeff_sum1<sp/>/<sp/>Zeff_sum2;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(n_H<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>hydrogen<sp/>species<sp/>present<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="error_8h_1a580a0b8b4a823a26a00b2f83d9343bc4" kindref="member">error_raise</ref>(<sp/><ref refid="error_8h_1a6756b9f30781ed8ca8ce938e49ad9d92aaa34d7aa427b982efa61030ebc069963" kindref="member">ERR_INPUT_EVALUATION</ref>,<sp/>__LINE__,<sp/><ref refid="error_8h_1a4e101179605aba551caa2576fd83a1dda5d6dc5bbf8b8a0973b0950ff63e655eb" kindref="member">EF_SUZUKI</ref><sp/>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Select<sp/>low-<sp/>or<sp/>high-energy<sp/>coefficient<sp/>tables<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>(*A)[10];</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>(*B)[12];</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(EperAmu<sp/>&gt;=<sp/>9.0<sp/>&amp;&amp;<sp/>EperAmu<sp/>&lt;<sp/>100.0)<sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>=<sp/><ref refid="suzuki_8c_1a09a99dcb36ce26b7ad51499718690854" kindref="member">A_lowE</ref>;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B<sp/>=<sp/><ref refid="suzuki_8c_1a55b777f29d9f720c74af9f72aed7425c" kindref="member">B_lowE</ref>;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(EperAmu<sp/>&lt;<sp/>10000.0)<sp/>{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>=<sp/><ref refid="suzuki_8c_1a6acdaabc073daeabb9582ea7632b205f" kindref="member">A_highE</ref>;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B<sp/>=<sp/><ref refid="suzuki_8c_1a442ae8dedc39da181cb907c9c7d8bf08" kindref="member">B_highE</ref>;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Outside<sp/>energy<sp/>range,<sp/>just<sp/>put<sp/>some<sp/>data<sp/>to<sp/>avoid<sp/>segfaults<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>=<sp/><ref refid="suzuki_8c_1a09a99dcb36ce26b7ad51499718690854" kindref="member">A_lowE</ref>;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>B<sp/>=<sp/><ref refid="suzuki_8c_1a55b777f29d9f720c74af9f72aed7425c" kindref="member">B_lowE</ref>;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="error_8h_1a580a0b8b4a823a26a00b2f83d9343bc4" kindref="member">error_raise</ref>(<sp/><ref refid="error_8h_1a6756b9f30781ed8ca8ce938e49ad9d92aaa34d7aa427b982efa61030ebc069963" kindref="member">ERR_INPUT_EVALUATION</ref>,<sp/>__LINE__,<sp/><ref refid="error_8h_1a4e101179605aba551caa2576fd83a1dda5d6dc5bbf8b8a0973b0950ff63e655eb" kindref="member">EF_SUZUKI</ref><sp/>);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>logE<sp/>=<sp/>log(EperAmu);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>N<sp/><sp/><sp/><sp/>=<sp/>ne<sp/>*<sp/>1.0e-19;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>logN<sp/>=<sp/>log(N);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>U<sp/><sp/><sp/><sp/>=<sp/>log(te<sp/>*<sp/>1.0e-3);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Equation<sp/>28<sp/>for<sp/>sigma_H<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>sigma_H<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_H;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*<sp/>Aijk<sp/>=<sp/>A[Anum[ind_H[i]]-1];</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Weight<sp/>with<sp/>density<sp/>in<sp/>case<sp/>we<sp/>have<sp/>multiple<sp/>hydrogen<sp/>species<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_H<sp/>+=<sp/>ni[ind_H[i]]</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(<sp/>Aijk[0]<sp/>*<sp/>1.e-16<sp/>/<sp/>EperAmu<sp/>)</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(<sp/>1.0<sp/>+<sp/>Aijk[1]<sp/>*<sp/>logE<sp/>+<sp/>Aijk[2]<sp/>*<sp/>logE<sp/>*<sp/>logE<sp/>)</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(<sp/>1.0<sp/>+<sp/>pow(<sp/>1.0<sp/>-<sp/>exp(<sp/>-Aijk[3]<sp/>*<sp/>N<sp/>),<sp/>Aijk[4]<sp/>)</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(Aijk[5]<sp/>+<sp/>Aijk[6]<sp/>*<sp/>logE<sp/>+<sp/>Aijk[7]<sp/>*<sp/>logE<sp/>*<sp/>logE)<sp/>)</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(<sp/>1.0<sp/>+<sp/>Aijk[8]<sp/>*<sp/>U<sp/>+<sp/>Aijk[9]<sp/>*<sp/>U<sp/>*<sp/>U<sp/>);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>sigma_H<sp/>/=<sp/>dens_H;</highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Equations<sp/>26<sp/>&amp;<sp/>27<sp/>for<sp/>Sz<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref><sp/>sigma_Z<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_Z;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ind_B<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>9;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="suzuki_8c_1a8a4808c7463961718f1e5f1d808b9d0b" kindref="member">Z_imp</ref>[j]<sp/>==<sp/>Znum[ind_Z[i]]<sp/>&amp;&amp;<sp/>Zeff<sp/>&gt;<sp/><ref refid="suzuki_8c_1a109ab95af25804fb2a466ef455c6a4da" kindref="member">Zeffmin_imp</ref>[j]</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>Zeff<sp/>&lt;<sp/><ref refid="suzuki_8c_1a4bfd1c5469ef526248d81f55c085ecb6" kindref="member">Zeffmax_imp</ref>[j])<sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ind_B<sp/>=<sp/>j;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ind_B<sp/>&lt;<sp/>0<sp/>&amp;&amp;<sp/>!err)<sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Data<sp/>for<sp/>the<sp/>input<sp/>species<sp/>not<sp/>tabulated<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="error_8h_1a580a0b8b4a823a26a00b2f83d9343bc4" kindref="member">error_raise</ref>(<sp/><ref refid="error_8h_1a6756b9f30781ed8ca8ce938e49ad9d92aaa34d7aa427b982efa61030ebc069963" kindref="member">ERR_INPUT_EVALUATION</ref>,<sp/>__LINE__,<sp/><ref refid="error_8h_1a4e101179605aba551caa2576fd83a1dda5d6dc5bbf8b8a0973b0950ff63e655eb" kindref="member">EF_SUZUKI</ref><sp/>);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_Z<sp/>+=<sp/>ni[ind_Z[i]]<sp/>/<sp/>ne<sp/>*<sp/>Znum[ind_Z[i]]</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(B[ind_B][0]</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][1]<sp/><sp/>*<sp/>U</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][2]<sp/><sp/>*<sp/>logN</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][3]<sp/><sp/>*<sp/>logN<sp/>*<sp/>U</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][4]<sp/><sp/>*<sp/>logE</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][5]<sp/><sp/>*<sp/>logE<sp/>*<sp/>U</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][6]<sp/><sp/>*<sp/>logE<sp/>*<sp/>logN</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][7]<sp/><sp/>*<sp/>logE<sp/>*<sp/>logN<sp/>*<sp/>U</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][8]<sp/><sp/>*<sp/>logE<sp/>*<sp/>logE</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][9]<sp/><sp/>*<sp/>logE<sp/>*<sp/>logE<sp/>*<sp/>U</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][10]<sp/>*<sp/>logE<sp/>*<sp/>logE<sp/>*<sp/>logN</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>B[ind_B][11]<sp/>*<sp/>logE<sp/>*<sp/>logE<sp/>*<sp/>logN<sp/>*<sp/>U);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Equation<sp/>24<sp/>and<sp/>convert<sp/>cm^2<sp/>to<sp/>m^2*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>*sigmav<sp/>=<sp/>sigma_H<sp/>*<sp/>(1<sp/>+<sp/>(Zeff<sp/>-<sp/>1)<sp/>*<sp/>sigma_Z)<sp/>*<sp/>1e-4;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(err)<sp/>{<sp/>*sigmav<sp/>=<sp/>0.0;<sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="243"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="suzuki.c"/>
  </compounddef>
</doxygen>
