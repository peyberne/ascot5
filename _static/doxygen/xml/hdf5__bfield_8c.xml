<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="hdf5__bfield_8c" kind="file" language="C++">
    <compoundname>hdf5_bfield.c</compoundname>
    <includes local="no">stdlib.h</includes>
    <includes local="no">stdio.h</includes>
    <includes refid="math_8h" local="no">math.h</includes>
    <includes local="no">hdf5.h</includes>
    <includes local="no">hdf5_hl.h</includes>
    <includes refid="ascot5_8h" local="yes">../ascot5.h</includes>
    <includes refid="print_8h" local="yes">../print.h</includes>
    <includes refid="consts_8h" local="yes">../consts.h</includes>
    <includes refid="B__field_8h" local="yes">../B_field.h</includes>
    <includes refid="B__2DS_8h" local="yes">../Bfield/B_2DS.h</includes>
    <includes refid="B__3DS_8h" local="yes">../Bfield/B_3DS.h</includes>
    <includes refid="B__STS_8h" local="yes">../Bfield/B_STS.h</includes>
    <includes refid="B__TC_8h" local="yes">../Bfield/B_TC.h</includes>
    <includes refid="B__GS_8h" local="yes">../Bfield/B_GS.h</includes>
    <includes refid="hdf5__helpers_8h" local="yes">hdf5_helpers.h</includes>
    <includes refid="hdf5__bfield_8h" local="yes">hdf5_bfield.h</includes>
    <incdepgraph>
      <node id="16">
        <label>../spline/interp.h</label>
        <link refid="interp_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>Bfield/B_GS.h</label>
        <link refid="B__GS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>stdlib.h</label>
      </node>
      <node id="9">
        <label>hdf5_hl.h</label>
      </node>
      <node id="6">
        <label>omp.h</label>
      </node>
      <node id="11">
        <label>../consts.h</label>
        <link refid="consts_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>hdf5_helpers.h</label>
        <link refid="hdf5__helpers_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>../B_field.h</label>
        <link refid="B__field_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>error.h</label>
        <link refid="error_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>hdf5.h</label>
      </node>
      <node id="7">
        <label>time.h</label>
      </node>
      <node id="20">
        <label>Bfield/B_TC.h</label>
        <link refid="B__TC_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>../linint/linint.h</label>
        <link refid="linint_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>Bfield/B_2DS.h</label>
        <link refid="B__2DS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>Bfield/B_3DS.h</label>
        <link refid="B__3DS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>math.h</label>
        <link refid="math_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>stdio.h</label>
      </node>
      <node id="18">
        <label>Bfield/B_STS.h</label>
        <link refid="B__STS_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>../print.h</label>
        <link refid="print_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>ascot5.h</label>
        <link refid="ascot5_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>hdf5io/hdf5_bfield.c</label>
        <link refid="hdf5__bfield_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>hdf5_bfield.h</label>
        <link refid="hdf5__bfield_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" prot="public" static="no">
        <name>BPATH</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Macro that is used to store paths to data groups </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="35" column="9" bodyfile="hdf5io/hdf5_bfield.c" bodystart="35" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" prot="public" static="no">
        <name>BPATH</name>
        <initializer>&quot;/bfield/B_2DS_XXXXXXXXXX/&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Macro that is used to store paths to data groups </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="160" column="18" bodyfile="hdf5io/hdf5_bfield.c" bodystart="35" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" prot="public" static="no">
        <name>BPATH</name>
        <initializer>&quot;/bfield/B_3DS_XXXXXXXXXX/&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Macro that is used to store paths to data groups </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="259" column="18" bodyfile="hdf5io/hdf5_bfield.c" bodystart="35" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" prot="public" static="no">
        <name>BPATH</name>
        <initializer>&quot;/bfield/B_STS_XXXXXXXXXX/&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Macro that is used to store paths to data groups </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="398" column="18" bodyfile="hdf5io/hdf5_bfield.c" bodystart="35" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" prot="public" static="no">
        <name>BPATH</name>
        <initializer>&quot;/bfield/B_TC_XXXXXXXXXX/&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Macro that is used to store paths to data groups </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="536" column="18" bodyfile="hdf5io/hdf5_bfield.c" bodystart="35" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" prot="public" static="no">
        <name>BPATH</name>
        <initializer>&quot;/bfield/B_GS_XXXXXXXXXX/&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Macro that is used to store paths to data groups </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="587" column="18" bodyfile="hdf5io/hdf5_bfield.c" bodystart="35" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="hdf5__bfield_8c_1a7b86d9ae8a159cb57538e939e51bcce8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int hdf5_bfield_read_2DS</definition>
        <argsstring>(hid_t f, B_2DS_offload_data *offload_data, real **offload_array, char *qid)</argsstring>
        <name>hdf5_bfield_read_2DS</name>
        <param>
          <type>hid_t</type>
          <declname>f</declname>
        </param>
        <param>
          <type><ref refid="structB__2DS__offload__data" kindref="compound">B_2DS_offload_data</ref> *</type>
          <declname>offload_data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>qid</declname>
        </param>
        <briefdescription>
<para>Read magnetic field data of type B_2DS. </para>
        </briefdescription>
        <detaileddescription>
<para>The B_2DS data is stored in HDF5 file under the group /bfield/B_2DS_XXXXXXXXXX/ where X&apos;s mark the QID.</para>
<para>This function assumes the group holds the following datasets:</para>
<para><itemizedlist>
<listitem><para>int nr Number of R grid points in the magnetic field grid</para>
</listitem><listitem><para>int nz Number of z grid points in the magnetic field grid</para>
</listitem><listitem><para>double rmin Minimum value in R grid [m]</para>
</listitem><listitem><para>double rmax Maximum value in R grid [m]</para>
</listitem><listitem><para>double zmin Minimum value in z grid [m]</para>
</listitem><listitem><para>double zmax Maximum value in z grid [m]</para>
</listitem><listitem><para>double axisr Magnetic axis R coordinate [m]</para>
</listitem><listitem><para>double axisz Magnetic axis z coordinate [m]</para>
</listitem><listitem><para>double psi0 Poloidal magnetic flux value on magnetic axis [V*s*m^-1]</para>
</listitem><listitem><para>double psi1 Poloidal magnetic flux value on separatrix [V*s*m^-1]</para>
</listitem><listitem><para>double psi Poloidal magnetic flux on the Rz-grid as a {nz, nR} matrix [V*s*m^-1]</para>
</listitem><listitem><para>double br Magnetic field R component on the Rz-grid as a {nz, nR} matrix [T]</para>
</listitem><listitem><para>double bphi Magnetic field R component on the Rz-grid as a {nz, nR} matrix [T]</para>
</listitem><listitem><para>double bz Magnetic field R component on the Rz-grid as a {nz, nR} matrix [T]</para>
</listitem></itemizedlist>
</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>f</parametername>
</parameternamelist>
<parameterdescription>
<para>HDF5 file identifier for a file which is opened and closed outside of this function </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload data struct which is allocated here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload array which is allocated here and used to store psi, B_R, B_phi, and B_z values as required by <ref refid="B__2DS_8c_1afcf0b85f08ad40a47972977c250f40e8" kindref="member">B_2DS_init_offload()</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qid</parametername>
</parameternamelist>
<parameterdescription>
<para>QID of the B_2DS field that is to be read</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if reading succeeded </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="157" column="5" bodyfile="hdf5io/hdf5_bfield.c" bodystart="157" bodyend="204" declfile="hdf5io/hdf5_bfield.c" declline="37" declcolumn="5"/>
      </memberdef>
      <memberdef kind="function" id="hdf5__bfield_8c_1ac6ac4ccb41e491f4a3206a9c94c5494a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int hdf5_bfield_read_3DS</definition>
        <argsstring>(hid_t f, B_3DS_offload_data *offload_data, real **offload_array, char *qid)</argsstring>
        <name>hdf5_bfield_read_3DS</name>
        <param>
          <type>hid_t</type>
          <declname>f</declname>
        </param>
        <param>
          <type><ref refid="structB__3DS__offload__data" kindref="compound">B_3DS_offload_data</ref> *</type>
          <declname>offload_data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>qid</declname>
        </param>
        <briefdescription>
<para>Read magnetic field data of type B_3DS. </para>
        </briefdescription>
        <detaileddescription>
<para>The B_3DS data is stored in HDF5 file under the group /bfield/B_3DS-XXXXXXXXXX/ where X&apos;s mark the QID.</para>
<para>This function assumes the group holds the following datasets: (B data refers to <formula id="5">$B_R$</formula>, <formula id="34">$B_phi$</formula>, and <formula id="6">$B_z$</formula> and psi data to <formula id="7">$\psi$</formula>.)</para>
<para><itemizedlist>
<listitem><para>int nr Number of R grid points in the B data grid</para>
</listitem><listitem><para>int nphi Number of phi grid points in the B data grid</para>
</listitem><listitem><para>int nz Number of z grid points in the B data grid</para>
</listitem><listitem><para>double b_rmin Minimum value in B data R grid [m]</para>
</listitem><listitem><para>double b_rmax Maximum value in B data R grid [m]</para>
</listitem><listitem><para>double b_phimin Minimum value in B data phi grid [deg]</para>
</listitem><listitem><para>double b_phimax Maximum value in B data phi grid [deg]</para>
</listitem><listitem><para>double b_zmin Minimum value in B data z grid [m]</para>
</listitem><listitem><para>double b_zmax Maximum value in B data z grid [m]</para>
</listitem><listitem><para>int b_nr Number of R grid points in the psi data grid</para>
</listitem><listitem><para>int psi_nz Number of z grid points in the psi data grid</para>
</listitem><listitem><para>double ps_rmin Minimum value in psi data R grid [m]</para>
</listitem><listitem><para>double psi_rmax Maximum value in psi data R grid [m]</para>
</listitem><listitem><para>double psi_zmin Minimum value in psi data z grid [m]</para>
</listitem><listitem><para>double psi_zmax Maximum value in psi data z grid [m]</para>
</listitem><listitem><para>double axisr Magnetic axis R coordinate [m]</para>
</listitem><listitem><para>double axisz Magnetic axis z coordinate [m]</para>
</listitem><listitem><para>double psi0 Poloidal magnetic flux value on magnetic axis [V*s*m^-1]</para>
</listitem><listitem><para>double psi1 Poloidal magnetic flux value on separatrix [V*s*m^-1]</para>
</listitem><listitem><para>double psi Poloidal magnetic flux on the Rz-grid as a {psi_nz, psi_nr} matrix [V*s*m^-1]</para>
</listitem><listitem><para>double br Magnetic field R component on the Rz-grid as a {b_nz, b_nphi, b_nr} matrix [T]</para>
</listitem><listitem><para>double bphi Magnetic field R component on the Rz-grid as a {b_nz, b_nphi, b_nr} matrix [T]</para>
</listitem><listitem><para>double bz Magnetic field R component on the Rz-grid as a {b_nz, b_nphi, b_nr} matrix [T]</para>
</listitem></itemizedlist>
</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>f</parametername>
</parameternamelist>
<parameterdescription>
<para>HDF5 file identifier for a file which is opened and closed outside of this function </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload data struct which is allocated here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload array which is allocated here and used to store psi, B_R, B_phi, and B_z values as required by <ref refid="B__3DS_8c_1a6ef9bae22aaa9142883fd9235c094690" kindref="member">B_3DS_init_offload()</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qid</parametername>
</parameternamelist>
<parameterdescription>
<para>QID of the B_3DS field that is to be read</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if reading succeeded </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="256" column="5" bodyfile="hdf5io/hdf5_bfield.c" bodystart="256" bodyend="333" declfile="hdf5io/hdf5_bfield.c" declline="39" declcolumn="5"/>
      </memberdef>
      <memberdef kind="function" id="hdf5__bfield_8c_1a3e6ba4c926f9e8438b659226da276515" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int hdf5_bfield_read_STS</definition>
        <argsstring>(hid_t f, B_STS_offload_data *offload_data, real **offload_array, char *qid)</argsstring>
        <name>hdf5_bfield_read_STS</name>
        <param>
          <type>hid_t</type>
          <declname>f</declname>
        </param>
        <param>
          <type><ref refid="structB__STS__offload__data" kindref="compound">B_STS_offload_data</ref> *</type>
          <declname>offload_data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>qid</declname>
        </param>
        <briefdescription>
<para>Read magnetic field data of type B_STS. </para>
        </briefdescription>
        <detaileddescription>
<para>The B_STS data is stored in HDF5 file under the group /bfield/B_STS_XXXXXXXXXX/ where X&apos;s mark the QID.</para>
<para>This function assumes the group holds the following datasets: (B data refers to <formula id="5">$B_R$</formula>, <formula id="34">$B_phi$</formula>, and <formula id="6">$B_z$</formula> and psi data to <formula id="7">$\psi$</formula>.)</para>
<para><itemizedlist>
<listitem><para>int nr Number of R grid points in the B data grid</para>
</listitem><listitem><para>int nphi Number of phi grid points in the B data grid</para>
</listitem><listitem><para>int nz Number of z grid points in the B data grid</para>
</listitem><listitem><para>double b_rmin Minimum value in B data R grid [m]</para>
</listitem><listitem><para>double b_rmax Maximum value in B data R grid [m]</para>
</listitem><listitem><para>double b_phimin Minimum value in B data phi grid [deg]</para>
</listitem><listitem><para>double b_phimax Maximum value in B data phi grid [deg]</para>
</listitem><listitem><para>double b_zmin Minimum value in B data z grid [m]</para>
</listitem><listitem><para>double b_zmax Maximum value in B data z grid [m]</para>
</listitem><listitem><para>int psi_nr Number of R grid points in the psi data grid</para>
</listitem><listitem><para>int psi_nphi Number of phi grid points in the psi data grid</para>
</listitem><listitem><para>int psi_nz Number of z grid points in the psi data grid</para>
</listitem><listitem><para>double psi_rmin Minimum value in psi data R grid [m]</para>
</listitem><listitem><para>double psi_rmax Maximum value in psi data R grid [m]</para>
</listitem><listitem><para>double psi_phimin Minimum value in psi data phi grid [deg]</para>
</listitem><listitem><para>double psi_phimax Maximum value in psi data phi grid [deg]</para>
</listitem><listitem><para>double psi_zmin Minimum value in psi data z grid [m]</para>
</listitem><listitem><para>double psi_zmax Maximum value in psi data z grid [m]</para>
</listitem><listitem><para>int n_axis Number of phi grid points in the magnetic axis data grid</para>
</listitem><listitem><para>double axis_min Minimum value in magnetic axis data phi grid [deg]</para>
</listitem><listitem><para>double axis_max Maximum value in magnetic axis data phi grid [deg]</para>
</listitem><listitem><para>double psi0 Poloidal magnetic flux value on magnetic axis [V*s*m^-1]</para>
</listitem><listitem><para>double psi1 Poloidal magnetic flux value on separatrix [V*s*m^-1]</para>
</listitem><listitem><para>double psi Poloidal magnetic flux on the Rpz-grid as a {psi_nphi, psi_nz, psi_nr} matrix [V*s*m^-1]</para>
</listitem><listitem><para>double br Magnetic field R component on the Rpz-grid as a {b_nphi, b_nz, b_nr} matrix [T]</para>
</listitem><listitem><para>double bphi Magnetic field R component on the Rpz-grid as a {b_nphi, b_nz, b_nr} matrix [T]</para>
</listitem><listitem><para>double bz Magnetic field R component on the Rpz-grid as a {b_nphi, b_nz, b_nr} matrix [T]</para>
</listitem><listitem><para>double axis_R Magnetic axis R location as a {n_axis} vector [m]</para>
</listitem><listitem><para>double axis_z Magnetic axis R location as a {n_axis} vector [m]</para>
</listitem><listitem><para>int toroidalPeriods Fraction of the device the data represents.</para>
</listitem></itemizedlist>
</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>f</parametername>
</parameternamelist>
<parameterdescription>
<para>HDF5 file identifier for a file which is opened and closed outside of this function </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload data struct which is allocated here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload array which is allocated here and used to store psi, B_R, B_phi, B_z, axis_r, and axis_z values as required by <ref refid="B__STS_8c_1acb08fede18445a4c412118c8d0dca978" kindref="member">B_STS_init_offload()</ref> </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qid</parametername>
</parameternamelist>
<parameterdescription>
<para>QID of the B_STS field that is to be read</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if reading succeeded </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="395" column="5" bodyfile="hdf5io/hdf5_bfield.c" bodystart="395" bodyend="502" declfile="hdf5io/hdf5_bfield.c" declline="41" declcolumn="5"/>
      </memberdef>
      <memberdef kind="function" id="hdf5__bfield_8c_1adba26489f9245e7937677d0a37676de0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int hdf5_bfield_read_TC</definition>
        <argsstring>(hid_t f, B_TC_offload_data *offload_data, real **offload_array, char *qid)</argsstring>
        <name>hdf5_bfield_read_TC</name>
        <param>
          <type>hid_t</type>
          <declname>f</declname>
        </param>
        <param>
          <type><ref refid="structB__TC__offload__data" kindref="compound">B_TC_offload_data</ref> *</type>
          <declname>offload_data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>qid</declname>
        </param>
        <briefdescription>
<para>Read magnetic field data of type B_TC. </para>
        </briefdescription>
        <detaileddescription>
<para>The B_TC data is stored in HDF5 file under the group /bfield/B_TC_XXXXXXXXXX/ where X&apos;s mark the QID.</para>
<para>This function assumes the group holds the following datasets:</para>
<para><itemizedlist>
<listitem><para>double axisr A value that is returned when magnetic axis R coordinate is requested [m]</para>
</listitem><listitem><para>double axisz A value that is returned when magnetic axis z coordinate is requested [m]</para>
</listitem><listitem><para>double psival A value that is returned when poloidal magnetic flux value is requested [V*s*m^-1]</para>
</listitem><listitem><para>double rhoval A value that is returned when normalized poloidal flux value is requested</para>
</listitem><listitem><para>double Bxyz Magnetic field values at origo: [B_x, B_y, B_z] [T]</para>
</listitem><listitem><para>double jacobian Magnetic field Jacobian [dB_x/dx, dB_x/dy, dB_x/dz, dB_y/dx, dB_y/dy, dB_y/dz, dB_z/dx, dB_z/dy, dB_z/dz] [T/m]</para>
</listitem></itemizedlist>
</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>f</parametername>
</parameternamelist>
<parameterdescription>
<para>HDF5 file identifier for a file which is opened and closed outside of this function </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload data struct which is allocated here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload array but no data is stored there so it is not allocated and NULL pointer is returned instead </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qid</parametername>
</parameternamelist>
<parameterdescription>
<para>QID of the B_TC field that is to be read</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if reading succeeded </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="533" column="5" bodyfile="hdf5io/hdf5_bfield.c" bodystart="533" bodyend="553" declfile="hdf5io/hdf5_bfield.c" declline="43" declcolumn="5"/>
      </memberdef>
      <memberdef kind="function" id="hdf5__bfield_8c_1ad7721125ba1c0c592243e170ca83aff2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int hdf5_bfield_read_GS</definition>
        <argsstring>(hid_t f, B_GS_offload_data *offload_data, real **offload_array, char *qid)</argsstring>
        <name>hdf5_bfield_read_GS</name>
        <param>
          <type>hid_t</type>
          <declname>f</declname>
        </param>
        <param>
          <type><ref refid="structB__GS__offload__data" kindref="compound">B_GS_offload_data</ref> *</type>
          <declname>offload_data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>qid</declname>
        </param>
        <briefdescription>
<para>Read magnetic field data of type B_GS. </para>
        </briefdescription>
        <detaileddescription>
<para>The B_GS data is stored in HDF5 file under the group /bfield/B_GS_XXXXXXXXXX/ where X&apos;s mark the QID.</para>
<para>This function assumes the group holds the following datasets:</para>
<para><itemizedlist>
<listitem><para>double r0 Magnetic axis R coordinate [m]</para>
</listitem><listitem><para>double z0 Magnetic axis z coordinate [m]</para>
</listitem><listitem><para>double bphi0 Toroidal magnetic field value at magnetic axis [T]</para>
</listitem><listitem><para>double psi0 Poloidal flux value at magnetic axis [V*s*m^-1]</para>
</listitem><listitem><para>double psi1 Poloidal flux value at separatrix [V*s*m^-1]</para>
</listitem><listitem><para>double psi_mult Scaling factor for psi</para>
</listitem><listitem><para>double coefficients Coefficients for evaluating psi [c_1, c_2, ..., c_12, A]</para>
</listitem><listitem><para>double delta0 Ripple strength</para>
</listitem><listitem><para>double alpha0 Ripple penetration</para>
</listitem><listitem><para>double a0 Minor radius [m]</para>
</listitem><listitem><para>int nripple Number of toroidal field coils</para>
</listitem></itemizedlist>
</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>f</parametername>
</parameternamelist>
<parameterdescription>
<para>HDF5 file identifier for a file which is opened and closed outside of this function </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload data struct which is allocated here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload array but no data is stored there so it is not allocated and NULL pointer is returned instead </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qid</parametername>
</parameternamelist>
<parameterdescription>
<para>QID of the B_GS field that is to be read</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if reading succeeded </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="584" column="5" bodyfile="hdf5io/hdf5_bfield.c" bodystart="584" bodyend="622" declfile="hdf5io/hdf5_bfield.c" declline="45" declcolumn="5"/>
      </memberdef>
      <memberdef kind="function" id="hdf5__bfield_8c_1a59dacef5bb8ee42211b378aac4747070" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int hdf5_bfield_init_offload</definition>
        <argsstring>(hid_t f, B_field_offload_data *offload_data, real **offload_array, char *qid)</argsstring>
        <name>hdf5_bfield_init_offload</name>
        <param>
          <type>hid_t</type>
          <declname>f</declname>
        </param>
        <param>
          <type><ref refid="structB__field__offload__data" kindref="compound">B_field_offload_data</ref> *</type>
          <declname>offload_data</declname>
        </param>
        <param>
          <type><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref> **</type>
          <declname>offload_array</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>qid</declname>
        </param>
        <briefdescription>
<para>Initialize magnetic field offload data from HDF5 file. </para>
        </briefdescription>
        <detaileddescription>
<para>This function determines to which type of magnetic field the given QID corresponds to, and calls the corresponding reading routine. The read data is then used to initialize the offload data by calling <ref refid="B__field_8c_1a2d598ab320e3063286cdbde51a265d74" kindref="member">B_field_init_offload()</ref>.</para>
<para>The magnetic field data is stored under /bfield/ group in ASCOT5 HDF5 file. Several magnetic fields of same or different type maybe stored there in their respective groups as long as the group name contains QID as an identifier.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>f</parametername>
</parameternamelist>
<parameterdescription>
<para>HDF5 file identifier for a file which is opened and closed outside of this function </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_data</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload data struct which is initialized here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>offload_array</parametername>
</parameternamelist>
<parameterdescription>
<para>pointer to offload array which is allocated and initialized here </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qid</parametername>
</parameternamelist>
<parameterdescription>
<para>QID of the data that is to be read</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>zero if reading and initialization succeeded </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="hdf5io/hdf5_bfield.c" line="69" column="5" bodyfile="hdf5io/hdf5_bfield.c" bodystart="69" bodyend="118"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Module for reading magnetic field data from HDF5 file. </para>
    </briefdescription>
    <detaileddescription>
<para>This module contains routines to read magnetic field data from ASCOT5 HDF5 file. The reading is done by calling <ref refid="hdf5__bfield_8c_1a59dacef5bb8ee42211b378aac4747070" kindref="member">hdf5_bfield_init_offload()</ref> which reads the data and uses that to initialize the offload data.</para>
<para>Note: the routines within this module that read the data from HDF5 file may use the offload data struct and offload arrays as (temporary) storage. However, the actual initialization is done at the specific <ref refid="B__field_8c_1a2d598ab320e3063286cdbde51a265d74" kindref="member">B_field_init_offload()</ref> function the magnetic field data corresponds to. Check from that function what the offload data and the offload array are expected to contain. As a rule of thumb, the reading routines here should only read the data and maybe do some trivial computations but nothing complicated. </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="math_8h" kindref="compound">math.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;hdf5.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;hdf5_hl.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../ascot5.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../math.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../print.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../consts.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../B_field.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../Bfield/B_2DS.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../Bfield/B_3DS.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../Bfield/B_STS.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../Bfield/B_TC.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../Bfield/B_GS.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="hdf5__helpers_8h" kindref="compound">hdf5_helpers.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="hdf5__bfield_8h" kindref="compound">hdf5_bfield.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BPATH<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1a7b86d9ae8a159cb57538e939e51bcce8" kindref="member">hdf5_bfield_read_2DS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__2DS__offload__data" kindref="compound">B_2DS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid);</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1ac6ac4ccb41e491f4a3206a9c94c5494a" kindref="member">hdf5_bfield_read_3DS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__3DS__offload__data" kindref="compound">B_3DS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1a3e6ba4c926f9e8438b659226da276515" kindref="member">hdf5_bfield_read_STS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__STS__offload__data" kindref="compound">B_STS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid);</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1adba26489f9245e7937677d0a37676de0" kindref="member">hdf5_bfield_read_TC</ref>(hid_t<sp/>f,<sp/><ref refid="structB__TC__offload__data" kindref="compound">B_TC_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid);</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1ad7721125ba1c0c592243e170ca83aff2" kindref="member">hdf5_bfield_read_GS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__GS__offload__data" kindref="compound">B_GS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid);</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="hdf5__bfield_8c_1a59dacef5bb8ee42211b378aac4747070" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1a59dacef5bb8ee42211b378aac4747070" kindref="member">hdf5_bfield_init_offload</ref>(hid_t<sp/>f,<sp/><ref refid="structB__field__offload__data" kindref="compound">B_field_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid)<sp/>{</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>path[256];<sp/></highlight><highlight class="comment">//<sp/>Storage<sp/>array<sp/>required<sp/>for<sp/>hdf5_gen_path()<sp/>calls</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>err<sp/>=<sp/>1;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Error<sp/>flag<sp/>which<sp/>is<sp/>nullified<sp/>if<sp/>data<sp/>is<sp/>read<sp/>succesfully</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>data<sp/>the<sp/>QID<sp/>corresponds<sp/>to<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hdf5__helpers_8c_1ab43ae79d4f8e8d83bf098da8a0054a72" kindref="member">hdf5_gen_path</ref>(</highlight><highlight class="stringliteral">&quot;/bfield/B_TC_XXXXXXXXXX&quot;</highlight><highlight class="normal">,<sp/>qid,<sp/>path);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!<ref refid="hdf5__helpers_8c_1a3b6edfba63099574025bea60453da24b" kindref="member">hdf5_find_group</ref>(f,<sp/>path)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__field__offload__data_1aa831a5fdf440b4490c9cf774be57349b" kindref="member">type</ref><sp/>=<sp/><ref refid="B__field_8h_1a807b3aa80967ae6c94bd38f23e391ea6a24ea2346ab109f89825d54ea4518e662" kindref="member">B_field_type_TC</ref>;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="hdf5__bfield_8c_1adba26489f9245e7937677d0a37676de0" kindref="member">hdf5_bfield_read_TC</ref>(f,<sp/>&amp;(offload_data-&gt;<ref refid="structB__field__offload__data_1aa9584fb7afce2bf745fce0b9048f5a1f" kindref="member">BTC</ref>),</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_array,<sp/>qid);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hdf5__helpers_8c_1ab43ae79d4f8e8d83bf098da8a0054a72" kindref="member">hdf5_gen_path</ref>(</highlight><highlight class="stringliteral">&quot;/bfield/B_GS_XXXXXXXXXX&quot;</highlight><highlight class="normal">,<sp/>qid,<sp/>path);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!<ref refid="hdf5__helpers_8c_1a3b6edfba63099574025bea60453da24b" kindref="member">hdf5_find_group</ref>(f,<sp/>path)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__field__offload__data_1aa831a5fdf440b4490c9cf774be57349b" kindref="member">type</ref><sp/>=<sp/><ref refid="B__field_8h_1a807b3aa80967ae6c94bd38f23e391ea6aeaae35c569ce5b05f25150378264dad5" kindref="member">B_field_type_GS</ref>;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="hdf5__bfield_8c_1ad7721125ba1c0c592243e170ca83aff2" kindref="member">hdf5_bfield_read_GS</ref>(f,<sp/>&amp;(offload_data-&gt;<ref refid="structB__field__offload__data_1ad568b60fc7226dc57def1746aae5370c" kindref="member">BGS</ref>),</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_array,<sp/>qid);</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hdf5__helpers_8c_1ab43ae79d4f8e8d83bf098da8a0054a72" kindref="member">hdf5_gen_path</ref>(</highlight><highlight class="stringliteral">&quot;/bfield/B_2DS_XXXXXXXXXX&quot;</highlight><highlight class="normal">,<sp/>qid,<sp/>path);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!<ref refid="hdf5__helpers_8c_1a3b6edfba63099574025bea60453da24b" kindref="member">hdf5_find_group</ref>(f,<sp/>path)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__field__offload__data_1aa831a5fdf440b4490c9cf774be57349b" kindref="member">type</ref><sp/>=<sp/><ref refid="B__field_8h_1a807b3aa80967ae6c94bd38f23e391ea6a08a6eeec9f59141cfc01878c7776b84a" kindref="member">B_field_type_2DS</ref>;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="hdf5__bfield_8c_1a7b86d9ae8a159cb57538e939e51bcce8" kindref="member">hdf5_bfield_read_2DS</ref>(f,<sp/>&amp;(offload_data-&gt;<ref refid="structB__field__offload__data_1a1a15b385dc6c20318facbd027585c439" kindref="member">B2DS</ref>),</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_array,<sp/>qid);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hdf5__helpers_8c_1ab43ae79d4f8e8d83bf098da8a0054a72" kindref="member">hdf5_gen_path</ref>(</highlight><highlight class="stringliteral">&quot;/bfield/B_3DS_XXXXXXXXXX&quot;</highlight><highlight class="normal">,<sp/>qid,<sp/>path);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!<ref refid="hdf5__helpers_8c_1a3b6edfba63099574025bea60453da24b" kindref="member">hdf5_find_group</ref>(f,<sp/>path)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__field__offload__data_1aa831a5fdf440b4490c9cf774be57349b" kindref="member">type</ref><sp/>=<sp/><ref refid="B__field_8h_1a807b3aa80967ae6c94bd38f23e391ea6acddc6f4338f89f1aa608b08ca1d03af9" kindref="member">B_field_type_3DS</ref>;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="hdf5__bfield_8c_1ac6ac4ccb41e491f4a3206a9c94c5494a" kindref="member">hdf5_bfield_read_3DS</ref>(f,<sp/>&amp;(offload_data-&gt;<ref refid="structB__field__offload__data_1aec0175d0425f36b2eb727cc7e05e95a1" kindref="member">B3DS</ref>),</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_array,<sp/>qid);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="hdf5__helpers_8c_1ab43ae79d4f8e8d83bf098da8a0054a72" kindref="member">hdf5_gen_path</ref>(</highlight><highlight class="stringliteral">&quot;/bfield/B_STS_XXXXXXXXXX&quot;</highlight><highlight class="normal">,<sp/>qid,<sp/>path);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>!<ref refid="hdf5__helpers_8c_1a3b6edfba63099574025bea60453da24b" kindref="member">hdf5_find_group</ref>(f,<sp/>path)<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__field__offload__data_1aa831a5fdf440b4490c9cf774be57349b" kindref="member">type</ref><sp/>=<sp/><ref refid="B__field_8h_1a807b3aa80967ae6c94bd38f23e391ea6ad8b42ea6016c92f4767615d7fb9027f8" kindref="member">B_field_type_STS</ref>;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="hdf5__bfield_8c_1a3e6ba4c926f9e8438b659226da276515" kindref="member">hdf5_bfield_read_STS</ref>(f,<sp/>&amp;(offload_data-&gt;<ref refid="structB__field__offload__data_1ae3a36c2bf7060d370638c216f4ffce79" kindref="member">BSTS</ref>),</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offload_array,<sp/>qid);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>if<sp/>data<sp/>was<sp/>read<sp/>succesfully<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!err)<sp/>{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err<sp/>=<sp/><ref refid="B__field_8c_1a2d598ab320e3063286cdbde51a265d74" kindref="member">B_field_init_offload</ref>(offload_data,<sp/>offload_array);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>err;</highlight></codeline>
<codeline lineno="118"><highlight class="normal">}</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="157" refid="hdf5__bfield_8c_1a7b86d9ae8a159cb57538e939e51bcce8" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1a7b86d9ae8a159cb57538e939e51bcce8" kindref="member">hdf5_bfield_read_2DS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__2DS__offload__data" kindref="compound">B_2DS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid)<sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#undef<sp/>BPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#define<sp/>BPATH<sp/>&quot;/bfield/B_2DS_XXXXXXXXXX/&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>and<sp/>initialize<sp/>psi<sp/>and<sp/>magnetic<sp/>field<sp/>Rz-grid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;nr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1addf5df6f915db09eb31d29799ccd5639" kindref="member">n_r</ref>),</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;nz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1ab86d47e5b73a92ff3fe159d74e523689" kindref="member">n_z</ref>),</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;rmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1a418602c29d6c0df4ac66734b816d2c0b" kindref="member">r_min</ref>),</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;rmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1ababc441c792513809c9ed1d0ca968c98" kindref="member">r_max</ref>),</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;zmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1afdd9302b0382e9eeb4170f8552321e6b" kindref="member">z_min</ref>),</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;zmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1a8c732a018fd42ea8cb26a60ca7c52cd9" kindref="member">z_max</ref>),</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Allocate<sp/>offload_array;<sp/>psi<sp/>and<sp/>each<sp/>component<sp/>(B_R,<sp/>B_phi,<sp/>B_z)<sp/>has</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>size<sp/>=<sp/>n_r*n_z<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>B_size<sp/>=<sp/>offload_data-&gt;<ref refid="structB__2DS__offload__data_1addf5df6f915db09eb31d29799ccd5639" kindref="member">n_r</ref><sp/>*<sp/>offload_data-&gt;<ref refid="structB__2DS__offload__data_1ab86d47e5b73a92ff3fe159d74e523689" kindref="member">n_z</ref>;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>*offload_array<sp/>=<sp/>(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*)<sp/>malloc(4<sp/>*<sp/>B_size<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>));</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>psi<sp/>and<sp/>B<sp/>values<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[0*B_size],</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;br&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[1*B_size],</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bphi&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[2*B_size],</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bz&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[3*B_size],</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>poloidal<sp/>flux<sp/>(psi)<sp/>values<sp/>at<sp/>magnetic<sp/>axis<sp/>and<sp/>separatrix.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1a4c0ddcb58db1e81e0fcc5650816518ac" kindref="member">psi0</ref>),</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi1&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1a7070c387117e51ecc62706bdb6578cd5" kindref="member">psi1</ref>),</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>magnetic<sp/>axis<sp/>R<sp/>and<sp/>z<sp/>coordinates<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1a3d51a05eb8ae586fe8e91e6022fab5f3" kindref="member">axis_r</ref>),</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__2DS__offload__data_1a2ceea2ea7c4ff422e4ff1f90c7ba71ff" kindref="member">axis_z</ref>),</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="204"><highlight class="normal">}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="256" refid="hdf5__bfield_8c_1ac6ac4ccb41e491f4a3206a9c94c5494a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1ac6ac4ccb41e491f4a3206a9c94c5494a" kindref="member">hdf5_bfield_read_3DS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__3DS__offload__data" kindref="compound">B_3DS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid)<sp/>{</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#undef<sp/>BPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#define<sp/>BPATH<sp/>&quot;/bfield/B_3DS_XXXXXXXXXX/&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>and<sp/>initialize<sp/>magnetic<sp/>field<sp/>Rpz-grid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_nr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a7221bb13b53e0704b09aff530ed6214d" kindref="member">Bgrid_n_r</ref>),</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_nz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a2f1d88d1745ef760c72ef907a376c352" kindref="member">Bgrid_n_z</ref>),</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_rmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a86ed72e299473faf91c138bc9262324f" kindref="member">Bgrid_r_min</ref>),</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_rmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1aa8e8dacc7d55048c87433e7ea1ef4073" kindref="member">Bgrid_r_max</ref>),</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_zmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1ab3100a16dab8de64fc8078075c4e2571" kindref="member">Bgrid_z_min</ref>),</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_zmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a613f62d018631cf479b7ab31b3527f0c" kindref="member">Bgrid_z_max</ref>),</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_nphi&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a579934ea88adc26e9f8ec16214e685ce" kindref="member">Bgrid_n_phi</ref>),</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_phimin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1aefff798a6433b96da0838f130fb72cb0" kindref="member">Bgrid_phi_min</ref>),</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_phimax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a42bd79f3bae9c1d061fd21ed24c270e9" kindref="member">Bgrid_phi_max</ref>),</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Convert<sp/>to<sp/>radians</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__3DS__offload__data_1aefff798a6433b96da0838f130fb72cb0" kindref="member">Bgrid_phi_min</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__3DS__offload__data_1aefff798a6433b96da0838f130fb72cb0" kindref="member">Bgrid_phi_min</ref>);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__3DS__offload__data_1a42bd79f3bae9c1d061fd21ed24c270e9" kindref="member">Bgrid_phi_max</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a42bd79f3bae9c1d061fd21ed24c270e9" kindref="member">Bgrid_phi_max</ref>);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>and<sp/>initialize<sp/>psi<sp/>field<sp/>Rz-grid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_nr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a52924c36b2eb72bf2fea878fda6c1471" kindref="member">psigrid_n_r</ref>),</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_nz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a6da05c9c4fe649db42560ec86f5f2aaa" kindref="member">psigrid_n_z</ref>),</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_rmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a5e446270df4d1d1918a443d44c1fce9b" kindref="member">psigrid_r_min</ref>),</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_rmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1acaf6cd4d5ba8c4f648121d67d5243128" kindref="member">psigrid_r_max</ref>),</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_zmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a71086d99b721e688271fdc57ad10b8f4" kindref="member">psigrid_z_min</ref>),</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_zmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a17545c6051bd39c379b550f0a9829607" kindref="member">psigrid_z_max</ref>),</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Allocate<sp/>offload_array<sp/>storing<sp/>psi<sp/>and<sp/>the<sp/>three<sp/>components<sp/>of<sp/>B<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>psi_size<sp/>=<sp/>offload_data-&gt;<ref refid="structB__3DS__offload__data_1a52924c36b2eb72bf2fea878fda6c1471" kindref="member">psigrid_n_r</ref>*offload_data-&gt;<ref refid="structB__3DS__offload__data_1a6da05c9c4fe649db42560ec86f5f2aaa" kindref="member">psigrid_n_z</ref>;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>B_size<sp/>=<sp/>offload_data-&gt;<ref refid="structB__3DS__offload__data_1a7221bb13b53e0704b09aff530ed6214d" kindref="member">Bgrid_n_r</ref><sp/>*<sp/>offload_data-&gt;<ref refid="structB__3DS__offload__data_1a2f1d88d1745ef760c72ef907a376c352" kindref="member">Bgrid_n_z</ref></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>offload_data-&gt;<ref refid="structB__3DS__offload__data_1a579934ea88adc26e9f8ec16214e685ce" kindref="member">Bgrid_n_phi</ref>;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/>*offload_array<sp/>=<sp/>(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*)<sp/>malloc((psi_size<sp/>+<sp/>3<sp/>*<sp/>B_size)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>));</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__3DS__offload__data_1a9f7f356647e41fc8c937631e86a66f9e" kindref="member">offload_array_length</ref><sp/>=<sp/>psi_size<sp/>+<sp/>3<sp/>*<sp/>B_size;</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>psi<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[3*B_size],</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>magnetic<sp/>field<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;br&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[0*B_size],</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bphi&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[1*B_size],</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bz&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[2*B_size],</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>poloidal<sp/>flux<sp/>(psi)<sp/>values<sp/>at<sp/>magnetic<sp/>axis<sp/>and<sp/>separatrix.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a6f2b7282d91343d5380b82d4e3cf9b13" kindref="member">psi0</ref>),</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi1&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a0381326178bf5c08ecbaa26b697112d2" kindref="member">psi1</ref>),</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>magnetic<sp/>axis<sp/>R<sp/>and<sp/>z<sp/>coordinates<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a2a41d03c167b38309a8e98b077680c72" kindref="member">axis_r</ref>),</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__3DS__offload__data_1a86d585002da29c9db0780b1abf8ad40c" kindref="member">axis_z</ref>),</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="333"><highlight class="normal">}</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="395" refid="hdf5__bfield_8c_1a3e6ba4c926f9e8438b659226da276515" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1a3e6ba4c926f9e8438b659226da276515" kindref="member">hdf5_bfield_read_STS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__STS__offload__data" kindref="compound">B_STS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid)<sp/>{</highlight></codeline>
<codeline lineno="397"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#undef<sp/>BPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#define<sp/>BPATH<sp/>&quot;/bfield/B_STS_XXXXXXXXXX/&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>and<sp/>initialize<sp/>magnetic<sp/>field<sp/>Rpz-grid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_nr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a8ff93d52cf96ba117825ecbf2702c7f9" kindref="member">Bgrid_n_r</ref>),</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_nz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a1c72a6f0d0da54683a76f034607213b0" kindref="member">Bgrid_n_z</ref>),</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_rmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a773fc93d73f4a80de4c921987ea7c748" kindref="member">Bgrid_r_min</ref>),</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_rmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a45039e3abde1bd111f38ba1ed79660eb" kindref="member">Bgrid_r_max</ref>),</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_zmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1ae99124dd78b232b2b62a05824fc8a6d5" kindref="member">Bgrid_z_min</ref>),</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_zmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1ac47c2705403f4ccb098e22771f7d5af2" kindref="member">Bgrid_z_max</ref>),</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_nphi&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1abf966e39cc3a4c5717164d0398a2acd5" kindref="member">Bgrid_n_phi</ref>),</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_phimin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a698c44e0e05bdf9138709d529eeeb1fa" kindref="member">Bgrid_phi_min</ref>),</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;b_phimax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a4f71d7f076713ea9e1b54bc4efcd3bd7" kindref="member">Bgrid_phi_max</ref>),</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Convert<sp/>to<sp/>radians</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a698c44e0e05bdf9138709d529eeeb1fa" kindref="member">Bgrid_phi_min</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__STS__offload__data_1a698c44e0e05bdf9138709d529eeeb1fa" kindref="member">Bgrid_phi_min</ref>);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a4f71d7f076713ea9e1b54bc4efcd3bd7" kindref="member">Bgrid_phi_max</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__STS__offload__data_1a4f71d7f076713ea9e1b54bc4efcd3bd7" kindref="member">Bgrid_phi_max</ref>);</highlight></codeline>
<codeline lineno="424"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>and<sp/>initialize<sp/>psi<sp/>field<sp/>Rpz-grid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_nr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a50e04b8ab11a89e5a4f29ecaf1ea1573" kindref="member">psigrid_n_r</ref>),</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_nz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a5ffe499c0fd9b6009dfdf813166d4aa4" kindref="member">psigrid_n_z</ref>),</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_rmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1ab31e20167ed1d672044bbe108ea5f602" kindref="member">psigrid_r_min</ref>),</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_rmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a3a480cf9f7d4007df7e106ea7df88d1e" kindref="member">psigrid_r_max</ref>),</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_zmin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a8e3596f9a94ff07261a6929bb1d296b2" kindref="member">psigrid_z_min</ref>),</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_zmax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1ad46dd1514071eed06c863e19a7a631da" kindref="member">psigrid_z_max</ref>),</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_nphi&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a22606a1229a7fc6743c9f68014969423" kindref="member">psigrid_n_phi</ref>),</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_phimin&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a6da4d2f926c99b4cfbb05b08722f97ed" kindref="member">psigrid_phi_min</ref>),</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi_phimax&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1ac3c56acd276943e051f4af215cdad964" kindref="member">psigrid_phi_max</ref>),</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Convert<sp/>to<sp/>radians</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a6da4d2f926c99b4cfbb05b08722f97ed" kindref="member">psigrid_phi_min</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__STS__offload__data_1a6da4d2f926c99b4cfbb05b08722f97ed" kindref="member">psigrid_phi_min</ref>);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1ac3c56acd276943e051f4af215cdad964" kindref="member">psigrid_phi_max</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__STS__offload__data_1ac3c56acd276943e051f4af215cdad964" kindref="member">psigrid_phi_max</ref>);</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>and<sp/>initialize<sp/>magnetic<sp/>axis<sp/>phi-grid<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axis_nphi&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a7a86a77e6cf336cd0a3fb073a31757f4" kindref="member">n_axis</ref>),</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axis_phimin&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1aefb9cd0a4aeea861c5d998095738fe88" kindref="member">axis_min</ref>),</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axis_phimax&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a9fe8a3ee79e5c310ae79f639c1abb0bd" kindref="member">axis_max</ref>),</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Convert<sp/>to<sp/>radians</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1aefb9cd0a4aeea861c5d998095738fe88" kindref="member">axis_min</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__STS__offload__data_1aefb9cd0a4aeea861c5d998095738fe88" kindref="member">axis_min</ref>);</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a9fe8a3ee79e5c310ae79f639c1abb0bd" kindref="member">axis_max</ref><sp/>=<sp/><ref refid="math_8h_1aa53741808556b85db16d3816d7f47f63" kindref="member">math_deg2rad</ref>(offload_data-&gt;<ref refid="structB__STS__offload__data_1a9fe8a3ee79e5c310ae79f639c1abb0bd" kindref="member">axis_max</ref>);</highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Allocate<sp/>offload_array<sp/>storing<sp/>psi<sp/>and<sp/>the<sp/>three<sp/>components<sp/>of<sp/>B<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>psi_size<sp/>=<sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a50e04b8ab11a89e5a4f29ecaf1ea1573" kindref="member">psigrid_n_r</ref>*offload_data-&gt;<ref refid="structB__STS__offload__data_1a5ffe499c0fd9b6009dfdf813166d4aa4" kindref="member">psigrid_n_z</ref></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a22606a1229a7fc6743c9f68014969423" kindref="member">psigrid_n_phi</ref>;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>B_size<sp/>=<sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a8ff93d52cf96ba117825ecbf2702c7f9" kindref="member">Bgrid_n_r</ref><sp/>*<sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a1c72a6f0d0da54683a76f034607213b0" kindref="member">Bgrid_n_z</ref></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1abf966e39cc3a4c5717164d0398a2acd5" kindref="member">Bgrid_n_phi</ref>;</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>axis_size<sp/>=<sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a7a86a77e6cf336cd0a3fb073a31757f4" kindref="member">n_axis</ref>;</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>*offload_array<sp/>=<sp/>(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>*)<sp/>malloc((psi_size<sp/>+<sp/>3<sp/>*<sp/>B_size<sp/>+<sp/>2<sp/>*<sp/>axis_size)</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>));</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/>offload_data-&gt;<ref refid="structB__STS__offload__data_1a4a5bc280010988ef4ca24a57a44c46f2" kindref="member">offload_array_length</ref><sp/>=<sp/>psi_size<sp/>+<sp/>3<sp/>*<sp/>B_size<sp/>+<sp/>2<sp/>*<sp/>axis_size;</highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>magnetic<sp/>field<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;br&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[0*B_size],</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bphi&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[1*B_size],</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bz&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[2*B_size],</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>psi<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi&quot;</highlight><highlight class="normal">,<sp/>&amp;(*offload_array)[3*B_size],</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>magnetic<sp/>axis<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisr&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(*offload_array)[3*B_size<sp/>+<sp/>psi_size],</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisz&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(*offload_array)[3*B_size<sp/>+<sp/>psi_size<sp/>+<sp/>axis_size],</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>the<sp/>poloidal<sp/>flux<sp/>(psi)<sp/>values<sp/>at<sp/>magnetic<sp/>axis<sp/>and<sp/>separatrix.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a2dd7a225b953960a33d7855daf408f02" kindref="member">psi0</ref>),</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi1&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__STS__offload__data_1a0810bad345e1bf552973c8e16419ae4a" kindref="member">psi1</ref>),</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="502"><highlight class="normal">}</highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="533" refid="hdf5__bfield_8c_1adba26489f9245e7937677d0a37676de0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1adba26489f9245e7937677d0a37676de0" kindref="member">hdf5_bfield_read_TC</ref>(hid_t<sp/>f,<sp/><ref refid="structB__TC__offload__data" kindref="compound">B_TC_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid)<sp/>{</highlight></codeline>
<codeline lineno="535"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#undef<sp/>BPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#define<sp/>BPATH<sp/>&quot;/bfield/B_TC_XXXXXXXXXX/&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisr&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__TC__offload__data_1a3c5c9214ff685242ad7e5f6ac5a90cbc" kindref="member">axisr</ref>),</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;axisz&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__TC__offload__data_1a373d86deca49c03c1200bad954071508" kindref="member">axisz</ref>),</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psival&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__TC__offload__data_1a2e24748553363e0190c347d547f628cd" kindref="member">psival</ref>),</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;rhoval&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__TC__offload__data_1a89dc3a4999d2ca297a0a05bccbaa2b4d" kindref="member">rhoval</ref>),</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bxyz&quot;</highlight><highlight class="normal">,<sp/>offload_data-&gt;<ref refid="structB__TC__offload__data_1ae8e82830551871da860181a8a7b291c0" kindref="member">B</ref>,</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;jacobian&quot;</highlight><highlight class="normal">,<sp/>offload_data-&gt;<ref refid="structB__TC__offload__data_1a9f54f6374d1553cf7c0286fefb02c983" kindref="member">dB</ref>,</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/>*offload_array<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="553"><highlight class="normal">}</highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight></codeline>
<codeline lineno="584" refid="hdf5__bfield_8c_1ad7721125ba1c0c592243e170ca83aff2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="hdf5__bfield_8c_1ad7721125ba1c0c592243e170ca83aff2" kindref="member">hdf5_bfield_read_GS</ref>(hid_t<sp/>f,<sp/><ref refid="structB__GS__offload__data" kindref="compound">B_GS_offload_data</ref>*<sp/>offload_data,</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ascot5_8h_1a11d147c64891830c9e79b3315b1b2e21" kindref="member">real</ref>**<sp/>offload_array,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>qid)<sp/>{</highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#undef<sp/>BPATH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#define<sp/>BPATH<sp/>&quot;/bfield/B_GS_XXXXXXXXXX/&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Equilibrium<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;r0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a041ad89f5def8ecb46d162b6b9e73979" kindref="member">R0</ref>),</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;z0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1ace4414d263db7616dd2522e8f77daf99" kindref="member">z0</ref>),</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;raxis&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a560f02509917897a23a2c7454ff98e39" kindref="member">raxis</ref>),</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;zaxis&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a14257fe4a3ec14f19c04137eff848d2c" kindref="member">zaxis</ref>),</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;bphi0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a9cfbc39ec3c2f2aea55d65a8bb4803f4" kindref="member">B_phi0</ref>),</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a873fe0b5c43721cef4a38f3f7ca61cb6" kindref="member">psi0</ref>),</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psi1&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1ab2a068ad8597909dcc5333a45cf0956b" kindref="member">psi1</ref>),</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;psimult&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1ab3812dfa194334368866f57eb1e342d1" kindref="member">psi_mult</ref>),</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;coefficients&quot;</highlight><highlight class="normal">,<sp/>offload_data-&gt;<ref refid="structB__GS__offload__data_1a9e84645df1f0da69aabda41aeb74bbd1" kindref="member">psi_coeff</ref>,</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ripple<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;delta0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a9e3a2ed81351660f78e3c4cc7fd05cd5" kindref="member">delta0</ref>),</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;alpha0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1af7e6b14c9e1cf474efdcb0ba7920b3e8" kindref="member">alpha0</ref>),</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1a43b9438fc244982ddff7dc58ea3b9ef9" kindref="member">hdf5_read_double</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;a0&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a65347b8e34dc804eb2fe2bf3b2dadbc3" kindref="member">a0</ref>),</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/><ref refid="hdf5__helpers_8c_1ae78f9ef2bb986e45d4cca2861d97e1fd" kindref="member">hdf5_read_int</ref>(<ref refid="hdf5__bfield_8c_1a43f0b831d9e466147d5966394a6d80c9" kindref="member">BPATH</ref><sp/></highlight><highlight class="stringliteral">&quot;nripple&quot;</highlight><highlight class="normal">,<sp/>&amp;(offload_data-&gt;<ref refid="structB__GS__offload__data_1a746cc31f79ba83dcb954c5692805cb7e" kindref="member">Nripple</ref>),</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>qid,<sp/>__FILE__,<sp/>__LINE__)<sp/>)<sp/>{</highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;}</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/>*offload_array<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="622"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="hdf5io/hdf5_bfield.c"/>
  </compounddef>
</doxygen>
