<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: math.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">math.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Mathematical utility functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">ascot5.h</a>&quot;</code><br />
</div>
<p><a href="math_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a78c99ffd76a7bb3c8c74db76207e9ab4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a78c99ffd76a7bb3c8c74db76207e9ab4">_XOPEN_SOURCE</a>&#160;&#160;&#160;500</td></tr>
<tr class="separator:a78c99ffd76a7bb3c8c74db76207e9ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a76b409bcf0a02133fc933a0bf797329d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a76b409bcf0a02133fc933a0bf797329d">rcomp</a> (const void *a, const void *b)</td></tr>
<tr class="memdesc:a76b409bcf0a02133fc933a0bf797329d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper comparison routine for "math_rsearch".  <a href="math_8c.html#a76b409bcf0a02133fc933a0bf797329d">More...</a><br /></td></tr>
<tr class="separator:a76b409bcf0a02133fc933a0bf797329d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7901810c3de9f46d356558efbaccebd"><td class="memItemLeft" align="right" valign="top"><a id="ac7901810c3de9f46d356558efbaccebd"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#ac7901810c3de9f46d356558efbaccebd">math_simpson_helper</a> (double(*f)(double), double a, double b, double eps, double S, double fa, double fb, double fc, int bottom)</td></tr>
<tr class="memdesc:ac7901810c3de9f46d356558efbaccebd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper routine for "math_simpson". <br /></td></tr>
<tr class="separator:ac7901810c3de9f46d356558efbaccebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe38b43cda283fdf4db89eafe9515746"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#afe38b43cda283fdf4db89eafe9515746">math_jac_rpz2xyz</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *rpz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *xyz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi)</td></tr>
<tr class="memdesc:afe38b43cda283fdf4db89eafe9515746"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a Jacobian from cylindrical to cartesian coordinates.  <a href="math_8c.html#afe38b43cda283fdf4db89eafe9515746">More...</a><br /></td></tr>
<tr class="separator:afe38b43cda283fdf4db89eafe9515746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed7ada7822595d869435af64095f5330"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#aed7ada7822595d869435af64095f5330">math_jac_xyz2rpz</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *xyz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *rpz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi)</td></tr>
<tr class="memdesc:aed7ada7822595d869435af64095f5330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a Jacobian from cartesian to cylindrical coordinates.  <a href="math_8c.html#aed7ada7822595d869435af64095f5330">More...</a><br /></td></tr>
<tr class="separator:aed7ada7822595d869435af64095f5330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42e276b970620bc71c2d4833079b4ddc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a42e276b970620bc71c2d4833079b4ddc">math_matmul</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *matA, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *matB, int d1, int d2, int d3, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *matC)</td></tr>
<tr class="memdesc:a42e276b970620bc71c2d4833079b4ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix multiplication.  <a href="math_8c.html#a42e276b970620bc71c2d4833079b4ddc">More...</a><br /></td></tr>
<tr class="separator:a42e276b970620bc71c2d4833079b4ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31c732694ca2533a1f00e2663d14bb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#af31c732694ca2533a1f00e2663d14bb5">math_normal_rand</a> (void)</td></tr>
<tr class="memdesc:af31c732694ca2533a1f00e2663d14bb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate normally distributed random numbers.  <a href="math_8c.html#af31c732694ca2533a1f00e2663d14bb5">More...</a><br /></td></tr>
<tr class="separator:af31c732694ca2533a1f00e2663d14bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268aacd23c5013cad8ccaa9692aa3631"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a268aacd23c5013cad8ccaa9692aa3631">math_ipow</a> (int a, int p)</td></tr>
<tr class="memdesc:a268aacd23c5013cad8ccaa9692aa3631"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a^p where both a and p are integers (p &gt;= 0)  <a href="math_8c.html#a268aacd23c5013cad8ccaa9692aa3631">More...</a><br /></td></tr>
<tr class="separator:a268aacd23c5013cad8ccaa9692aa3631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13a44d019b29f5281851b5574ad1c247"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a13a44d019b29f5281851b5574ad1c247">math_simpson</a> (double(*f)(double), double a, double b, double eps)</td></tr>
<tr class="memdesc:a13a44d019b29f5281851b5574ad1c247"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adaptive Simpsons rule for integral.  <a href="math_8c.html#a13a44d019b29f5281851b5574ad1c247">More...</a><br /></td></tr>
<tr class="separator:a13a44d019b29f5281851b5574ad1c247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbaa1d87b5cc438fbd03b48912b3fee1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#acbaa1d87b5cc438fbd03b48912b3fee1">math_linspace</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *vec, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> a, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> b, int n)</td></tr>
<tr class="memdesc:acbaa1d87b5cc438fbd03b48912b3fee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate linearly spaced vector.  <a href="math_8c.html#acbaa1d87b5cc438fbd03b48912b3fee1">More...</a><br /></td></tr>
<tr class="separator:acbaa1d87b5cc438fbd03b48912b3fee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0891e188229459cadca6a189675d9af6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a0891e188229459cadca6a189675d9af6">math_uniquecount</a> (int *in, int *unique, int *count, int n)</td></tr>
<tr class="memdesc:a0891e188229459cadca6a189675d9af6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find unique numbers and their frequency in given array.  <a href="math_8c.html#a0891e188229459cadca6a189675d9af6">More...</a><br /></td></tr>
<tr class="separator:a0891e188229459cadca6a189675d9af6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad058764586ae6b1953b866bf156fa521"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#ad058764586ae6b1953b866bf156fa521">math_point_on_plane</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> q[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t1[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t2[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t3[3])</td></tr>
<tr class="memdesc:ad058764586ae6b1953b866bf156fa521"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find if a point is on a given plane.  <a href="math_8c.html#ad058764586ae6b1953b866bf156fa521">More...</a><br /></td></tr>
<tr class="separator:ad058764586ae6b1953b866bf156fa521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8556627d200439ee8b6da2c5dc1a1af2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a8556627d200439ee8b6da2c5dc1a1af2">math_barycentric_coords_triangle</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> AP[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> AB[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> AC[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> n[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *s, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *t)</td></tr>
<tr class="memdesc:a8556627d200439ee8b6da2c5dc1a1af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find barycentric coordinates for a given point.  <a href="math_8c.html#a8556627d200439ee8b6da2c5dc1a1af2">More...</a><br /></td></tr>
<tr class="separator:a8556627d200439ee8b6da2c5dc1a1af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2fe8b5e5783b76fd11470a5c4db27bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#ad2fe8b5e5783b76fd11470a5c4db27bd">math_rsearch</a> (const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> key, const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *base, int num)</td></tr>
<tr class="memdesc:ad2fe8b5e5783b76fd11470a5c4db27bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search for array element preceding a key value.  <a href="math_8c.html#ad2fe8b5e5783b76fd11470a5c4db27bd">More...</a><br /></td></tr>
<tr class="separator:ad2fe8b5e5783b76fd11470a5c4db27bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f5d2f375008cc840b427e332b15588c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8c.html#a2f5d2f375008cc840b427e332b15588c">math_point_in_polygon</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *rv, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *zv, int n)</td></tr>
<tr class="memdesc:a2f5d2f375008cc840b427e332b15588c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if coordinates are within polygon.  <a href="math_8c.html#a2f5d2f375008cc840b427e332b15588c">More...</a><br /></td></tr>
<tr class="separator:a2f5d2f375008cc840b427e332b15588c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Mathematical utility functions. </p>

<p class="definition">Definition in file <a class="el" href="math_8c_source.html">math.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a78c99ffd76a7bb3c8c74db76207e9ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c99ffd76a7bb3c8c74db76207e9ab4">&#9670;&nbsp;</a></span>_XOPEN_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _XOPEN_SOURCE&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>drand48 requires POSIX 1995 standard </p>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00005">5</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a76b409bcf0a02133fc933a0bf797329d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76b409bcf0a02133fc933a0bf797329d">&#9670;&nbsp;</a></span>rcomp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rcomp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper comparison routine for "math_rsearch". </p>
<p>This function checks if a key value is between two consecutive values in a real array. The array to be searched has to be in ascending sorted order.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>first comparison value (key) </td></tr>
    <tr><td class="paramname">b</td><td>first value in array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if key is between the consecutive values, 1 if key is greater than the first value, and -1 if key is smaller than the first value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00373">373</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="afe38b43cda283fdf4db89eafe9515746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe38b43cda283fdf4db89eafe9515746">&#9670;&nbsp;</a></span>math_jac_rpz2xyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_jac_rpz2xyz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>rpz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>xyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a Jacobian from cylindrical to cartesian coordinates. </p>
<p>This function converts a Jacobian located at angle phi and radius r from cylindrical to cartesian coordinates. The input Jacobian is an array with</p>
<p>[Br dBr/dr dBr/dphi dBr/dz Bphi dBphi/dr dBphi/dphi dBphi/dz Bz dBz/dr dBz/dphi dBz/dz]</p>
<p>an the output is</p>
<p>[Bx dBx/dx dBx/dy dBx/dz By dBy/dx dBy/dy dBy/dz Bz dBz/dx dBz/dy dBz/dz].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rpz</td><td>input rpz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">xyz</td><td>output xyz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">r</td><td>r coordinate of the gradient </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate of the gradient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00036">36</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="aed7ada7822595d869435af64095f5330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed7ada7822595d869435af64095f5330">&#9670;&nbsp;</a></span>math_jac_xyz2rpz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_jac_xyz2rpz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>xyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>rpz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a Jacobian from cartesian to cylindrical coordinates. </p>
<p>This function converts a Jacobian located at angle phi and radius r from cartesian to cylindrical coordinates. The input Jacobian is an array with</p>
<p>[Bx dBx/dx dBx/dy dBx/dz By dBy/dx dBy/dy dBy/dz Bz dBz/dx dBz/dy dBz/dz]</p>
<p>an the output is</p>
<p>[Br dBr/dr dBr/dphi dBr/dz Bphi dBphi/dr dBphi/dphi dBphi/dz Bz dBz/dr dBz/dphi dBz/dz].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xyz</td><td>output xyz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">rpz</td><td>input rpz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">r</td><td>r coordinate of the gradient </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate of the gradient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00095">95</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a42e276b970620bc71c2d4833079b4ddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42e276b970620bc71c2d4833079b4ddc">&#9670;&nbsp;</a></span>math_matmul()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_matmul </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>matA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>matB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>matC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matrix multiplication. </p>
<p>This function performs matrix multiplication. The matrices are given as arrays, the indexing being row-wise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matA</td><td>input array representing a d1 x d2 matrix </td></tr>
    <tr><td class="paramname">matB</td><td>input array representing a d2 x d3 matrix </td></tr>
    <tr><td class="paramname">d1</td><td>input scalar dimension (columns in matA and matC) </td></tr>
    <tr><td class="paramname">d2</td><td>input scalar dimension (rows in matA and columns in matB) </td></tr>
    <tr><td class="paramname">d3</td><td>input scalar dimension (rows in matB and matC) </td></tr>
    <tr><td class="paramname">matC</td><td>output array representing a d1 x d3 matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00151">151</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="af31c732694ca2533a1f00e2663d14bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31c732694ca2533a1f00e2663d14bb5">&#9670;&nbsp;</a></span>math_normal_rand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> math_normal_rand </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate normally distributed random numbers. </p>
<p>This function generates normally distributed random numbers with expected value of 0 and variance of 1 using the polar method [1]. The rand48 random number generator should be initialized with srand48() before calling this function.</p>
<p>[1] G. Marsaglia, T. A. Bray. A convenient method for generating normal variables. Siam Review 6.3 (1964): 260-264. <a href="http://epubs.siam.org/doi/abs/10.1137/1006063:w">http://epubs.siam.org/doi/abs/10.1137/1006063:w</a></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd><p class="startdd">Currently only one of the generated numbers is returned; a second independent variate is Y = v2 * sqrt(-2*log(s) / s) </p>
<p class="enddd">Try other random number generators such as those in Intel MKL </p>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00180">180</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a268aacd23c5013cad8ccaa9692aa3631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a268aacd23c5013cad8ccaa9692aa3631">&#9670;&nbsp;</a></span>math_ipow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int math_ipow </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a^p where both a and p are integers (p &gt;= 0) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>argument </td></tr>
    <tr><td class="paramname">p</td><td>power</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a^b </dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00202">202</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a13a44d019b29f5281851b5574ad1c247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13a44d019b29f5281851b5574ad1c247">&#9670;&nbsp;</a></span>math_simpson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double math_simpson </td>
          <td>(</td>
          <td class="paramtype">double(*)(double)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adaptive Simpsons rule for integral. </p>
<p>This function uses recursive splitting of the interval until either maximum number of intervals is reached or given relative error tolerance is obtained</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>pointer to the integrand function (of one variable) </td></tr>
    <tr><td class="paramname">a</td><td>lower limit for the interval </td></tr>
    <tr><td class="paramname">b</td><td>upper limit for the interval </td></tr>
    <tr><td class="paramname">eps</td><td>absolute tolerance</td></tr>
  </table>
  </dd>
</dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>Probably does not work with SIMD </dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00224">224</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="acbaa1d87b5cc438fbd03b48912b3fee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbaa1d87b5cc438fbd03b48912b3fee1">&#9670;&nbsp;</a></span>math_linspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_linspace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate linearly spaced vector. </p>
<p>Generates linearly space vector with n elements whose end points are a and b. If n = 1, return b.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vec</td><td>n length array where result is stored </td></tr>
    <tr><td class="paramname">a</td><td>start point </td></tr>
    <tr><td class="paramname">b</td><td>end point </td></tr>
    <tr><td class="paramname">n</td><td>number of elements </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00243">243</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a0891e188229459cadca6a189675d9af6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0891e188229459cadca6a189675d9af6">&#9670;&nbsp;</a></span>math_uniquecount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_uniquecount </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>unique</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find unique numbers and their frequency in given array. </p>
<p>All argument arrays are assumed to have the same length as the array holding the input numbers. If not all numbers are unique, the remaining entries in unique and count arguments are zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>input array of length n </td></tr>
    <tr><td class="paramname">unique</td><td>array where unique numbers are stored, must be of length n </td></tr>
    <tr><td class="paramname">count</td><td>count[i] is how many times unique[i] appears in array in, must be of length n </td></tr>
    <tr><td class="paramname">n</td><td>length of the argument arrays </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00268">268</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="ad058764586ae6b1953b866bf156fa521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad058764586ae6b1953b866bf156fa521">&#9670;&nbsp;</a></span>math_point_on_plane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int math_point_on_plane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>q</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t1</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t2</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t3</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find if a point is on a given plane. </p>
<p>Let t1=(x1, y1, z1), t2=(x2, y2, z2), and t3=(x3, y3, z3) be non-collinear points on the plane. Let q =(x, y, z) be an arbitrary point. It lies in the plane if:</p>
<p>det( |x -x1 y -y1 z -z1| |x2-x1 y2-y1 z2-z1| |x3-x1 y3-y1 z3-z1| ) == 0</p>
<p>det( |x -x1 y -y1 z -z1| |x -x2 y -y2 z -z2| |x -x3 y -y3 z -z3| ) == 0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>xyz coordinates of a query point </td></tr>
    <tr><td class="paramname">t1</td><td>xyz coordinates of the first point defining the plane </td></tr>
    <tr><td class="paramname">t2</td><td>xyz coordinates of the second point defining the plane </td></tr>
    <tr><td class="paramname">t3</td><td>xyz coordinates of the third point defining the plane </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00316">316</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a8556627d200439ee8b6da2c5dc1a1af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8556627d200439ee8b6da2c5dc1a1af2">&#9670;&nbsp;</a></span>math_barycentric_coords_triangle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_barycentric_coords_triangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>AP</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>AB</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>AC</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>n</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find barycentric coordinates for a given point. </p>
<p>Let a,b,c be the vertices of a triangle and p an arbitrary point. The s,t are the barycentric coordinates of p if: p = (1-s-t)*a + s*b + t*c</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AP</td><td>point position vector [x,y,z] </td></tr>
    <tr><td class="paramname">AB</td><td>triangle edge AB vector </td></tr>
    <tr><td class="paramname">AC</td><td>triangle edge AC vector </td></tr>
    <tr><td class="paramname">n</td><td>normal vector [nx, ny, nz] of the triangle </td></tr>
    <tr><td class="paramname">s</td><td>evaluated s coordinate </td></tr>
    <tr><td class="paramname">t</td><td>evaluated t coordinate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00352">352</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="ad2fe8b5e5783b76fd11470a5c4db27bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2fe8b5e5783b76fd11470a5c4db27bd">&#9670;&nbsp;</a></span>math_rsearch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* math_rsearch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search for array element preceding a key value. </p>
<p>This function takes an array of real values and a key value, and finds the array element which precedes the key value. The array to be searched has to be in ascending sorted order (according to comparison function rcomp).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>real value that serves as key for the search </td></tr>
    <tr><td class="paramname">base</td><td>pointer to the first object of the array to be searched </td></tr>
    <tr><td class="paramname">num</td><td>number of elements in array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to array element preceding the key, or NULL if search failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00397">397</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a2f5d2f375008cc840b427e332b15588c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f5d2f375008cc840b427e332b15588c">&#9670;&nbsp;</a></span>math_point_in_polygon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int math_point_in_polygon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>zv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if coordinates are within polygon. </p>
<p>This function checks if the given coordinates are within a 2D polygon using a modified axis crossing method [1]. Origin is moved to the coordinates and the number of wall segments crossing the positive r-axis are calculated. If this is odd, the point is inside the polygon.</p>
<p>[1] D.G. Alciatore, R. Miranda. A Winding Number and Point-in-Polygon Algorithm. Technical report, Colorado State University, 1995. <a href="http://www.engr.colostate.edu/~dga/dga/papers/point_in_polygon.pdf">http://www.engr.colostate.edu/~dga/dga/papers/point_in_polygon.pdf</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>r coordinate </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate </td></tr>
    <tr><td class="paramname">rv</td><td>array of r points for the polygon </td></tr>
    <tr><td class="paramname">zv</td><td>array of z points for the polygon </td></tr>
    <tr><td class="paramname">n</td><td>number of points in the polygon </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00419">419</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
