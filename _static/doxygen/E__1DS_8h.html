<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: Efield/E_1DS.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e505ee564c41fe1be3b44bfec7198b8e.html">Efield</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">E_1DS.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="E__1DS_8c.html" title="1D spline electric field evaluation functions">E_1DS.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ascot5_8h_source.html">../ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">../error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interp_8h_source.html">../spline/interp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__field_8h_source.html">../B_field.h</a>&quot;</code><br />
</div>
<p><a href="E__1DS_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structE__1DS__offload__data.html">E_1DS_offload_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">1D spline electric field parameters that will be offloaded to target  <a href="structE__1DS__offload__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structE__1DS__data.html">E_1DS_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">1D spline electric field parameters on the target  <a href="structE__1DS__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3b84340d278b34d33d86217fd989582d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="E__1DS_8h.html#a3b84340d278b34d33d86217fd989582d">E_1DS_init_offload</a> (<a class="el" href="structE__1DS__offload__data.html">E_1DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:a3b84340d278b34d33d86217fd989582d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize 1DS electric field data.  <a href="E__1DS_8h.html#a3b84340d278b34d33d86217fd989582d">More...</a><br /></td></tr>
<tr class="separator:a3b84340d278b34d33d86217fd989582d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190f4263c4099b270e759a0dc99c7703"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="E__1DS_8h.html#a190f4263c4099b270e759a0dc99c7703">E_1DS_free_offload</a> (<a class="el" href="structE__1DS__offload__data.html">E_1DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:a190f4263c4099b270e759a0dc99c7703"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free offload array and reset parameters.  <a href="E__1DS_8h.html#a190f4263c4099b270e759a0dc99c7703">More...</a><br /></td></tr>
<tr class="separator:a190f4263c4099b270e759a0dc99c7703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a82ca71be0581f8d04ad2cabe37b6c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="E__1DS_8h.html#a5a82ca71be0581f8d04ad2cabe37b6c4">E_1DS_init</a> (<a class="el" href="structE__1DS__data.html">E_1DS_data</a> *Edata, <a class="el" href="structE__1DS__offload__data.html">E_1DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *offload_array)</td></tr>
<tr class="memdesc:a5a82ca71be0581f8d04ad2cabe37b6c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize 1D spline electric field data struct on target.  <a href="E__1DS_8h.html#a5a82ca71be0581f8d04ad2cabe37b6c4">More...</a><br /></td></tr>
<tr class="separator:a5a82ca71be0581f8d04ad2cabe37b6c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9838c88e93feb929ee070ffca71c73f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="E__1DS_8h.html#a9838c88e93feb929ee070ffca71c73f2">E_1DS_eval_E</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> E[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="structE__1DS__data.html">E_1DS_data</a> *Edata, <a class="el" href="structB__field__data.html">B_field_data</a> *Bdata)</td></tr>
<tr class="memdesc:a9838c88e93feb929ee070ffca71c73f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate 1D spline radial electric field.  <a href="E__1DS_8h.html#a9838c88e93feb929ee070ffca71c73f2">More...</a><br /></td></tr>
<tr class="separator:a9838c88e93feb929ee070ffca71c73f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="E__1DS_8c.html" title="1D spline electric field evaluation functions">E_1DS.c</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Joona Kontula <a href="#" onclick="location.href='mai'+'lto:'+'joo'+'na'+'.ko'+'nt'+'ula'+'@a'+'alt'+'o.'+'fi'; return false;">joona<span style="display: none;">.nosp@m.</span>.kon<span style="display: none;">.nosp@m.</span>tula@<span style="display: none;">.nosp@m.</span>aalt<span style="display: none;">.nosp@m.</span>o.fi</a></dd></dl>
<p>Contains declaration of E_1DS_field_offload_data and E_1DS_field_data structs. </p>

<p class="definition">Definition in file <a class="el" href="E__1DS_8h_source.html">E_1DS.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3b84340d278b34d33d86217fd989582d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b84340d278b34d33d86217fd989582d">&#9670;&nbsp;</a></span>E_1DS_init_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int E_1DS_init_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structE__1DS__offload__data.html">E_1DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize 1DS electric field data. </p>
<p>This function takes pre-initialized offload data struct and offload array as inputs. The data is used to fill rest of the offload struct and to construct a cubic spline whose coefficients are stored in re-allocated offload array.</p>
<p>The offload data struct must have the following fields initialized:</p><ul>
<li><a class="el" href="structE__1DS__offload__data.html#a71c8e5975ccaeda19a117d65358d15e2">E_1DS_offload_data.n_rho</a></li>
<li><a class="el" href="structE__1DS__offload__data.html#a76c50d4b3f285d183e933064ae8e0287">E_1DS_offload_data.rho_min</a></li>
<li><a class="el" href="structE__1DS__offload__data.html#abef3a697ca9309dac474a20b86de9fca">E_1DS_offload_data.rho_max</a></li>
</ul>
<p><a class="el" href="structE__1DS__offload__data.html#a1ffca758fc95ef64d5c70c73219b78dc">E_1DS_offload_data.offload_array_length</a> is set here.</p>
<p>The offload array must contain the following data:</p><ul>
<li>offload_array[i] = dV_drho(rho_i) [V]</li>
</ul>
<p>Sanity checks are printed if data was initialized succesfully.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array which is reallocated here</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if initialization succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="E__1DS_8c_source.html#l00041">41</a> of file <a class="el" href="E__1DS_8c_source.html">E_1DS.c</a>.</p>

</div>
</div>
<a id="a190f4263c4099b270e759a0dc99c7703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a190f4263c4099b270e759a0dc99c7703">&#9670;&nbsp;</a></span>E_1DS_free_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void E_1DS_free_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structE__1DS__offload__data.html">E_1DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free offload array and reset parameters. </p>
<p>This function deallocates the offload_array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="E__1DS_8c_source.html#l00078">78</a> of file <a class="el" href="E__1DS_8c_source.html">E_1DS.c</a>.</p>

</div>
</div>
<a id="a5a82ca71be0581f8d04ad2cabe37b6c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a82ca71be0581f8d04ad2cabe37b6c4">&#9670;&nbsp;</a></span>E_1DS_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void E_1DS_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structE__1DS__data.html">E_1DS_data</a> *&#160;</td>
          <td class="paramname"><em>Edata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structE__1DS__offload__data.html">E_1DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize 1D spline electric field data struct on target. </p>
<p>This function copies the 1D spline electric field parameters from the offload struct to the struct on target and sets the 1D spline electric field data pointers to correct offsets in the offload array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Edata</td><td>pointer to data struct on target </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="E__1DS_8c_source.html#l00095">95</a> of file <a class="el" href="E__1DS_8c_source.html">E_1DS.c</a>.</p>

</div>
</div>
<a id="a9838c88e93feb929ee070ffca71c73f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9838c88e93feb929ee070ffca71c73f2">&#9670;&nbsp;</a></span>E_1DS_eval_E()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> E_1DS_eval_E </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>E</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structE__1DS__data.html">E_1DS_data</a> *&#160;</td>
          <td class="paramname"><em>Edata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__data.html">B_field_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate 1D spline radial electric field. </p>
<p>This function evaluates the 1D spline potential gradient of the plasma at the given radial coordinate using linear interpolation, and then calculates the radial electric field by multiplying that with the rho-gradient. Gradient of rho is obtained via magnetic field module.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">E</td><td>array where the electric field will be stored (E_r -&gt; E[1], E_phi -&gt; E[1], E_z -&gt; E[2]) </td></tr>
    <tr><td class="paramname">r</td><td>R-coordiante [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi-coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z-coordiante [m] </td></tr>
    <tr><td class="paramname">Edata</td><td>pointer to electric field data </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if evaluation succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="E__1DS_8c_source.html#l00122">122</a> of file <a class="el" href="E__1DS_8c_source.html">E_1DS.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
