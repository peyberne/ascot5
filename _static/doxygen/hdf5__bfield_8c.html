<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: hdf5io/hdf5_bfield.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_cfc51e1b4dafe14c0e7cca4efbd715eb.html">hdf5io</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hdf5_bfield.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module for reading magnetic field data from HDF5 file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br />
<code>#include &lt;hdf5.h&gt;</code><br />
<code>#include &lt;hdf5_hl.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">../ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="print_8h_source.html">../print.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="consts_8h_source.html">../consts.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__field_8h_source.html">../B_field.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__2DS_8h_source.html">../Bfield/B_2DS.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__3DS_8h_source.html">../Bfield/B_3DS.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__STS_8h_source.html">../Bfield/B_STS.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__TC_8h_source.html">../Bfield/B_TC.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__GS_8h_source.html">../Bfield/B_GS.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hdf5__helpers_8h_source.html">hdf5_helpers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hdf5__bfield_8h_source.html">hdf5_bfield.h</a>&quot;</code><br />
</div>
<p><a href="hdf5__bfield_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a43f0b831d9e466147d5966394a6d80c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a43f0b831d9e466147d5966394a6d80c9">BPATH</a></td></tr>
<tr class="separator:a43f0b831d9e466147d5966394a6d80c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f0b831d9e466147d5966394a6d80c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a43f0b831d9e466147d5966394a6d80c9">BPATH</a>&#160;&#160;&#160;&quot;/bfield/B_2DS_XXXXXXXXXX/&quot;</td></tr>
<tr class="separator:a43f0b831d9e466147d5966394a6d80c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f0b831d9e466147d5966394a6d80c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a43f0b831d9e466147d5966394a6d80c9">BPATH</a>&#160;&#160;&#160;&quot;/bfield/B_3DS_XXXXXXXXXX/&quot;</td></tr>
<tr class="separator:a43f0b831d9e466147d5966394a6d80c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f0b831d9e466147d5966394a6d80c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a43f0b831d9e466147d5966394a6d80c9">BPATH</a>&#160;&#160;&#160;&quot;/bfield/B_STS_XXXXXXXXXX/&quot;</td></tr>
<tr class="separator:a43f0b831d9e466147d5966394a6d80c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f0b831d9e466147d5966394a6d80c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a43f0b831d9e466147d5966394a6d80c9">BPATH</a>&#160;&#160;&#160;&quot;/bfield/B_TC_XXXXXXXXXX/&quot;</td></tr>
<tr class="separator:a43f0b831d9e466147d5966394a6d80c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f0b831d9e466147d5966394a6d80c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a43f0b831d9e466147d5966394a6d80c9">BPATH</a>&#160;&#160;&#160;&quot;/bfield/B_GS_XXXXXXXXXX/&quot;</td></tr>
<tr class="separator:a43f0b831d9e466147d5966394a6d80c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7b86d9ae8a159cb57538e939e51bcce8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a7b86d9ae8a159cb57538e939e51bcce8">hdf5_bfield_read_2DS</a> (hid_t f, <a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, char *qid)</td></tr>
<tr class="memdesc:a7b86d9ae8a159cb57538e939e51bcce8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read magnetic field data of type B_2DS.  <a href="hdf5__bfield_8c.html#a7b86d9ae8a159cb57538e939e51bcce8">More...</a><br /></td></tr>
<tr class="separator:a7b86d9ae8a159cb57538e939e51bcce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ac4ccb41e491f4a3206a9c94c5494a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#ac6ac4ccb41e491f4a3206a9c94c5494a">hdf5_bfield_read_3DS</a> (hid_t f, <a class="el" href="structB__3DS__offload__data.html">B_3DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, char *qid)</td></tr>
<tr class="memdesc:ac6ac4ccb41e491f4a3206a9c94c5494a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read magnetic field data of type B_3DS.  <a href="hdf5__bfield_8c.html#ac6ac4ccb41e491f4a3206a9c94c5494a">More...</a><br /></td></tr>
<tr class="separator:ac6ac4ccb41e491f4a3206a9c94c5494a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e6ba4c926f9e8438b659226da276515"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a3e6ba4c926f9e8438b659226da276515">hdf5_bfield_read_STS</a> (hid_t f, <a class="el" href="structB__STS__offload__data.html">B_STS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, char *qid)</td></tr>
<tr class="memdesc:a3e6ba4c926f9e8438b659226da276515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read magnetic field data of type B_STS.  <a href="hdf5__bfield_8c.html#a3e6ba4c926f9e8438b659226da276515">More...</a><br /></td></tr>
<tr class="separator:a3e6ba4c926f9e8438b659226da276515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba26489f9245e7937677d0a37676de0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#adba26489f9245e7937677d0a37676de0">hdf5_bfield_read_TC</a> (hid_t f, <a class="el" href="structB__TC__offload__data.html">B_TC_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, char *qid)</td></tr>
<tr class="memdesc:adba26489f9245e7937677d0a37676de0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read magnetic field data of type B_TC.  <a href="hdf5__bfield_8c.html#adba26489f9245e7937677d0a37676de0">More...</a><br /></td></tr>
<tr class="separator:adba26489f9245e7937677d0a37676de0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7721125ba1c0c592243e170ca83aff2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#ad7721125ba1c0c592243e170ca83aff2">hdf5_bfield_read_GS</a> (hid_t f, <a class="el" href="structB__GS__offload__data.html">B_GS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, char *qid)</td></tr>
<tr class="memdesc:ad7721125ba1c0c592243e170ca83aff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read magnetic field data of type B_GS.  <a href="hdf5__bfield_8c.html#ad7721125ba1c0c592243e170ca83aff2">More...</a><br /></td></tr>
<tr class="separator:ad7721125ba1c0c592243e170ca83aff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59dacef5bb8ee42211b378aac4747070"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hdf5__bfield_8c.html#a59dacef5bb8ee42211b378aac4747070">hdf5_bfield_init_offload</a> (hid_t f, <a class="el" href="structB__field__offload__data.html">B_field_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, char *qid)</td></tr>
<tr class="memdesc:a59dacef5bb8ee42211b378aac4747070"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize magnetic field offload data from HDF5 file.  <a href="hdf5__bfield_8c.html#a59dacef5bb8ee42211b378aac4747070">More...</a><br /></td></tr>
<tr class="separator:a59dacef5bb8ee42211b378aac4747070"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module for reading magnetic field data from HDF5 file. </p>
<p>This module contains routines to read magnetic field data from ASCOT5 HDF5 file. The reading is done by calling <a class="el" href="hdf5__bfield_8c.html#a59dacef5bb8ee42211b378aac4747070" title="Initialize magnetic field offload data from HDF5 file.">hdf5_bfield_init_offload()</a> which reads the data and uses that to initialize the offload data.</p>
<p>Note: the routines within this module that read the data from HDF5 file may use the offload data struct and offload arrays as (temporary) storage. However, the actual initialization is done at the specific <a class="el" href="B__field_8c.html#a2d598ab320e3063286cdbde51a265d74" title="Load magnetic field data and prepare parameters.">B_field_init_offload()</a> function the magnetic field data corresponds to. Check from that function what the offload data and the offload array are expected to contain. As a rule of thumb, the reading routines here should only read the data and maybe do some trivial computations but nothing complicated. </p>

<p class="definition">Definition in file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a43f0b831d9e466147d5966394a6d80c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f0b831d9e466147d5966394a6d80c9">&#9670;&nbsp;</a></span>BPATH <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BPATH</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro that is used to store paths to data groups </p>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00035">35</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="a43f0b831d9e466147d5966394a6d80c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f0b831d9e466147d5966394a6d80c9">&#9670;&nbsp;</a></span>BPATH <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BPATH&#160;&#160;&#160;&quot;/bfield/B_2DS_XXXXXXXXXX/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro that is used to store paths to data groups </p>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00035">35</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="a43f0b831d9e466147d5966394a6d80c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f0b831d9e466147d5966394a6d80c9">&#9670;&nbsp;</a></span>BPATH <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BPATH&#160;&#160;&#160;&quot;/bfield/B_3DS_XXXXXXXXXX/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro that is used to store paths to data groups </p>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00035">35</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="a43f0b831d9e466147d5966394a6d80c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f0b831d9e466147d5966394a6d80c9">&#9670;&nbsp;</a></span>BPATH <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BPATH&#160;&#160;&#160;&quot;/bfield/B_STS_XXXXXXXXXX/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro that is used to store paths to data groups </p>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00035">35</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="a43f0b831d9e466147d5966394a6d80c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f0b831d9e466147d5966394a6d80c9">&#9670;&nbsp;</a></span>BPATH <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BPATH&#160;&#160;&#160;&quot;/bfield/B_TC_XXXXXXXXXX/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro that is used to store paths to data groups </p>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00035">35</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="a43f0b831d9e466147d5966394a6d80c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f0b831d9e466147d5966394a6d80c9">&#9670;&nbsp;</a></span>BPATH <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BPATH&#160;&#160;&#160;&quot;/bfield/B_GS_XXXXXXXXXX/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro that is used to store paths to data groups </p>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00035">35</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7b86d9ae8a159cb57538e939e51bcce8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b86d9ae8a159cb57538e939e51bcce8">&#9670;&nbsp;</a></span>hdf5_bfield_read_2DS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hdf5_bfield_read_2DS </td>
          <td>(</td>
          <td class="paramtype">hid_t&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>qid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read magnetic field data of type B_2DS. </p>
<p>The B_2DS data is stored in HDF5 file under the group /bfield/B_2DS_XXXXXXXXXX/ where X's mark the QID.</p>
<p>This function assumes the group holds the following datasets:</p>
<ul>
<li>int nr Number of R grid points in the magnetic field grid</li>
<li>int nz Number of z grid points in the magnetic field grid</li>
<li>double rmin Minimum value in R grid [m]</li>
<li>double rmax Maximum value in R grid [m]</li>
<li>double zmin Minimum value in z grid [m]</li>
<li>double zmax Maximum value in z grid [m]</li>
<li>double axisr Magnetic axis R coordinate [m]</li>
<li>double axisz Magnetic axis z coordinate [m]</li>
<li>double psi0 Poloidal magnetic flux value on magnetic axis [V*s*m^-1]</li>
<li>double psi1 Poloidal magnetic flux value on separatrix [V*s*m^-1]</li>
<li>double psi Poloidal magnetic flux on the Rz-grid as a {nz, nR} matrix [V*s*m^-1]</li>
<li>double br Magnetic field R component on the Rz-grid as a {nz, nR} matrix [T]</li>
<li>double bphi Magnetic field R component on the Rz-grid as a {nz, nR} matrix [T]</li>
<li>double bz Magnetic field R component on the Rz-grid as a {nz, nR} matrix [T]</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>HDF5 file identifier for a file which is opened and closed outside of this function </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct which is allocated here </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array which is allocated here and used to store psi, B_R, B_phi, and B_z values as required by <a class="el" href="B__2DS_8c.html#afcf0b85f08ad40a47972977c250f40e8" title="Initialize magnetic field offload data.">B_2DS_init_offload()</a> </td></tr>
    <tr><td class="paramname">qid</td><td>QID of the B_2DS field that is to be read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if reading succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00157">157</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="ac6ac4ccb41e491f4a3206a9c94c5494a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6ac4ccb41e491f4a3206a9c94c5494a">&#9670;&nbsp;</a></span>hdf5_bfield_read_3DS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hdf5_bfield_read_3DS </td>
          <td>(</td>
          <td class="paramtype">hid_t&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__3DS__offload__data.html">B_3DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>qid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read magnetic field data of type B_3DS. </p>
<p>The B_3DS data is stored in HDF5 file under the group /bfield/B_3DS-XXXXXXXXXX/ where X's mark the QID.</p>
<p>This function assumes the group holds the following datasets: (B data refers to <img class="formulaInl" alt="$B_R$" src="form_5.png"/>, <img class="formulaInl" alt="$B_phi$" src="form_34.png"/>, and <img class="formulaInl" alt="$B_z$" src="form_6.png"/> and psi data to <img class="formulaInl" alt="$\psi$" src="form_7.png"/>.)</p>
<ul>
<li>int nr Number of R grid points in the B data grid</li>
<li>int nphi Number of phi grid points in the B data grid</li>
<li>int nz Number of z grid points in the B data grid</li>
<li>double b_rmin Minimum value in B data R grid [m]</li>
<li>double b_rmax Maximum value in B data R grid [m]</li>
<li>double b_phimin Minimum value in B data phi grid [deg]</li>
<li>double b_phimax Maximum value in B data phi grid [deg]</li>
<li>double b_zmin Minimum value in B data z grid [m]</li>
<li>double b_zmax Maximum value in B data z grid [m]</li>
<li>int b_nr Number of R grid points in the psi data grid</li>
<li>int psi_nz Number of z grid points in the psi data grid</li>
<li>double ps_rmin Minimum value in psi data R grid [m]</li>
<li>double psi_rmax Maximum value in psi data R grid [m]</li>
<li>double psi_zmin Minimum value in psi data z grid [m]</li>
<li>double psi_zmax Maximum value in psi data z grid [m]</li>
<li>double axisr Magnetic axis R coordinate [m]</li>
<li>double axisz Magnetic axis z coordinate [m]</li>
<li>double psi0 Poloidal magnetic flux value on magnetic axis [V*s*m^-1]</li>
<li>double psi1 Poloidal magnetic flux value on separatrix [V*s*m^-1]</li>
<li>double psi Poloidal magnetic flux on the Rz-grid as a {psi_nz, psi_nr} matrix [V*s*m^-1]</li>
<li>double br Magnetic field R component on the Rz-grid as a {b_nz, b_nphi, b_nr} matrix [T]</li>
<li>double bphi Magnetic field R component on the Rz-grid as a {b_nz, b_nphi, b_nr} matrix [T]</li>
<li>double bz Magnetic field R component on the Rz-grid as a {b_nz, b_nphi, b_nr} matrix [T]</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>HDF5 file identifier for a file which is opened and closed outside of this function </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct which is allocated here </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array which is allocated here and used to store psi, B_R, B_phi, and B_z values as required by <a class="el" href="B__3DS_8c.html#a6ef9bae22aaa9142883fd9235c094690" title="Initialize magnetic field offload data.">B_3DS_init_offload()</a> </td></tr>
    <tr><td class="paramname">qid</td><td>QID of the B_3DS field that is to be read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if reading succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00256">256</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="a3e6ba4c926f9e8438b659226da276515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e6ba4c926f9e8438b659226da276515">&#9670;&nbsp;</a></span>hdf5_bfield_read_STS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hdf5_bfield_read_STS </td>
          <td>(</td>
          <td class="paramtype">hid_t&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__STS__offload__data.html">B_STS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>qid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read magnetic field data of type B_STS. </p>
<p>The B_STS data is stored in HDF5 file under the group /bfield/B_STS_XXXXXXXXXX/ where X's mark the QID.</p>
<p>This function assumes the group holds the following datasets: (B data refers to <img class="formulaInl" alt="$B_R$" src="form_5.png"/>, <img class="formulaInl" alt="$B_phi$" src="form_34.png"/>, and <img class="formulaInl" alt="$B_z$" src="form_6.png"/> and psi data to <img class="formulaInl" alt="$\psi$" src="form_7.png"/>.)</p>
<ul>
<li>int nr Number of R grid points in the B data grid</li>
<li>int nphi Number of phi grid points in the B data grid</li>
<li>int nz Number of z grid points in the B data grid</li>
<li>double b_rmin Minimum value in B data R grid [m]</li>
<li>double b_rmax Maximum value in B data R grid [m]</li>
<li>double b_phimin Minimum value in B data phi grid [deg]</li>
<li>double b_phimax Maximum value in B data phi grid [deg]</li>
<li>double b_zmin Minimum value in B data z grid [m]</li>
<li>double b_zmax Maximum value in B data z grid [m]</li>
<li>int psi_nr Number of R grid points in the psi data grid</li>
<li>int psi_nphi Number of phi grid points in the psi data grid</li>
<li>int psi_nz Number of z grid points in the psi data grid</li>
<li>double psi_rmin Minimum value in psi data R grid [m]</li>
<li>double psi_rmax Maximum value in psi data R grid [m]</li>
<li>double psi_phimin Minimum value in psi data phi grid [deg]</li>
<li>double psi_phimax Maximum value in psi data phi grid [deg]</li>
<li>double psi_zmin Minimum value in psi data z grid [m]</li>
<li>double psi_zmax Maximum value in psi data z grid [m]</li>
<li>int n_axis Number of phi grid points in the magnetic axis data grid</li>
<li>double axis_min Minimum value in magnetic axis data phi grid [deg]</li>
<li>double axis_max Maximum value in magnetic axis data phi grid [deg]</li>
<li>double psi0 Poloidal magnetic flux value on magnetic axis [V*s*m^-1]</li>
<li>double psi1 Poloidal magnetic flux value on separatrix [V*s*m^-1]</li>
<li>double psi Poloidal magnetic flux on the Rpz-grid as a {psi_nphi, psi_nz, psi_nr} matrix [V*s*m^-1]</li>
<li>double br Magnetic field R component on the Rpz-grid as a {b_nphi, b_nz, b_nr} matrix [T]</li>
<li>double bphi Magnetic field R component on the Rpz-grid as a {b_nphi, b_nz, b_nr} matrix [T]</li>
<li>double bz Magnetic field R component on the Rpz-grid as a {b_nphi, b_nz, b_nr} matrix [T]</li>
<li>double axis_R Magnetic axis R location as a {n_axis} vector [m]</li>
<li>double axis_z Magnetic axis R location as a {n_axis} vector [m]</li>
<li>int toroidalPeriods Fraction of the device the data represents.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>HDF5 file identifier for a file which is opened and closed outside of this function </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct which is allocated here </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array which is allocated here and used to store psi, B_R, B_phi, B_z, axis_r, and axis_z values as required by <a class="el" href="B__STS_8c.html#acb08fede18445a4c412118c8d0dca978" title="Initialize magnetic field offload data.">B_STS_init_offload()</a> </td></tr>
    <tr><td class="paramname">qid</td><td>QID of the B_STS field that is to be read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if reading succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00395">395</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="adba26489f9245e7937677d0a37676de0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba26489f9245e7937677d0a37676de0">&#9670;&nbsp;</a></span>hdf5_bfield_read_TC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hdf5_bfield_read_TC </td>
          <td>(</td>
          <td class="paramtype">hid_t&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__TC__offload__data.html">B_TC_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>qid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read magnetic field data of type B_TC. </p>
<p>The B_TC data is stored in HDF5 file under the group /bfield/B_TC_XXXXXXXXXX/ where X's mark the QID.</p>
<p>This function assumes the group holds the following datasets:</p>
<ul>
<li>double axisr A value that is returned when magnetic axis R coordinate is requested [m]</li>
<li>double axisz A value that is returned when magnetic axis z coordinate is requested [m]</li>
<li>double psival A value that is returned when poloidal magnetic flux value is requested [V*s*m^-1]</li>
<li>double rhoval A value that is returned when normalized poloidal flux value is requested</li>
<li>double Bxyz Magnetic field values at origo: [B_x, B_y, B_z] [T]</li>
<li>double jacobian Magnetic field Jacobian [dB_x/dx, dB_x/dy, dB_x/dz, dB_y/dx, dB_y/dy, dB_y/dz, dB_z/dx, dB_z/dy, dB_z/dz] [T/m]</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>HDF5 file identifier for a file which is opened and closed outside of this function </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct which is allocated here </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array but no data is stored there so it is not allocated and NULL pointer is returned instead </td></tr>
    <tr><td class="paramname">qid</td><td>QID of the B_TC field that is to be read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if reading succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00533">533</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="ad7721125ba1c0c592243e170ca83aff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7721125ba1c0c592243e170ca83aff2">&#9670;&nbsp;</a></span>hdf5_bfield_read_GS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hdf5_bfield_read_GS </td>
          <td>(</td>
          <td class="paramtype">hid_t&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__GS__offload__data.html">B_GS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>qid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read magnetic field data of type B_GS. </p>
<p>The B_GS data is stored in HDF5 file under the group /bfield/B_GS_XXXXXXXXXX/ where X's mark the QID.</p>
<p>This function assumes the group holds the following datasets:</p>
<ul>
<li>double r0 Magnetic axis R coordinate [m]</li>
<li>double z0 Magnetic axis z coordinate [m]</li>
<li>double bphi0 Toroidal magnetic field value at magnetic axis [T]</li>
<li>double psi0 Poloidal flux value at magnetic axis [V*s*m^-1]</li>
<li>double psi1 Poloidal flux value at separatrix [V*s*m^-1]</li>
<li>double psi_mult Scaling factor for psi</li>
<li>double coefficients Coefficients for evaluating psi [c_1, c_2, ..., c_12, A]</li>
<li>double delta0 Ripple strength</li>
<li>double alpha0 Ripple penetration</li>
<li>double a0 Minor radius [m]</li>
<li>int nripple Number of toroidal field coils</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>HDF5 file identifier for a file which is opened and closed outside of this function </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct which is allocated here </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array but no data is stored there so it is not allocated and NULL pointer is returned instead </td></tr>
    <tr><td class="paramname">qid</td><td>QID of the B_GS field that is to be read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if reading succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00584">584</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
<a id="a59dacef5bb8ee42211b378aac4747070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59dacef5bb8ee42211b378aac4747070">&#9670;&nbsp;</a></span>hdf5_bfield_init_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hdf5_bfield_init_offload </td>
          <td>(</td>
          <td class="paramtype">hid_t&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__offload__data.html">B_field_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>qid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize magnetic field offload data from HDF5 file. </p>
<p>This function determines to which type of magnetic field the given QID corresponds to, and calls the corresponding reading routine. The read data is then used to initialize the offload data by calling <a class="el" href="B__field_8c.html#a2d598ab320e3063286cdbde51a265d74" title="Load magnetic field data and prepare parameters.">B_field_init_offload()</a>.</p>
<p>The magnetic field data is stored under /bfield/ group in ASCOT5 HDF5 file. Several magnetic fields of same or different type maybe stored there in their respective groups as long as the group name contains QID as an identifier.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>HDF5 file identifier for a file which is opened and closed outside of this function </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct which is initialized here </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array which is allocated and initialized here </td></tr>
    <tr><td class="paramname">qid</td><td>QID of the data that is to be read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if reading and initialization succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="hdf5__bfield_8c_source.html#l00069">69</a> of file <a class="el" href="hdf5__bfield_8c_source.html">hdf5_bfield.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
