<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: math.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">math.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="math_8c.html" title="Mathematical utility functions.">math.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">ascot5.h</a>&quot;</code><br />
</div>
<p><a href="math_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5a5865f0359145b3bce567c038bd8390"><td class="memItemLeft" align="right" valign="top"><a id="a5a5865f0359145b3bce567c038bd8390"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a5a5865f0359145b3bce567c038bd8390">math_degrad</a>&#160;&#160;&#160;0.0174532925199432957692</td></tr>
<tr class="memdesc:a5a5865f0359145b3bce567c038bd8390"><td class="mdescLeft">&#160;</td><td class="mdescRight">One degree in radians. <br /></td></tr>
<tr class="separator:a5a5865f0359145b3bce567c038bd8390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9cb87ee9b77c695c1ce36cf6a23ed57"><td class="memItemLeft" align="right" valign="top"><a id="ac9cb87ee9b77c695c1ce36cf6a23ed57"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#ac9cb87ee9b77c695c1ce36cf6a23ed57">math_raddeg</a>&#160;&#160;&#160;57.295779513082320876798</td></tr>
<tr class="memdesc:ac9cb87ee9b77c695c1ce36cf6a23ed57"><td class="mdescLeft">&#160;</td><td class="mdescRight">One radian in degrees. <br /></td></tr>
<tr class="separator:ac9cb87ee9b77c695c1ce36cf6a23ed57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4535483342e05f7c8bee5caa4407a150"><td class="memItemLeft" align="right" valign="top"><a id="a4535483342e05f7c8bee5caa4407a150"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a4535483342e05f7c8bee5caa4407a150">math_maxSimpsonDepth</a>&#160;&#160;&#160;20</td></tr>
<tr class="memdesc:a4535483342e05f7c8bee5caa4407a150"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum recursion depth for the simpson integral rule. <br /></td></tr>
<tr class="separator:a4535483342e05f7c8bee5caa4407a150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50766b1793ed1c721c5e174603cc4a38"><td class="memItemLeft" align="right" valign="top"><a id="a50766b1793ed1c721c5e174603cc4a38"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a50766b1793ed1c721c5e174603cc4a38">math_copy</a>(a,  b)&#160;&#160;&#160;do { a[0]=b[0];a[1]=b[1];a[2]=b[2]; } while(0)</td></tr>
<tr class="memdesc:a50766b1793ed1c721c5e174603cc4a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies elements of vector b to vector a. <br /></td></tr>
<tr class="separator:a50766b1793ed1c721c5e174603cc4a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6e9a112b2b69e775eaefff5646f136c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#af6e9a112b2b69e775eaefff5646f136c">math_matcopy</a>(a,  b)</td></tr>
<tr class="memdesc:af6e9a112b2b69e775eaefff5646f136c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies elements of matrix b to matrix a.  <a href="math_8h.html#af6e9a112b2b69e775eaefff5646f136c">More...</a><br /></td></tr>
<tr class="separator:af6e9a112b2b69e775eaefff5646f136c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212fc9c17be398b934456f0fa641541a"><td class="memItemLeft" align="right" valign="top"><a id="a212fc9c17be398b934456f0fa641541a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a212fc9c17be398b934456f0fa641541a">math_dot</a>(a,  b)&#160;&#160;&#160;(a[0]*b[0]+a[1]*b[1]+a[2]*b[2])</td></tr>
<tr class="memdesc:a212fc9c17be398b934456f0fa641541a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate dot product a[3] dot b[3]. <br /></td></tr>
<tr class="separator:a212fc9c17be398b934456f0fa641541a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe0d82787eb750e38e7fbb791c575084"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#abe0d82787eb750e38e7fbb791c575084">math_cross</a>(a,  b,  c)</td></tr>
<tr class="memdesc:abe0d82787eb750e38e7fbb791c575084"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate cross product for 3D vectors c = a x b.  <a href="math_8h.html#abe0d82787eb750e38e7fbb791c575084">More...</a><br /></td></tr>
<tr class="separator:abe0d82787eb750e38e7fbb791c575084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ab588b36d3bad74748769c518cbeea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a78ab588b36d3bad74748769c518cbeea">math_scalar_triple_product</a>(a,  b,  c)</td></tr>
<tr class="memdesc:a78ab588b36d3bad74748769c518cbeea"><td class="mdescLeft">&#160;</td><td class="mdescRight">the mixed or triple product of three vectors (a cross b) dot c mathematica: a={a0,a1,a2};b={b0,b1,b2};c={c0,c1,c2};FullSimplify[Dot[Cross[a,b],c]] -(a2 b1 c0) + a1 b2 c0 + a2 b0 c1 - a0 b2 c1 - a1 b0 c2 + a0 b1 c2  <a href="math_8h.html#a78ab588b36d3bad74748769c518cbeea">More...</a><br /></td></tr>
<tr class="separator:a78ab588b36d3bad74748769c518cbeea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f858f243cd3c2c11928fe2b17eb5bf4"><td class="memItemLeft" align="right" valign="top"><a id="a0f858f243cd3c2c11928fe2b17eb5bf4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a0f858f243cd3c2c11928fe2b17eb5bf4">math_sumew</a>(a,  b)&#160;&#160;&#160;do { a[0]=a[0]+b[0];a[1]=a[1]+b[1];a[2]=a[2]+b[2] } while(0)</td></tr>
<tr class="memdesc:a0f858f243cd3c2c11928fe2b17eb5bf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Elementwise vector sum a = a + b. <br /></td></tr>
<tr class="separator:a0f858f243cd3c2c11928fe2b17eb5bf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60adcaf65436d9a7aa9793227410ff8"><td class="memItemLeft" align="right" valign="top"><a id="ae60adcaf65436d9a7aa9793227410ff8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#ae60adcaf65436d9a7aa9793227410ff8">math_prod</a>(a,  b)&#160;&#160;&#160;do { a[0]=a[0]*b;a[1]=a[1]*b;a[2]=a[2]*b; } while(0)</td></tr>
<tr class="memdesc:ae60adcaf65436d9a7aa9793227410ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply vector elements with a scalar a = b*a. <br /></td></tr>
<tr class="separator:ae60adcaf65436d9a7aa9793227410ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d7d021b368f53f10bf43bb2d86f3de3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a8d7d021b368f53f10bf43bb2d86f3de3">math_matsumew</a>(a,  b)</td></tr>
<tr class="memdesc:a8d7d021b368f53f10bf43bb2d86f3de3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Elementwise matrix sum a = a + b.  <a href="math_8h.html#a8d7d021b368f53f10bf43bb2d86f3de3">More...</a><br /></td></tr>
<tr class="separator:a8d7d021b368f53f10bf43bb2d86f3de3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184a10666bfb4a029c15f291c3494104"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a184a10666bfb4a029c15f291c3494104">math_matprod</a>(a,  b)</td></tr>
<tr class="memdesc:a184a10666bfb4a029c15f291c3494104"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply matrix a with scalar b: a = b*a.  <a href="math_8h.html#a184a10666bfb4a029c15f291c3494104">More...</a><br /></td></tr>
<tr class="separator:a184a10666bfb4a029c15f291c3494104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcdc12f390386bae35dfed59f73e247"><td class="memItemLeft" align="right" valign="top"><a id="adfcdc12f390386bae35dfed59f73e247"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#adfcdc12f390386bae35dfed59f73e247">math_norm</a>(a)&#160;&#160;&#160;(sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]))</td></tr>
<tr class="memdesc:adfcdc12f390386bae35dfed59f73e247"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate norm of 3D vector a. <br /></td></tr>
<tr class="separator:adfcdc12f390386bae35dfed59f73e247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd3175f6bee0adbe5ac6a37d856aa407"><td class="memItemLeft" align="right" valign="top"><a id="abd3175f6bee0adbe5ac6a37d856aa407"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#abd3175f6bee0adbe5ac6a37d856aa407">math_normc</a>(a1,  a2,  a3)&#160;&#160;&#160;(sqrt(a1*a1+a2*a2+a3*a3))</td></tr>
<tr class="memdesc:abd3175f6bee0adbe5ac6a37d856aa407"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate norm of 3D vector from its components a1, a2, a3. <br /></td></tr>
<tr class="separator:abd3175f6bee0adbe5ac6a37d856aa407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29911679af4275647fea8492f908bbd9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a29911679af4275647fea8492f908bbd9">math_unit</a>(a,  b)</td></tr>
<tr class="memdesc:a29911679af4275647fea8492f908bbd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate unit vector b from a 3D vector a.  <a href="math_8h.html#a29911679af4275647fea8492f908bbd9">More...</a><br /></td></tr>
<tr class="separator:a29911679af4275647fea8492f908bbd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a484ec0cbb3628bc8451a4f82ba292803"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a484ec0cbb3628bc8451a4f82ba292803">math_xyz2rpz</a>(xyz,  rpz)</td></tr>
<tr class="memdesc:a484ec0cbb3628bc8451a4f82ba292803"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert cartesian coordinates xyz to cylindrical coordinates rpz.  <a href="math_8h.html#a484ec0cbb3628bc8451a4f82ba292803">More...</a><br /></td></tr>
<tr class="separator:a484ec0cbb3628bc8451a4f82ba292803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a809a2184a4686fc5413b60fa21b9b5cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a809a2184a4686fc5413b60fa21b9b5cc">math_rpz2xyz</a>(rpz,  xyz)</td></tr>
<tr class="memdesc:a809a2184a4686fc5413b60fa21b9b5cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert cylindrical coordinates rpz to cartesian coordinates xyz.  <a href="math_8h.html#a809a2184a4686fc5413b60fa21b9b5cc">More...</a><br /></td></tr>
<tr class="separator:a809a2184a4686fc5413b60fa21b9b5cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66786bed3cb8894ebcc2f06c9162fef2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a66786bed3cb8894ebcc2f06c9162fef2">math_vec_rpz2xyz</a>(vrpz,  vxyz,  phi)</td></tr>
<tr class="memdesc:a66786bed3cb8894ebcc2f06c9162fef2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform vector from cylindrical to cartesian basis: vrpz -&gt; vxyz, phi is the toroidal angle in radians.  <a href="math_8h.html#a66786bed3cb8894ebcc2f06c9162fef2">More...</a><br /></td></tr>
<tr class="separator:a66786bed3cb8894ebcc2f06c9162fef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2926fc9962621a0a75d463e6b43f449d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a2926fc9962621a0a75d463e6b43f449d">math_vec_xyz2rpz</a>(vxyz,  vrpz,  phi)</td></tr>
<tr class="memdesc:a2926fc9962621a0a75d463e6b43f449d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform vector from cartesian to cylindrical basis: vxyz -&gt; vrpz, phi is the toroidal angle in radians.  <a href="math_8h.html#a2926fc9962621a0a75d463e6b43f449d">More...</a><br /></td></tr>
<tr class="separator:a2926fc9962621a0a75d463e6b43f449d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d820c5b699aab90f4f55194b3d705bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a1d820c5b699aab90f4f55194b3d705bf">math_determinant3x3</a>(x1,  x2,  x3,  y1,  y2,  y3,  z1,  z2,  z3)</td></tr>
<tr class="memdesc:a1d820c5b699aab90f4f55194b3d705bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Direct expansion of 3x3 matrix determinant.  <a href="math_8h.html#a1d820c5b699aab90f4f55194b3d705bf">More...</a><br /></td></tr>
<tr class="separator:a1d820c5b699aab90f4f55194b3d705bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53741808556b85db16d3816d7f47f63"><td class="memItemLeft" align="right" valign="top"><a id="aa53741808556b85db16d3816d7f47f63"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#aa53741808556b85db16d3816d7f47f63">math_deg2rad</a>(a)&#160;&#160;&#160;(a * <a class="el" href="math_8h.html#a5a5865f0359145b3bce567c038bd8390">math_degrad</a>)</td></tr>
<tr class="memdesc:aa53741808556b85db16d3816d7f47f63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert degrees to radians. <br /></td></tr>
<tr class="separator:aa53741808556b85db16d3816d7f47f63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99307d8c1ae67cdea38938ac1fb5095d"><td class="memItemLeft" align="right" valign="top"><a id="a99307d8c1ae67cdea38938ac1fb5095d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a99307d8c1ae67cdea38938ac1fb5095d">math_rad2deg</a>(a)&#160;&#160;&#160;(a * <a class="el" href="math_8h.html#ac9cb87ee9b77c695c1ce36cf6a23ed57">math_raddeg</a>)</td></tr>
<tr class="memdesc:a99307d8c1ae67cdea38938ac1fb5095d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert radians to degrees. <br /></td></tr>
<tr class="separator:a99307d8c1ae67cdea38938ac1fb5095d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afe38b43cda283fdf4db89eafe9515746"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#afe38b43cda283fdf4db89eafe9515746">math_jac_rpz2xyz</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *rpz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *xyz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi)</td></tr>
<tr class="memdesc:afe38b43cda283fdf4db89eafe9515746"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a Jacobian from cylindrical to cartesian coordinates.  <a href="math_8h.html#afe38b43cda283fdf4db89eafe9515746">More...</a><br /></td></tr>
<tr class="separator:afe38b43cda283fdf4db89eafe9515746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed7ada7822595d869435af64095f5330"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#aed7ada7822595d869435af64095f5330">math_jac_xyz2rpz</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *xyz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *rpz, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi)</td></tr>
<tr class="memdesc:aed7ada7822595d869435af64095f5330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a Jacobian from cartesian to cylindrical coordinates.  <a href="math_8h.html#aed7ada7822595d869435af64095f5330">More...</a><br /></td></tr>
<tr class="separator:aed7ada7822595d869435af64095f5330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42e276b970620bc71c2d4833079b4ddc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a42e276b970620bc71c2d4833079b4ddc">math_matmul</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *matA, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *matB, int d1, int d2, int d3, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *matC)</td></tr>
<tr class="memdesc:a42e276b970620bc71c2d4833079b4ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix multiplication.  <a href="math_8h.html#a42e276b970620bc71c2d4833079b4ddc">More...</a><br /></td></tr>
<tr class="separator:a42e276b970620bc71c2d4833079b4ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cdff9b5af7c4cc64bafa9765e112ca3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a3cdff9b5af7c4cc64bafa9765e112ca3">math_normal_rand</a> ()</td></tr>
<tr class="memdesc:a3cdff9b5af7c4cc64bafa9765e112ca3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate normally distributed random numbers.  <a href="math_8h.html#a3cdff9b5af7c4cc64bafa9765e112ca3">More...</a><br /></td></tr>
<tr class="separator:a3cdff9b5af7c4cc64bafa9765e112ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a268aacd23c5013cad8ccaa9692aa3631"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a268aacd23c5013cad8ccaa9692aa3631">math_ipow</a> (int a, int p)</td></tr>
<tr class="memdesc:a268aacd23c5013cad8ccaa9692aa3631"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a^p where both a and p are integers (p &gt;= 0)  <a href="math_8h.html#a268aacd23c5013cad8ccaa9692aa3631">More...</a><br /></td></tr>
<tr class="separator:a268aacd23c5013cad8ccaa9692aa3631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2790a09a5107237e5b11d875f8e3703d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a2790a09a5107237e5b11d875f8e3703d">math_simpson</a> (double(*f)(double), double a, double b, double epsilon)</td></tr>
<tr class="memdesc:a2790a09a5107237e5b11d875f8e3703d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adaptive Simpsons rule for integral.  <a href="math_8h.html#a2790a09a5107237e5b11d875f8e3703d">More...</a><br /></td></tr>
<tr class="separator:a2790a09a5107237e5b11d875f8e3703d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbaa1d87b5cc438fbd03b48912b3fee1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#acbaa1d87b5cc438fbd03b48912b3fee1">math_linspace</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *vec, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> a, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> b, int n)</td></tr>
<tr class="memdesc:acbaa1d87b5cc438fbd03b48912b3fee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate linearly spaced vector.  <a href="math_8h.html#acbaa1d87b5cc438fbd03b48912b3fee1">More...</a><br /></td></tr>
<tr class="separator:acbaa1d87b5cc438fbd03b48912b3fee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad058764586ae6b1953b866bf156fa521"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#ad058764586ae6b1953b866bf156fa521">math_point_on_plane</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> q[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t1[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t2[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t3[3])</td></tr>
<tr class="memdesc:ad058764586ae6b1953b866bf156fa521"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find if a point is on a given plane.  <a href="math_8h.html#ad058764586ae6b1953b866bf156fa521">More...</a><br /></td></tr>
<tr class="separator:ad058764586ae6b1953b866bf156fa521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8556627d200439ee8b6da2c5dc1a1af2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a8556627d200439ee8b6da2c5dc1a1af2">math_barycentric_coords_triangle</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> AP[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> AB[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> AC[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> n[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *s, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *t)</td></tr>
<tr class="memdesc:a8556627d200439ee8b6da2c5dc1a1af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find barycentric coordinates for a given point.  <a href="math_8h.html#a8556627d200439ee8b6da2c5dc1a1af2">More...</a><br /></td></tr>
<tr class="separator:a8556627d200439ee8b6da2c5dc1a1af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0891e188229459cadca6a189675d9af6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a0891e188229459cadca6a189675d9af6">math_uniquecount</a> (int *in, int *unique, int *count, int n)</td></tr>
<tr class="memdesc:a0891e188229459cadca6a189675d9af6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find unique numbers and their frequency in given array.  <a href="math_8h.html#a0891e188229459cadca6a189675d9af6">More...</a><br /></td></tr>
<tr class="separator:a0891e188229459cadca6a189675d9af6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2fe8b5e5783b76fd11470a5c4db27bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#ad2fe8b5e5783b76fd11470a5c4db27bd">math_rsearch</a> (const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> key, const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *base, int num)</td></tr>
<tr class="memdesc:ad2fe8b5e5783b76fd11470a5c4db27bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search for array element preceding a key value.  <a href="math_8h.html#ad2fe8b5e5783b76fd11470a5c4db27bd">More...</a><br /></td></tr>
<tr class="separator:ad2fe8b5e5783b76fd11470a5c4db27bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f5d2f375008cc840b427e332b15588c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math_8h.html#a2f5d2f375008cc840b427e332b15588c">math_point_in_polygon</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *rv, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *zv, int n)</td></tr>
<tr class="memdesc:a2f5d2f375008cc840b427e332b15588c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if coordinates are within polygon.  <a href="math_8h.html#a2f5d2f375008cc840b427e332b15588c">More...</a><br /></td></tr>
<tr class="separator:a2f5d2f375008cc840b427e332b15588c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="math_8c.html" title="Mathematical utility functions.">math.c</a>. </p>

<p class="definition">Definition in file <a class="el" href="math_8h_source.html">math.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af6e9a112b2b69e775eaefff5646f136c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6e9a112b2b69e775eaefff5646f136c">&#9670;&nbsp;</a></span>math_matcopy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_matcopy</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]; \</div>
<div class="line">        a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8]; } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Copies elements of matrix b to matrix a. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00023">23</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="abe0d82787eb750e38e7fbb791c575084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe0d82787eb750e38e7fbb791c575084">&#9670;&nbsp;</a></span>math_cross</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_cross</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { c[0]=a[1]*b[2]-a[2]*b[1];                \</div>
<div class="line">        c[1]=a[2]*b[0]-a[0]*b[2];c[2]=a[0]*b[1]-a[1]*b[0]; } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Calculate cross product for 3D vectors c = a x b. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00030">30</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a78ab588b36d3bad74748769c518cbeea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78ab588b36d3bad74748769c518cbeea">&#9670;&nbsp;</a></span>math_scalar_triple_product</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_scalar_triple_product</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">       ( - (a[2] * b[1] * c[0] ) \</div>
<div class="line">         + (a[1] * b[2] * c[0] ) \</div>
<div class="line">         + (a[2] * b[0] * c[1] ) \</div>
<div class="line">         - (a[0] * b[2] * c[1] ) \</div>
<div class="line">         - (a[1] * b[0] * c[2] ) \</div>
<div class="line">         + (a[0] * b[1] * c[2] )     )</div>
</div><!-- fragment -->
<p>the mixed or triple product of three vectors (a cross b) dot c mathematica: a={a0,a1,a2};b={b0,b1,b2};c={c0,c1,c2};FullSimplify[Dot[Cross[a,b],c]] -(a2 b1 c0) + a1 b2 c0 + a2 b0 c1 - a0 b2 c1 - a1 b0 c2 + a0 b1 c2 </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00038">38</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a8d7d021b368f53f10bf43bb2d86f3de3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d7d021b368f53f10bf43bb2d86f3de3">&#9670;&nbsp;</a></span>math_matsumew</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_matsumew</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { a[0]=a[0]+b[0];a[1]=a[1]+b[1];a[2]=a[2]+b[2]; \</div>
<div class="line">        a[3]=a[3]+b[3];a[4]=a[4]+b[4];a[5]=a[5]+b[5];a[6]=a[6]+b[6];    \</div>
<div class="line">        a[7]=a[7]+b[7];a[8]=a[8]+b[8]; } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Elementwise matrix sum a = a + b. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00053">53</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a184a10666bfb4a029c15f291c3494104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184a10666bfb4a029c15f291c3494104">&#9670;&nbsp;</a></span>math_matprod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_matprod</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { a[0]=a[0]*b;a[1]=a[1]*b;a[2]=a[2]*b;  \</div>
<div class="line">        a[3]=a[3]*b;a[4]=a[4]*b;a[5]=a[5]*b;a[6]=a[6]*b;a[7]=a[7]*b; \</div>
<div class="line">        a[8]=a[8]*b } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Multiply matrix a with scalar b: a = b*a. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00058">58</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a29911679af4275647fea8492f908bbd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29911679af4275647fea8492f908bbd9">&#9670;&nbsp;</a></span>math_unit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_unit</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> {<a class="code" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> _n=sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]); \</div>
<div class="line">        b[0]=a[0]/_n;b[1]=a[1]/_n;b[2]=a[2]/_n; } <span class="keywordflow">while</span>(0)</div>
<div class="ttc" id="aascot5_8h_html_a11d147c64891830c9e79b3315b1b2e21"><div class="ttname"><a href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a></div><div class="ttdeci">double real</div><div class="ttdef"><b>Definition:</b> <a href="ascot5_8h_source.html#l00082">ascot5.h:82</a></div></div>
</div><!-- fragment -->
<p>Calculate unit vector b from a 3D vector a. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00069">69</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a484ec0cbb3628bc8451a4f82ba292803"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a484ec0cbb3628bc8451a4f82ba292803">&#9670;&nbsp;</a></span>math_xyz2rpz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_xyz2rpz</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">xyz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rpz&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { rpz[0]=sqrt(xyz[0]*xyz[0]+xyz[1]*xyz[1]); \</div>
<div class="line">        rpz[1]=atan2(xyz[1],xyz[0]);rpz[2]=xyz[2]; } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Convert cartesian coordinates xyz to cylindrical coordinates rpz. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00073">73</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a809a2184a4686fc5413b60fa21b9b5cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a809a2184a4686fc5413b60fa21b9b5cc">&#9670;&nbsp;</a></span>math_rpz2xyz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_rpz2xyz</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rpz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">xyz&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { xyz[0]=rpz[0]*cos(rpz[1]); \</div>
<div class="line">        xyz[1]=rpz[0]*sin(rpz[1]);xyz[2]=rpz[2]; } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Convert cylindrical coordinates rpz to cartesian coordinates xyz. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00077">77</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a66786bed3cb8894ebcc2f06c9162fef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66786bed3cb8894ebcc2f06c9162fef2">&#9670;&nbsp;</a></span>math_vec_rpz2xyz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_vec_rpz2xyz</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">vrpz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">vxyz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">phi&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> {     \</div>
<div class="line">        vxyz[0]=vrpz[0]*cos(phi)-vrpz[1]*sin(phi); \</div>
<div class="line">        vxyz[1]=vrpz[0]*sin(phi)+vrpz[1]*cos(phi); \</div>
<div class="line">        vxyz[2]=vrpz[2]; } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Transform vector from cylindrical to cartesian basis: vrpz -&gt; vxyz, phi is the toroidal angle in radians. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00082">82</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a2926fc9962621a0a75d463e6b43f449d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2926fc9962621a0a75d463e6b43f449d">&#9670;&nbsp;</a></span>math_vec_xyz2rpz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_vec_xyz2rpz</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">vxyz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">vrpz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">phi&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> {      \</div>
<div class="line">        vrpz[0]=vxyz[0]*cos(phi)+vxyz[1]*sin(phi);  \</div>
<div class="line">        vrpz[1]=-vxyz[0]*sin(phi)+vxyz[1]*cos(phi); \</div>
<div class="line">        vrpz[2]=vxyz[2]; } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Transform vector from cartesian to cylindrical basis: vxyz -&gt; vrpz, phi is the toroidal angle in radians. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00089">89</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<a id="a1d820c5b699aab90f4f55194b3d705bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d820c5b699aab90f4f55194b3d705bf">&#9670;&nbsp;</a></span>math_determinant3x3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define math_determinant3x3</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">z1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">z2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">z3&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    (x1) * ( (y2)*(z3) - (y3)*(z2) ) + \</div>
<div class="line">    (x2) * ( (y3)*(z1) - (y1)*(z3) ) + \</div>
<div class="line">    (x3) * ( (y1)*(z2) - (y2)*(z1) )</div>
</div><!-- fragment -->
<p>Direct expansion of 3x3 matrix determinant. </p>

<p class="definition">Definition at line <a class="el" href="math_8h_source.html#l00096">96</a> of file <a class="el" href="math_8h_source.html">math.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afe38b43cda283fdf4db89eafe9515746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe38b43cda283fdf4db89eafe9515746">&#9670;&nbsp;</a></span>math_jac_rpz2xyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_jac_rpz2xyz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>rpz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>xyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a Jacobian from cylindrical to cartesian coordinates. </p>
<p>This function converts a Jacobian located at angle phi and radius r from cylindrical to cartesian coordinates. The input Jacobian is an array with</p>
<p>[Br dBr/dr dBr/dphi dBr/dz Bphi dBphi/dr dBphi/dphi dBphi/dz Bz dBz/dr dBz/dphi dBz/dz]</p>
<p>an the output is</p>
<p>[Bx dBx/dx dBx/dy dBx/dz By dBy/dx dBy/dy dBy/dz Bz dBz/dx dBz/dy dBz/dz].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rpz</td><td>input rpz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">xyz</td><td>output xyz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">r</td><td>r coordinate of the gradient </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate of the gradient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00036">36</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="aed7ada7822595d869435af64095f5330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed7ada7822595d869435af64095f5330">&#9670;&nbsp;</a></span>math_jac_xyz2rpz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_jac_xyz2rpz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>xyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>rpz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a Jacobian from cartesian to cylindrical coordinates. </p>
<p>This function converts a Jacobian located at angle phi and radius r from cartesian to cylindrical coordinates. The input Jacobian is an array with</p>
<p>[Bx dBx/dx dBx/dy dBx/dz By dBy/dx dBy/dy dBy/dz Bz dBz/dx dBz/dy dBz/dz]</p>
<p>an the output is</p>
<p>[Br dBr/dr dBr/dphi dBr/dz Bphi dBphi/dr dBphi/dphi dBphi/dz Bz dBz/dr dBz/dphi dBz/dz].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xyz</td><td>output xyz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">rpz</td><td>input rpz coordinates in a 3-length array </td></tr>
    <tr><td class="paramname">r</td><td>r coordinate of the gradient </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate of the gradient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00095">95</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a42e276b970620bc71c2d4833079b4ddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42e276b970620bc71c2d4833079b4ddc">&#9670;&nbsp;</a></span>math_matmul()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_matmul </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>matA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>matB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>matC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matrix multiplication. </p>
<p>This function performs matrix multiplication. The matrices are given as arrays, the indexing being row-wise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matA</td><td>input array representing a d1 x d2 matrix </td></tr>
    <tr><td class="paramname">matB</td><td>input array representing a d2 x d3 matrix </td></tr>
    <tr><td class="paramname">d1</td><td>input scalar dimension (columns in matA and matC) </td></tr>
    <tr><td class="paramname">d2</td><td>input scalar dimension (rows in matA and columns in matB) </td></tr>
    <tr><td class="paramname">d3</td><td>input scalar dimension (rows in matB and matC) </td></tr>
    <tr><td class="paramname">matC</td><td>output array representing a d1 x d3 matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00151">151</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a3cdff9b5af7c4cc64bafa9765e112ca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cdff9b5af7c4cc64bafa9765e112ca3">&#9670;&nbsp;</a></span>math_normal_rand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> math_normal_rand </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate normally distributed random numbers. </p>
<p>This function generates normally distributed random numbers with expected value of 0 and variance of 1 using the polar method [1]. The rand48 random number generator should be initialized with srand48() before calling this function.</p>
<p>[1] G. Marsaglia, T. A. Bray. A convenient method for generating normal variables. Siam Review 6.3 (1964): 260-264. <a href="http://epubs.siam.org/doi/abs/10.1137/1006063:w">http://epubs.siam.org/doi/abs/10.1137/1006063:w</a></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd><p class="startdd">Currently only one of the generated numbers is returned; a second independent variate is Y = v2 * sqrt(-2*log(s) / s) </p>
<p class="enddd">Try other random number generators such as those in Intel MKL </p>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00180">180</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a268aacd23c5013cad8ccaa9692aa3631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a268aacd23c5013cad8ccaa9692aa3631">&#9670;&nbsp;</a></span>math_ipow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int math_ipow </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a^p where both a and p are integers (p &gt;= 0) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>argument </td></tr>
    <tr><td class="paramname">p</td><td>power</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a^b </dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00202">202</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a2790a09a5107237e5b11d875f8e3703d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2790a09a5107237e5b11d875f8e3703d">&#9670;&nbsp;</a></span>math_simpson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double math_simpson </td>
          <td>(</td>
          <td class="paramtype">double(*)(double)&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adaptive Simpsons rule for integral. </p>
<p>This function uses recursive splitting of the interval until either maximum number of intervals is reached or given relative error tolerance is obtained</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>pointer to the integrand function (of one variable) </td></tr>
    <tr><td class="paramname">a</td><td>lower limit for the interval </td></tr>
    <tr><td class="paramname">b</td><td>upper limit for the interval </td></tr>
    <tr><td class="paramname">eps</td><td>absolute tolerance</td></tr>
  </table>
  </dd>
</dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>Probably does not work with SIMD </dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00224">224</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="acbaa1d87b5cc438fbd03b48912b3fee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbaa1d87b5cc438fbd03b48912b3fee1">&#9670;&nbsp;</a></span>math_linspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_linspace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate linearly spaced vector. </p>
<p>Generates linearly space vector with n elements whose end points are a and b. If n = 1, return b.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vec</td><td>n length array where result is stored </td></tr>
    <tr><td class="paramname">a</td><td>start point </td></tr>
    <tr><td class="paramname">b</td><td>end point </td></tr>
    <tr><td class="paramname">n</td><td>number of elements </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00243">243</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="ad058764586ae6b1953b866bf156fa521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad058764586ae6b1953b866bf156fa521">&#9670;&nbsp;</a></span>math_point_on_plane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int math_point_on_plane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>q</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t1</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t2</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t3</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find if a point is on a given plane. </p>
<p>Let t1=(x1, y1, z1), t2=(x2, y2, z2), and t3=(x3, y3, z3) be non-collinear points on the plane. Let q =(x, y, z) be an arbitrary point. It lies in the plane if:</p>
<p>det( |x -x1 y -y1 z -z1| |x2-x1 y2-y1 z2-z1| |x3-x1 y3-y1 z3-z1| ) == 0</p>
<p>det( |x -x1 y -y1 z -z1| |x -x2 y -y2 z -z2| |x -x3 y -y3 z -z3| ) == 0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>xyz coordinates of a query point </td></tr>
    <tr><td class="paramname">t1</td><td>xyz coordinates of the first point defining the plane </td></tr>
    <tr><td class="paramname">t2</td><td>xyz coordinates of the second point defining the plane </td></tr>
    <tr><td class="paramname">t3</td><td>xyz coordinates of the third point defining the plane </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00316">316</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a8556627d200439ee8b6da2c5dc1a1af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8556627d200439ee8b6da2c5dc1a1af2">&#9670;&nbsp;</a></span>math_barycentric_coords_triangle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_barycentric_coords_triangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>AP</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>AB</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>AC</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>n</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find barycentric coordinates for a given point. </p>
<p>Let a,b,c be the vertices of a triangle and p an arbitrary point. The s,t are the barycentric coordinates of p if: p = (1-s-t)*a + s*b + t*c</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AP</td><td>point position vector [x,y,z] </td></tr>
    <tr><td class="paramname">AB</td><td>triangle edge AB vector </td></tr>
    <tr><td class="paramname">AC</td><td>triangle edge AC vector </td></tr>
    <tr><td class="paramname">n</td><td>normal vector [nx, ny, nz] of the triangle </td></tr>
    <tr><td class="paramname">s</td><td>evaluated s coordinate </td></tr>
    <tr><td class="paramname">t</td><td>evaluated t coordinate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00352">352</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a0891e188229459cadca6a189675d9af6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0891e188229459cadca6a189675d9af6">&#9670;&nbsp;</a></span>math_uniquecount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void math_uniquecount </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>unique</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find unique numbers and their frequency in given array. </p>
<p>All argument arrays are assumed to have the same length as the array holding the input numbers. If not all numbers are unique, the remaining entries in unique and count arguments are zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>input array of length n </td></tr>
    <tr><td class="paramname">unique</td><td>array where unique numbers are stored, must be of length n </td></tr>
    <tr><td class="paramname">count</td><td>count[i] is how many times unique[i] appears in array in, must be of length n </td></tr>
    <tr><td class="paramname">n</td><td>length of the argument arrays </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00268">268</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="ad2fe8b5e5783b76fd11470a5c4db27bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2fe8b5e5783b76fd11470a5c4db27bd">&#9670;&nbsp;</a></span>math_rsearch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* math_rsearch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search for array element preceding a key value. </p>
<p>This function takes an array of real values and a key value, and finds the array element which precedes the key value. The array to be searched has to be in ascending sorted order (according to comparison function rcomp).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>real value that serves as key for the search </td></tr>
    <tr><td class="paramname">base</td><td>pointer to the first object of the array to be searched </td></tr>
    <tr><td class="paramname">num</td><td>number of elements in array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to array element preceding the key, or NULL if search failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00397">397</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
<a id="a2f5d2f375008cc840b427e332b15588c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f5d2f375008cc840b427e332b15588c">&#9670;&nbsp;</a></span>math_point_in_polygon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int math_point_in_polygon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>rv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>zv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if coordinates are within polygon. </p>
<p>This function checks if the given coordinates are within a 2D polygon using a modified axis crossing method [1]. Origin is moved to the coordinates and the number of wall segments crossing the positive r-axis are calculated. If this is odd, the point is inside the polygon.</p>
<p>[1] D.G. Alciatore, R. Miranda. A Winding Number and Point-in-Polygon Algorithm. Technical report, Colorado State University, 1995. <a href="http://www.engr.colostate.edu/~dga/dga/papers/point_in_polygon.pdf">http://www.engr.colostate.edu/~dga/dga/papers/point_in_polygon.pdf</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>r coordinate </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate </td></tr>
    <tr><td class="paramname">rv</td><td>array of r points for the polygon </td></tr>
    <tr><td class="paramname">zv</td><td>array of z points for the polygon </td></tr>
    <tr><td class="paramname">n</td><td>number of points in the polygon </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math_8c_source.html#l00419">419</a> of file <a class="el" href="math_8c_source.html">math.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
