<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: mhd.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mhd.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>MHD module interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="print_8h_source.html">print.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mhd_8h_source.html">mhd.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__field_8h_source.html">B_field.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="boozer_8h_source.html">boozer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mhd__stat_8h_source.html">mhd/mhd_stat.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mhd__nonstat_8h_source.html">mhd/mhd_nonstat.h</a>&quot;</code><br />
</div>
<p><a href="mhd_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af3708acc9639d894ee7552974fd85055"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#af3708acc9639d894ee7552974fd85055">mhd_init_offload</a> (<a class="el" href="structmhd__offload__data.html">mhd_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:af3708acc9639d894ee7552974fd85055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load MHD data and prepare parameters.  <a href="mhd_8c.html#af3708acc9639d894ee7552974fd85055">More...</a><br /></td></tr>
<tr class="separator:af3708acc9639d894ee7552974fd85055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5eb45555f91d9272b5ecc8a244dc0d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#af5eb45555f91d9272b5ecc8a244dc0d5">mhd_free_offload</a> (<a class="el" href="structmhd__offload__data.html">mhd_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:af5eb45555f91d9272b5ecc8a244dc0d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free offload array and reset parameters.  <a href="mhd_8c.html#af5eb45555f91d9272b5ecc8a244dc0d5">More...</a><br /></td></tr>
<tr class="separator:af5eb45555f91d9272b5ecc8a244dc0d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a596d84c7af2ba49c7832c03e2f397c84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#a596d84c7af2ba49c7832c03e2f397c84">mhd_init</a> (<a class="el" href="structmhd__data.html">mhd_data</a> *mhddata, <a class="el" href="structmhd__offload__data.html">mhd_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *offload_array)</td></tr>
<tr class="memdesc:a596d84c7af2ba49c7832c03e2f397c84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize MHD data struct on target.  <a href="mhd_8c.html#a596d84c7af2ba49c7832c03e2f397c84">More...</a><br /></td></tr>
<tr class="separator:a596d84c7af2ba49c7832c03e2f397c84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa00e63ac9f53cb606e34d4f61e35d591"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#aa00e63ac9f53cb606e34d4f61e35d591">mhd_eval</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> mhd_dmhd[10], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t, int includemode, <a class="el" href="structboozer__data.html">boozer_data</a> *boozerdata, <a class="el" href="structmhd__data.html">mhd_data</a> *mhddata, <a class="el" href="structB__field__data.html">B_field_data</a> *Bdata)</td></tr>
<tr class="memdesc:aa00e63ac9f53cb606e34d4f61e35d591"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the needed quantities from MHD mode for orbit following.  <a href="mhd_8c.html#aa00e63ac9f53cb606e34d4f61e35d591">More...</a><br /></td></tr>
<tr class="separator:aa00e63ac9f53cb606e34d4f61e35d591"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66777d1e7f114f5aa5cfa384996bd67a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#a66777d1e7f114f5aa5cfa384996bd67a">mhd_perturbations</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> pert_field[7], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t, int pertonly, int includemode, <a class="el" href="structboozer__data.html">boozer_data</a> *boozerdata, <a class="el" href="structmhd__data.html">mhd_data</a> *mhddata, <a class="el" href="structB__field__data.html">B_field_data</a> *Bdata)</td></tr>
<tr class="memdesc:a66777d1e7f114f5aa5cfa384996bd67a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate perturbed fields Btilde, Etilde and potential Phi explicitly.  <a href="mhd_8c.html#a66777d1e7f114f5aa5cfa384996bd67a">More...</a><br /></td></tr>
<tr class="separator:a66777d1e7f114f5aa5cfa384996bd67a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a066906671291098767dc35af8d85e3c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#a066906671291098767dc35af8d85e3c1">mhd_get_n_modes</a> (<a class="el" href="structmhd__data.html">mhd_data</a> *mhddata)</td></tr>
<tr class="memdesc:a066906671291098767dc35af8d85e3c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of modes.  <a href="mhd_8c.html#a066906671291098767dc35af8d85e3c1">More...</a><br /></td></tr>
<tr class="separator:a066906671291098767dc35af8d85e3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae443ac5bbd950952e8ecbf4a2ba4ef54"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#ae443ac5bbd950952e8ecbf4a2ba4ef54">mhd_get_nmode</a> (<a class="el" href="structmhd__data.html">mhd_data</a> *mhddata)</td></tr>
<tr class="memdesc:ae443ac5bbd950952e8ecbf4a2ba4ef54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return mode toroidal numbers.  <a href="mhd_8c.html#ae443ac5bbd950952e8ecbf4a2ba4ef54">More...</a><br /></td></tr>
<tr class="separator:ae443ac5bbd950952e8ecbf4a2ba4ef54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad18add369b8f37c3240fdb3d3724b94a"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#ad18add369b8f37c3240fdb3d3724b94a">mhd_get_mmode</a> (<a class="el" href="structmhd__data.html">mhd_data</a> *mhddata)</td></tr>
<tr class="memdesc:ad18add369b8f37c3240fdb3d3724b94a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return mode poloidal numbers.  <a href="mhd_8c.html#ad18add369b8f37c3240fdb3d3724b94a">More...</a><br /></td></tr>
<tr class="separator:ad18add369b8f37c3240fdb3d3724b94a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac57282a671e54f54abc977855a34bbdf"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#ac57282a671e54f54abc977855a34bbdf">mhd_get_amplitude</a> (<a class="el" href="structmhd__data.html">mhd_data</a> *mhddata)</td></tr>
<tr class="memdesc:ac57282a671e54f54abc977855a34bbdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return mode amplitudes.  <a href="mhd_8c.html#ac57282a671e54f54abc977855a34bbdf">More...</a><br /></td></tr>
<tr class="separator:ac57282a671e54f54abc977855a34bbdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7833912413a8d4c6ea74e0de2b9417f4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#a7833912413a8d4c6ea74e0de2b9417f4">mhd_get_frequency</a> (<a class="el" href="structmhd__data.html">mhd_data</a> *mhddata)</td></tr>
<tr class="memdesc:a7833912413a8d4c6ea74e0de2b9417f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return mode frequencies.  <a href="mhd_8c.html#a7833912413a8d4c6ea74e0de2b9417f4">More...</a><br /></td></tr>
<tr class="separator:a7833912413a8d4c6ea74e0de2b9417f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3cb7cc97f032144f13c0748856482f9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd_8c.html#ad3cb7cc97f032144f13c0748856482f9">mhd_get_phase</a> (<a class="el" href="structmhd__data.html">mhd_data</a> *mhddata)</td></tr>
<tr class="memdesc:ad3cb7cc97f032144f13c0748856482f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return mode phases.  <a href="mhd_8c.html#ad3cb7cc97f032144f13c0748856482f9">More...</a><br /></td></tr>
<tr class="separator:ad3cb7cc97f032144f13c0748856482f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>MHD module interface. </p>
<p>This is an interface through which MHD data is initialized and accessed. Reading e.g. from disk is done elsewhere. The MHD module produces helical EM perturbations in to the EM field using the boozer module in making the coordinate transformations between cylindrical and straight-field-line coordinates.</p>
<p>To add a new MHD instance, make sure these functions are implemented and called from this interface, and that <a class="el" href="mhd_8h.html" title="Header file for mhd.c.">mhd.h</a> contains enum type for the new instance.</p>
<p>The interface checks which instance given data corresponds to from <a class="el" href="structmhd__offload__data.html#a211904f45beef67cee64c181999f2d0f">mhd_offload_data.type</a> and <a class="el" href="structmhd__data.html#a347d449bf250c7c0b4dac59fe4f3b910">mhd_data.type</a> from the struct that is given as an argument, and calls the relevant function for that instance. </p>

<p class="definition">Definition in file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af3708acc9639d894ee7552974fd85055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3708acc9639d894ee7552974fd85055">&#9670;&nbsp;</a></span>mhd_init_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mhd_init_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__offload__data.html">mhd_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load MHD data and prepare parameters. </p>
<p>This function fills the relevant MHD offload struct with parameters and allocates and fills the offload array.</p>
<p>The offload data has to have a type when this function is called as it should be set when the offload data is constructed from inputs.</p>
<p>This function is host only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if initialization succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00045">45</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="af5eb45555f91d9272b5ecc8a244dc0d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5eb45555f91d9272b5ecc8a244dc0d5">&#9670;&nbsp;</a></span>mhd_free_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mhd_free_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__offload__data.html">mhd_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free offload array and reset parameters. </p>
<p>This function deallocates the offload_array.</p>
<p>This function is host only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00090">90</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="a596d84c7af2ba49c7832c03e2f397c84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a596d84c7af2ba49c7832c03e2f397c84">&#9670;&nbsp;</a></span>mhd_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mhd_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmhd__offload__data.html">mhd_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize MHD data struct on target. </p>
<p>This function copies the electric field parameters from the offload struct to the struct on target and sets the MHD data pointers to correct offsets in the offload array.</p>
<p>This function returns error if the offload data has not been initialized. The instances themselves should not return an error since all they do is assign pointers and values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to data struct on target </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>the offload array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero integer if offload was not initialized beforehand </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00121">121</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="aa00e63ac9f53cb606e34d4f61e35d591"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa00e63ac9f53cb606e34d4f61e35d591">&#9670;&nbsp;</a></span>mhd_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> mhd_eval </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>mhd_dmhd</em>[10], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>includemode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structboozer__data.html">boozer_data</a> *&#160;</td>
          <td class="paramname"><em>boozerdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__data.html">B_field_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the needed quantities from MHD mode for orbit following. </p>
<p>The quantities to be evaluated are alpha, phi, grad alpha, grad phi, partial t alpha, partial t phi</p>
<p>The values are stored in the given array as:</p><ul>
<li>mhd_dmhd[0] = alpha</li>
<li>mhd_dmhd[1] = dalpha/dt</li>
<li>mhd_dmhd[2] = grad alpha, r component</li>
<li>mhd_dmhd[3] = grad alpha, phi component</li>
<li>mhd_dmhd[4] = grad alpha, z component</li>
<li>mhd_dmhd[5] = phi</li>
<li>mhd_dmhd[6] = dphi/dt</li>
<li>mhd_dmhd[7] = grad phi, r component</li>
<li>mhd_dmhd[8] = grad phi, phi component</li>
<li>mhd_dmhd[9] = grad phi, z component</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhd_dmhd</td><td></td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">t</td><td>time coordinate [s] </td></tr>
    <tr><td class="paramname">includemode</td><td>mode number to be included or MHD_INCLUDE_ALL </td></tr>
    <tr><td class="paramname">boozerdata</td><td>pointer to boozer data </td></tr>
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00178">178</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="a66777d1e7f114f5aa5cfa384996bd67a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66777d1e7f114f5aa5cfa384996bd67a">&#9670;&nbsp;</a></span>mhd_perturbations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> mhd_perturbations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>pert_field</em>[7], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pertonly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>includemode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structboozer__data.html">boozer_data</a> *&#160;</td>
          <td class="paramname"><em>boozerdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__data.html">B_field_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate perturbed fields Btilde, Etilde and potential Phi explicitly. </p>
<p>The values are stored in the given array as</p><ul>
<li>pert_field[0] = BtildeR</li>
<li>pert_field[1] = BtildePhi</li>
<li>pert_field[2] = BtildeZ</li>
<li>pert_field[3] = EtildeR</li>
<li>pert_field[4] = EtildePhi</li>
<li>pert_field[5] = EtildeZ</li>
<li>pert_field[6] = Phi</li>
</ul>
<p>Only the perturbation values for the magnetic field are returned if pertonly=1, otherwise, the total perturbed field is returned. This is done to avoid double evaluation of the magnetic field e.g. in field line tracing. For electric field only the perturbation component is returned always.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pert_field</td><td>perturbation field components </td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">t</td><td>time coordinate [s] </td></tr>
    <tr><td class="paramname">pertonly</td><td>flag whether to return the whole field or only perturbation </td></tr>
    <tr><td class="paramname">includemode</td><td>mode number to be included or MHD_INCLUDE_ALL </td></tr>
    <tr><td class="paramname">boozerdata</td><td>pointer to boozer data </td></tr>
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00234">234</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="a066906671291098767dc35af8d85e3c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a066906671291098767dc35af8d85e3c1">&#9670;&nbsp;</a></span>mhd_get_n_modes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mhd_get_n_modes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return number of modes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of modes </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00270">270</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="ae443ac5bbd950952e8ecbf4a2ba4ef54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae443ac5bbd950952e8ecbf4a2ba4ef54">&#9670;&nbsp;</a></span>mhd_get_nmode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int* mhd_get_nmode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return mode toroidal numbers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mode n numbers </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00290">290</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="ad18add369b8f37c3240fdb3d3724b94a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad18add369b8f37c3240fdb3d3724b94a">&#9670;&nbsp;</a></span>mhd_get_mmode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int* mhd_get_mmode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return mode poloidal numbers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mode m numbers </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00310">310</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="ac57282a671e54f54abc977855a34bbdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac57282a671e54f54abc977855a34bbdf">&#9670;&nbsp;</a></span>mhd_get_amplitude()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* mhd_get_amplitude </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return mode amplitudes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mode amplitudes </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00330">330</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="a7833912413a8d4c6ea74e0de2b9417f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7833912413a8d4c6ea74e0de2b9417f4">&#9670;&nbsp;</a></span>mhd_get_frequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* mhd_get_frequency </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return mode frequencies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mode omega </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00350">350</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
<a id="ad3cb7cc97f032144f13c0748856482f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3cb7cc97f032144f13c0748856482f9">&#9670;&nbsp;</a></span>mhd_get_phase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>* mhd_get_phase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return mode phases. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mode phases </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd_8c_source.html#l00370">370</a> of file <a class="el" href="mhd_8c_source.html">mhd.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
