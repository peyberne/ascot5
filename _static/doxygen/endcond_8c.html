<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: endcond.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">endcond.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Marker simulation end conditions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="endcond_8h_source.html">endcond.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="particle_8h_source.html">particle.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="simulate_8h_source.html">simulate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="physlib_8h_source.html">physlib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="consts_8h_source.html">consts.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="plasma_8h_source.html">plasma.h</a>&quot;</code><br />
</div>
<p><a href="endcond_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ace360fdebed253a8425f2dee08be587c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="endcond_8c.html#ace360fdebed253a8425f2dee08be587c">endcond_check_fo</a> (<a class="el" href="structparticle__simd__fo.html">particle_simd_fo</a> *p_f, <a class="el" href="structparticle__simd__fo.html">particle_simd_fo</a> *p_i, <a class="el" href="structsim__data.html">sim_data</a> *sim)</td></tr>
<tr class="memdesc:ace360fdebed253a8425f2dee08be587c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check end conditions for FO markers.  <a href="endcond_8c.html#ace360fdebed253a8425f2dee08be587c">More...</a><br /></td></tr>
<tr class="separator:ace360fdebed253a8425f2dee08be587c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ddc3ba1bf41f32411336ac50f70c870"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="endcond_8c.html#a8ddc3ba1bf41f32411336ac50f70c870">endcond_check_gc</a> (<a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *p_f, <a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *p_i, <a class="el" href="structsim__data.html">sim_data</a> *sim)</td></tr>
<tr class="memdesc:a8ddc3ba1bf41f32411336ac50f70c870"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check end conditions for GC markers.  <a href="endcond_8c.html#a8ddc3ba1bf41f32411336ac50f70c870">More...</a><br /></td></tr>
<tr class="separator:a8ddc3ba1bf41f32411336ac50f70c870"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad49fff3b8dc52868a0eb44e2ccd6132a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="endcond_8c.html#ad49fff3b8dc52868a0eb44e2ccd6132a">endcond_check_ml</a> (<a class="el" href="structparticle__simd__ml.html">particle_simd_ml</a> *p_f, <a class="el" href="structparticle__simd__ml.html">particle_simd_ml</a> *p_i, <a class="el" href="structsim__data.html">sim_data</a> *sim)</td></tr>
<tr class="memdesc:ad49fff3b8dc52868a0eb44e2ccd6132a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check end conditions for ML markers.  <a href="endcond_8c.html#ad49fff3b8dc52868a0eb44e2ccd6132a">More...</a><br /></td></tr>
<tr class="separator:ad49fff3b8dc52868a0eb44e2ccd6132a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305250a33bad6aa88ef074a81755f9d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="endcond_8c.html#a305250a33bad6aa88ef074a81755f9d5">endcond_parse</a> (int endcond, int *endconds)</td></tr>
<tr class="memdesc:a305250a33bad6aa88ef074a81755f9d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Split endcond to an array of end conditions.  <a href="endcond_8c.html#a305250a33bad6aa88ef074a81755f9d5">More...</a><br /></td></tr>
<tr class="separator:a305250a33bad6aa88ef074a81755f9d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af61d05ad7e7b74f37b20effb5c2e2b9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="endcond_8c.html#af61d05ad7e7b74f37b20effb5c2e2b9e">endcond_parse2str</a> (int endcond, char *str)</td></tr>
<tr class="memdesc:af61d05ad7e7b74f37b20effb5c2e2b9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represent end condition in human-readable format.  <a href="endcond_8c.html#af61d05ad7e7b74f37b20effb5c2e2b9e">More...</a><br /></td></tr>
<tr class="separator:af61d05ad7e7b74f37b20effb5c2e2b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Marker simulation end conditions. </p>
<p>In the absence of errors, marker simulation is ended when marker meets even one of the active end conditions. User can choose which end conditions are active.</p>
<p>The end conditions are:</p><ul>
<li>tlim: Marker time has passed the simulation time limit</li>
<li>emin: Marker energy is below minimum value</li>
<li>therm: Energy is below value derived from local thermal electron energy</li>
<li>wall: Marker has intersected wall</li>
<li>rhomin: Marker has reached minimum rho (normalized poloidal flux) value</li>
<li>rhomax: Marker has reached maximum rho value</li>
<li>polmax: The total cumulative distance marker has travelled poloidally exceeds maximum value</li>
<li>tormax: The total cumulative distance marker has travelled toroidally exceeds maximum value</li>
<li>cpumax: Marker simulation has exceeded maximum wall time</li>
<li>neutr: Marker has been neutralized by an atomic reaction</li>
<li>ioniz: Marker has been ionized by an atomic reaction</li>
<li>hybrid: Not an end condition per se but used to notate that the guiding center simulation will be resumed as a gyro-orbit simulation</li>
</ul>
<p>As magnetic field lines have no energy, emin and therm are never checked for them. Guiding centers are the only markers for which hybrid is checked.</p>
<p>In the code, the end conditions are represented as bit arrays with each bit corresponding to a specific end condition. Each marker has a field "endcond", and when marker meets an end condition, the corresponding bit is flagged. This way if marker simultaneously meets several end conditions, all can be flagged.</p>
<p>Additionally, when marker meets an end condition, its running state is set to False which notates its simulation should be discontinued. If the end condition is wall collision, the ID of the wall element the marker collided with is stored in the marker fields.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Error checking would be a good idea </dd></dl>

<p class="definition">Definition in file <a class="el" href="endcond_8c_source.html">endcond.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ace360fdebed253a8425f2dee08be587c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace360fdebed253a8425f2dee08be587c">&#9670;&nbsp;</a></span>endcond_check_fo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void endcond_check_fo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparticle__simd__fo.html">particle_simd_fo</a> *&#160;</td>
          <td class="paramname"><em>p_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle__simd__fo.html">particle_simd_fo</a> *&#160;</td>
          <td class="paramname"><em>p_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsim__data.html">sim_data</a> *&#160;</td>
          <td class="paramname"><em>sim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check end conditions for FO markers. </p>
<p>The end conditions are checked for all markers within the SIMD marker struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_f</td><td>pointer to SIMD struct storing marker states at the end of current time-step </td></tr>
    <tr><td class="paramname">p_i</td><td>pointer to SIMD struct storing marker states at the beginning of current time-step </td></tr>
    <tr><td class="paramname">sim</td><td>pointer to simulation data struct </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="endcond_8c_source.html#l00073">73</a> of file <a class="el" href="endcond_8c_source.html">endcond.c</a>.</p>

</div>
</div>
<a id="a8ddc3ba1bf41f32411336ac50f70c870"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ddc3ba1bf41f32411336ac50f70c870">&#9670;&nbsp;</a></span>endcond_check_gc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void endcond_check_gc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *&#160;</td>
          <td class="paramname"><em>p_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *&#160;</td>
          <td class="paramname"><em>p_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsim__data.html">sim_data</a> *&#160;</td>
          <td class="paramname"><em>sim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check end conditions for GC markers. </p>
<p>The end conditions are checked for all markers within the SIMD marker struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_f</td><td>pointer to SIMD struct storing marker states at the end of current time-step </td></tr>
    <tr><td class="paramname">p_i</td><td>pointer to SIMD struct storing marker states at the beginning of current time-step </td></tr>
    <tr><td class="paramname">sim</td><td>pointer to simulation data struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>Hybrid condition checks whether marker is over maximum rho limit. More smarter check is required. </dd></dl>

<p class="definition">Definition at line <a class="el" href="endcond_8c_source.html#l00267">267</a> of file <a class="el" href="endcond_8c_source.html">endcond.c</a>.</p>

</div>
</div>
<a id="ad49fff3b8dc52868a0eb44e2ccd6132a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad49fff3b8dc52868a0eb44e2ccd6132a">&#9670;&nbsp;</a></span>endcond_check_ml()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void endcond_check_ml </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparticle__simd__ml.html">particle_simd_ml</a> *&#160;</td>
          <td class="paramname"><em>p_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle__simd__ml.html">particle_simd_ml</a> *&#160;</td>
          <td class="paramname"><em>p_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsim__data.html">sim_data</a> *&#160;</td>
          <td class="paramname"><em>sim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check end conditions for ML markers. </p>
<p>The end conditions are checked for all markers within the SIMD marker struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_f</td><td>pointer to SIMD struct storing marker states at the end of current time-step </td></tr>
    <tr><td class="paramname">p_i</td><td>pointer to SIMD struct storing marker states at the beginning of current time-step </td></tr>
    <tr><td class="paramname">sim</td><td>pointer to simulation data struct </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="endcond_8c_source.html#l00440">440</a> of file <a class="el" href="endcond_8c_source.html">endcond.c</a>.</p>

</div>
</div>
<a id="a305250a33bad6aa88ef074a81755f9d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a305250a33bad6aa88ef074a81755f9d5">&#9670;&nbsp;</a></span>endcond_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void endcond_parse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>endcond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>endconds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Split endcond to an array of end conditions. </p>
<p>This function splits the bit array end condition to an array where the active end conditions are presented by numbers. Number for each end condition are defined in this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endcond</td><td>bit array representing marker end conditions </td></tr>
    <tr><td class="paramname">endconds</td><td>integer array large enough to hold all end conditions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="endcond_8c_source.html#l00543">543</a> of file <a class="el" href="endcond_8c_source.html">endcond.c</a>.</p>

</div>
</div>
<a id="af61d05ad7e7b74f37b20effb5c2e2b9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af61d05ad7e7b74f37b20effb5c2e2b9e">&#9670;&nbsp;</a></span>endcond_parse2str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void endcond_parse2str </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>endcond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Represent end condition in human-readable format. </p>
<p>This function takes end condition represented as integer, as given by <a class="el" href="endcond_8c.html#a305250a33bad6aa88ef074a81755f9d5" title="Split endcond to an array of end conditions.">endcond_parse()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endcond</td><td>end condition integer representation </td></tr>
    <tr><td class="paramname">str</td><td>end condition as human-readable string </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="endcond_8c_source.html#l00569">569</a> of file <a class="el" href="endcond_8c_source.html">endcond.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
