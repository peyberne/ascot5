<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: simulate/step/step_gc_cashkarp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ce429edffdc5ffa3d8eb198b9fed2715.html">simulate</a></li><li class="navelem"><a class="el" href="dir_981e7f90eae853288eeb79002948334a.html">step</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">step_gc_cashkarp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Guiding center integration with adaptive Cash Karp method.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br />
<code>#include &lt;float.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">../../ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__field_8h_source.html">../../B_field.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="consts_8h_source.html">../../consts.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="particle_8h_source.html">../../particle.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">../../error.h</a>&quot;</code><br />
<code>#include &quot;step_gc_cashkarp.h&quot;</code><br />
<code>#include &quot;<a class="el" href="step__gceom_8h_source.html">step_gceom.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="step__gceom__mhd_8h_source.html">step_gceom_mhd.h</a>&quot;</code><br />
</div>
<p><a href="step__gc__cashkarp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af700373779ccef7306e533dd7f102ce5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="step__gc__cashkarp_8c.html#af700373779ccef7306e533dd7f102ce5">step_gc_cashkarp</a> (<a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *p, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *h, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *hnext, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> tol, <a class="el" href="structB__field__data.html">B_field_data</a> *Bdata, <a class="el" href="structE__field__data.html">E_field_data</a> *Edata)</td></tr>
<tr class="memdesc:af700373779ccef7306e533dd7f102ce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrate a guiding center step for a struct of markers.  <a href="step__gc__cashkarp_8c.html#af700373779ccef7306e533dd7f102ce5">More...</a><br /></td></tr>
<tr class="separator:af700373779ccef7306e533dd7f102ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a354e2c792c0b5a074bdb2545ca24b7e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="step__gc__cashkarp_8c.html#a354e2c792c0b5a074bdb2545ca24b7e6">step_gc_cashkarp_mhd</a> (<a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *p, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *h, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *hnext, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> tol, <a class="el" href="structB__field__data.html">B_field_data</a> *Bdata, <a class="el" href="structE__field__data.html">E_field_data</a> *Edata, <a class="el" href="structboozer__data.html">boozer_data</a> *boozer, <a class="el" href="structmhd__data.html">mhd_data</a> *mhd)</td></tr>
<tr class="memdesc:a354e2c792c0b5a074bdb2545ca24b7e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrate a guiding center step for a struct of markers with MHD.  <a href="step__gc__cashkarp_8c.html#a354e2c792c0b5a074bdb2545ca24b7e6">More...</a><br /></td></tr>
<tr class="separator:a354e2c792c0b5a074bdb2545ca24b7e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Guiding center integration with adaptive Cash Karp method. </p>

<p class="definition">Definition in file <a class="el" href="step__gc__cashkarp_8c_source.html">step_gc_cashkarp.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af700373779ccef7306e533dd7f102ce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af700373779ccef7306e533dd7f102ce5">&#9670;&nbsp;</a></span>step_gc_cashkarp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void step_gc_cashkarp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>hnext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__data.html">B_field_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structE__field__data.html">E_field_data</a> *&#160;</td>
          <td class="paramname"><em>Edata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Integrate a guiding center step for a struct of markers. </p>
<p>This function calculates a guiding center step for a struct of NSIMD markers with Cash-Karp (adaptive RK5) simultaneously using SIMD instructions. All arrays in the function are of NSIMD length so vectorization can be performed directly without gather and scatter operations. Informs whther time step was accepted or rejected and provides a suggestion for the next time step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>marker struct that will be updated </td></tr>
    <tr><td class="paramname">h</td><td>array containing time step lengths </td></tr>
    <tr><td class="paramname">hnext</td><td>suggestion for the next time step. Negative sign indicates current step was rejected </td></tr>
    <tr><td class="paramname">tol</td><td>error tolerance </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data </td></tr>
    <tr><td class="paramname">Edata</td><td>pointer to electric field data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="step__gc__cashkarp_8c_source.html#l00035">35</a> of file <a class="el" href="step__gc__cashkarp_8c_source.html">step_gc_cashkarp.c</a>.</p>

</div>
</div>
<a id="a354e2c792c0b5a074bdb2545ca24b7e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a354e2c792c0b5a074bdb2545ca24b7e6">&#9670;&nbsp;</a></span>step_gc_cashkarp_mhd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void step_gc_cashkarp_mhd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparticle__simd__gc.html">particle_simd_gc</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>hnext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__data.html">B_field_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structE__field__data.html">E_field_data</a> *&#160;</td>
          <td class="paramname"><em>Edata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structboozer__data.html">boozer_data</a> *&#160;</td>
          <td class="paramname"><em>boozer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmhd__data.html">mhd_data</a> *&#160;</td>
          <td class="paramname"><em>mhd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Integrate a guiding center step for a struct of markers with MHD. </p>
<p>Rejected step has a negative suggestion for the next time-step. The negative sign is only used to indicate a rejected step and absolute value should be used for the next time-step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>marker struct that will be updated </td></tr>
    <tr><td class="paramname">h</td><td>array containing time step lengths </td></tr>
    <tr><td class="paramname">hnext</td><td>suggestion for the next time step. </td></tr>
    <tr><td class="paramname">tol</td><td>error tolerance </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data </td></tr>
    <tr><td class="paramname">Edata</td><td>pointer to electric field data </td></tr>
    <tr><td class="paramname">boozer</td><td>pointer to Boozer data </td></tr>
    <tr><td class="paramname">mhd</td><td>pointer to MHD data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="step__gc__cashkarp_8c_source.html#l00328">328</a> of file <a class="el" href="step__gc__cashkarp_8c_source.html">step_gc_cashkarp.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
