<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: Bfield/B_2DS.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_29b71ba18415f573d8e53f1854e02d3e.html">Bfield</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">B_2DS.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>2D magnetic field with bicubic spline interpolation  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">../ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">../error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="print_8h_source.html">../print.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__2DS_8h_source.html">B_2DS.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interp_8h_source.html">../spline/interp.h</a>&quot;</code><br />
</div>
<p><a href="B__2DS_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afcf0b85f08ad40a47972977c250f40e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#afcf0b85f08ad40a47972977c250f40e8">B_2DS_init_offload</a> (<a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:afcf0b85f08ad40a47972977c250f40e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize magnetic field offload data.  <a href="B__2DS_8c.html#afcf0b85f08ad40a47972977c250f40e8">More...</a><br /></td></tr>
<tr class="separator:afcf0b85f08ad40a47972977c250f40e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49b90b805921f5d25f3118c8db61f533"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#a49b90b805921f5d25f3118c8db61f533">B_2DS_free_offload</a> (<a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:a49b90b805921f5d25f3118c8db61f533"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free offload array.  <a href="B__2DS_8c.html#a49b90b805921f5d25f3118c8db61f533">More...</a><br /></td></tr>
<tr class="separator:a49b90b805921f5d25f3118c8db61f533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561eb8a7b4605f5992ff9177d7c95f80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#a561eb8a7b4605f5992ff9177d7c95f80">B_2DS_init</a> (<a class="el" href="structB__2DS__data.html">B_2DS_data</a> *Bdata, <a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *offload_array)</td></tr>
<tr class="memdesc:a561eb8a7b4605f5992ff9177d7c95f80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize magnetic field data struct on target.  <a href="B__2DS_8c.html#a561eb8a7b4605f5992ff9177d7c95f80">More...</a><br /></td></tr>
<tr class="separator:a561eb8a7b4605f5992ff9177d7c95f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08da6625d107648011f31f183d9c6c1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#a08da6625d107648011f31f183d9c6c1e">B_2DS_eval_psi</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *psi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="structB__2DS__data.html">B_2DS_data</a> *Bdata)</td></tr>
<tr class="memdesc:a08da6625d107648011f31f183d9c6c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate poloidal flux psi.  <a href="B__2DS_8c.html#a08da6625d107648011f31f183d9c6c1e">More...</a><br /></td></tr>
<tr class="separator:a08da6625d107648011f31f183d9c6c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f274daf37a8fa9197d24f5118f74e05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#a6f274daf37a8fa9197d24f5118f74e05">B_2DS_eval_psi_dpsi</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> psi_dpsi[4], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="structB__2DS__data.html">B_2DS_data</a> *Bdata)</td></tr>
<tr class="memdesc:a6f274daf37a8fa9197d24f5118f74e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate poloidal flux psi and its derivatives.  <a href="B__2DS_8c.html#a6f274daf37a8fa9197d24f5118f74e05">More...</a><br /></td></tr>
<tr class="separator:a6f274daf37a8fa9197d24f5118f74e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d2d2b34991c91a0f4dab381780a3ca4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#a7d2d2b34991c91a0f4dab381780a3ca4">B_2DS_eval_rho_drho</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> rho_drho[4], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="structB__2DS__data.html">B_2DS_data</a> *Bdata)</td></tr>
<tr class="memdesc:a7d2d2b34991c91a0f4dab381780a3ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate normalized poloidal flux rho and its derivatives.  <a href="B__2DS_8c.html#a7d2d2b34991c91a0f4dab381780a3ca4">More...</a><br /></td></tr>
<tr class="separator:a7d2d2b34991c91a0f4dab381780a3ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3dfebc629c27dbbcf227fbbdc81000d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#aa3dfebc629c27dbbcf227fbbdc81000d">B_2DS_eval_B</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> B[3], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="structB__2DS__data.html">B_2DS_data</a> *Bdata)</td></tr>
<tr class="memdesc:aa3dfebc629c27dbbcf227fbbdc81000d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate magnetic field.  <a href="B__2DS_8c.html#aa3dfebc629c27dbbcf227fbbdc81000d">More...</a><br /></td></tr>
<tr class="separator:aa3dfebc629c27dbbcf227fbbdc81000d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2078677105f9bdc040b813cc7932563"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#af2078677105f9bdc040b813cc7932563">B_2DS_eval_B_dB</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> B_dB[12], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="structB__2DS__data.html">B_2DS_data</a> *Bdata)</td></tr>
<tr class="memdesc:af2078677105f9bdc040b813cc7932563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate magnetic field and its derivatives.  <a href="B__2DS_8c.html#af2078677105f9bdc040b813cc7932563">More...</a><br /></td></tr>
<tr class="separator:af2078677105f9bdc040b813cc7932563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1653b70b0d0f8a85e79f30e5b793489"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="B__2DS_8c.html#ad1653b70b0d0f8a85e79f30e5b793489">B_2DS_get_axis_rz</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> rz[2], <a class="el" href="structB__2DS__data.html">B_2DS_data</a> *Bdata)</td></tr>
<tr class="memdesc:ad1653b70b0d0f8a85e79f30e5b793489"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return magnetic axis R-coordinate.  <a href="B__2DS_8c.html#ad1653b70b0d0f8a85e79f30e5b793489">More...</a><br /></td></tr>
<tr class="separator:ad1653b70b0d0f8a85e79f30e5b793489"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>2D magnetic field with bicubic spline interpolation </p>
<p>This module represents a magnetic field where data is given in <img class="formulaInl" alt="$Rz$" src="form_3.png"/>-grid from which it is interpolated with bicubic splines. The field is axisymmetric.</p>
<p>The magnetic field is evaluated from magnetic field strength <img class="formulaInl" alt="$\mathbf{B}$" src="form_4.png"/> which may not be divergence free. However, <img class="formulaInl" alt="$B_R$" src="form_5.png"/> and <img class="formulaInl" alt="$B_z$" src="form_6.png"/> components are also evaluated from poloidal magnetic flux <img class="formulaInl" alt="$\psi$" src="form_7.png"/> as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{align*} B_R &amp;= -\frac{1}{R}\frac{\partial\psi}{\partial z}\\ B_z &amp;= \frac{1}{R}\frac{\partial\psi}{\partial R} \end{align*}" src="form_8.png"/>
</p>
<p>The total field is then a sum of components interpolated directly from <img class="formulaInl" alt="$\mathbf{B}$" src="form_4.png"/> and components calculated via interpolated <img class="formulaInl" alt="$\psi$" src="form_7.png"/>.</p>
<p>This module does no extrapolation so if queried value is outside the <img class="formulaInl" alt="$Rz$" src="form_3.png"/>-grid an error is thrown.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="B__field_8c.html" title="Magnetic field interface.">B_field.c</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="afcf0b85f08ad40a47972977c250f40e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcf0b85f08ad40a47972977c250f40e8">&#9670;&nbsp;</a></span>B_2DS_init_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int B_2DS_init_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize magnetic field offload data. </p>
<p>This function takes pre-initialized offload data struct and offload array as inputs. The data is used to fill rest of the offload struct and to construct bicubic splines whose coefficients are stored in re-allocated offload array.</p>
<p>The offload data struct must have the following fields initialized:</p><ul>
<li><a class="el" href="structB__2DS__offload__data.html#addf5df6f915db09eb31d29799ccd5639">B_2DS_offload_data.n_r</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#ab86d47e5b73a92ff3fe159d74e523689">B_2DS_offload_data.n_z</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#a418602c29d6c0df4ac66734b816d2c0b">B_2DS_offload_data.r_min</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#ababc441c792513809c9ed1d0ca968c98">B_2DS_offload_data.r_max</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#afdd9302b0382e9eeb4170f8552321e6b">B_2DS_offload_data.z_min</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#a8c732a018fd42ea8cb26a60ca7c52cd9">B_2DS_offload_data.z_max</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#a4c0ddcb58db1e81e0fcc5650816518ac">B_2DS_offload_data.psi0</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#a7070c387117e51ecc62706bdb6578cd5">B_2DS_offload_data.psi1</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#a3d51a05eb8ae586fe8e91e6022fab5f3">B_2DS_offload_data.axis_r</a></li>
<li><a class="el" href="structB__2DS__offload__data.html#a2ceea2ea7c4ff422e4ff1f90c7ba71ff">B_2DS_offload_data.axis_z</a></li>
</ul>
<p><a class="el" href="structB__2DS__offload__data.html#a969cc9e6388b75c91e81f6fe902b56dc">B_2DS_offload_data.offload_array_length</a> is set here.</p>
<p>The offload array must contain the following data:</p><ul>
<li>offload_array[ j*n_r + i] = psi(R_i, z_j) [V*s*m^-1]</li>
<li>offload_array[ n_r*n_z + j*n_r + i] = B_R(R_i, z_j) [T]</li>
<li>offload_array[2*n_r*n_z + j*n_r + i] = B_phi(R_i, z_j) [T]</li>
<li>offload_array[3*n_r*n_z + j*n_r + i] = B_z(R_i, z_j) [T]</li>
</ul>
<p>Sanity checks are printed if data was initialized succesfully.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array which is reallocated here</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if initialization succeeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00069">69</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="a49b90b805921f5d25f3118c8db61f533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49b90b805921f5d25f3118c8db61f533">&#9670;&nbsp;</a></span>B_2DS_free_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void B_2DS_free_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free offload array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00163">163</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="a561eb8a7b4605f5992ff9177d7c95f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a561eb8a7b4605f5992ff9177d7c95f80">&#9670;&nbsp;</a></span>B_2DS_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void B_2DS_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structB__2DS__data.html">B_2DS_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__offload__data.html">B_2DS_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize magnetic field data struct on target. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Bdata</td><td>pointer to data struct on target </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00176">176</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="a08da6625d107648011f31f183d9c6c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08da6625d107648011f31f183d9c6c1e">&#9670;&nbsp;</a></span>B_2DS_eval_psi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> B_2DS_eval_psi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__data.html">B_2DS_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate poloidal flux psi. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psi</td><td>pointer where psi [V*s*m^-1] value will be stored </td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00237">237</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="a6f274daf37a8fa9197d24f5118f74e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f274daf37a8fa9197d24f5118f74e05">&#9670;&nbsp;</a></span>B_2DS_eval_psi_dpsi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> B_2DS_eval_psi_dpsi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>psi_dpsi</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__data.html">B_2DS_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate poloidal flux psi and its derivatives. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psi_dpsi</td><td>pointer for storing psi [V*s*m^-1] and its derivatives </td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00260">260</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="a7d2d2b34991c91a0f4dab381780a3ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d2d2b34991c91a0f4dab381780a3ca4">&#9670;&nbsp;</a></span>B_2DS_eval_rho_drho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> B_2DS_eval_rho_drho </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>rho_drho</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__data.html">B_2DS_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate normalized poloidal flux rho and its derivatives. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rho_drho</td><td>pointer where rho and its derivatives will be stored </td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00291">291</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="aa3dfebc629c27dbbcf227fbbdc81000d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3dfebc629c27dbbcf227fbbdc81000d">&#9670;&nbsp;</a></span>B_2DS_eval_B()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> B_2DS_eval_B </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>B</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__data.html">B_2DS_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate magnetic field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">B</td><td>pointer to array where magnetic field values are stored </td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [deg] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00329">329</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="af2078677105f9bdc040b813cc7932563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2078677105f9bdc040b813cc7932563">&#9670;&nbsp;</a></span>B_2DS_eval_B_dB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> B_2DS_eval_B_dB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>B_dB</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__data.html">B_2DS_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate magnetic field and its derivatives. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">B_dB</td><td>pointer to array where the field and its derivatives are stored </td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [deg] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00375">375</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
<a id="ad1653b70b0d0f8a85e79f30e5b793489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1653b70b0d0f8a85e79f30e5b793489">&#9670;&nbsp;</a></span>B_2DS_get_axis_rz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> B_2DS_get_axis_rz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>rz</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__2DS__data.html">B_2DS_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return magnetic axis R-coordinate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rz</td><td>pointer where axis R and z [m] values will be stored </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero a5err value as this function can't fail. </dd></dl>

<p class="definition">Definition at line <a class="el" href="B__2DS_8c_source.html#l00444">444</a> of file <a class="el" href="B__2DS_8c_source.html">B_2DS.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
