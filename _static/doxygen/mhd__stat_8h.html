<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: mhd/mhd_stat.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_79491137e1177fa768b3b903dca657ee.html">mhd</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mhd_stat.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="mhd__stat_8c.html" title="MHD module for stationary amplitudes (eigenmodes).">mhd_stat.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ascot5_8h_source.html">../ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">../error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="boozer_8h_source.html">../boozer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interp_8h_source.html">../spline/interp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__field_8h_source.html">../B_field.h</a>&quot;</code><br />
</div>
<p><a href="mhd__stat_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmhd__stat__offload__data.html">mhd_stat_offload_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">MHD stat parameters that will be offloaded to target.  <a href="structmhd__stat__offload__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmhd__stat__data.html">mhd_stat_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">MHD stat parameters on the target.  <a href="structmhd__stat__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac5996ebe06a8c655fa616339b6bb69df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd__stat_8h.html#ac5996ebe06a8c655fa616339b6bb69df">mhd_stat_init_offload</a> (<a class="el" href="structmhd__stat__offload__data.html">mhd_stat_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:ac5996ebe06a8c655fa616339b6bb69df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load MHD data and prepare parameters for offload.  <a href="mhd__stat_8h.html#ac5996ebe06a8c655fa616339b6bb69df">More...</a><br /></td></tr>
<tr class="separator:ac5996ebe06a8c655fa616339b6bb69df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a018676d10b4c1d541e99dd65b5e6825e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd__stat_8h.html#a018676d10b4c1d541e99dd65b5e6825e">mhd_stat_free_offload</a> (<a class="el" href="structmhd__stat__offload__data.html">mhd_stat_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array)</td></tr>
<tr class="memdesc:a018676d10b4c1d541e99dd65b5e6825e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free offload array.  <a href="mhd__stat_8h.html#a018676d10b4c1d541e99dd65b5e6825e">More...</a><br /></td></tr>
<tr class="separator:a018676d10b4c1d541e99dd65b5e6825e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d2a7bb65f7f24605f04484f443e594f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd__stat_8h.html#a4d2a7bb65f7f24605f04484f443e594f">mhd_stat_init</a> (<a class="el" href="structmhd__stat__data.html">mhd_stat_data</a> *mhdata, <a class="el" href="structmhd__stat__offload__data.html">mhd_stat_offload_data</a> *offload_data, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *offload_array)</td></tr>
<tr class="memdesc:a4d2a7bb65f7f24605f04484f443e594f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize MHD data struct on target.  <a href="mhd__stat_8h.html#a4d2a7bb65f7f24605f04484f443e594f">More...</a><br /></td></tr>
<tr class="separator:a4d2a7bb65f7f24605f04484f443e594f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a942de062f19ef52b392c7298028d6952"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd__stat_8h.html#a942de062f19ef52b392c7298028d6952">mhd_stat_eval</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> mhd_dmhd[10], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t, int includemode, <a class="el" href="structboozer__data.html">boozer_data</a> *boozerdata, <a class="el" href="structmhd__stat__data.html">mhd_stat_data</a> *mhddata, <a class="el" href="structB__field__data.html">B_field_data</a> *Bdata)</td></tr>
<tr class="memdesc:a942de062f19ef52b392c7298028d6952"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the needed quantities from MHD mode for orbit following.  <a href="mhd__stat_8h.html#a942de062f19ef52b392c7298028d6952">More...</a><br /></td></tr>
<tr class="separator:a942de062f19ef52b392c7298028d6952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6428e4aefd0cf39446bb7c428f92bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mhd__stat_8h.html#a7d6428e4aefd0cf39446bb7c428f92bd">mhd_stat_perturbations</a> (<a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> pert_field[7], <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> r, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> phi, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> z, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> t, int pertonly, int includemode, <a class="el" href="structboozer__data.html">boozer_data</a> *boozerdata, <a class="el" href="structmhd__stat__data.html">mhd_stat_data</a> *mhddata, <a class="el" href="structB__field__data.html">B_field_data</a> *Bdata)</td></tr>
<tr class="memdesc:a7d6428e4aefd0cf39446bb7c428f92bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate perturbed fields Btilde, Etilde and potential Phi explicitly.  <a href="mhd__stat_8h.html#a7d6428e4aefd0cf39446bb7c428f92bd">More...</a><br /></td></tr>
<tr class="separator:a7d6428e4aefd0cf39446bb7c428f92bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="mhd__stat_8c.html" title="MHD module for stationary amplitudes (eigenmodes).">mhd_stat.c</a>. </p>

<p class="definition">Definition in file <a class="el" href="mhd__stat_8h_source.html">mhd_stat.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac5996ebe06a8c655fa616339b6bb69df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5996ebe06a8c655fa616339b6bb69df">&#9670;&nbsp;</a></span>mhd_stat_init_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mhd_stat_init_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__stat__offload__data.html">mhd_stat_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load MHD data and prepare parameters for offload. </p>
<p>This function fills the MHD offload struct with parameters and allocates and fills the offload array. Sets offload array length in the offload struct.</p>
<p>It is assumed that the offload_data struct is completely filled before calling this function (except for the offload_array_length and rhogrid). Furthermore, offload array should contain following data:</p>
<ul>
<li>offload_array[j*nrho + i] : alpha(mode_j, rho_i).</li>
<li>offload_array[n_modes*nrho + j*nrho + i] : phi(mode_j, rho_i).</li>
</ul>
<p>1D splines are constructed here and stored to offload array which is reallocated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if initialization succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd__stat_8c_source.html#l00037">37</a> of file <a class="el" href="mhd__stat_8c_source.html">mhd_stat.c</a>.</p>

</div>
</div>
<a id="a018676d10b4c1d541e99dd65b5e6825e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a018676d10b4c1d541e99dd65b5e6825e">&#9670;&nbsp;</a></span>mhd_stat_free_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mhd_stat_free_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__stat__offload__data.html">mhd_stat_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free offload array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to pointer to offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mhd__stat_8c_source.html#l00100">100</a> of file <a class="el" href="mhd__stat_8c_source.html">mhd_stat.c</a>.</p>

</div>
</div>
<a id="a4d2a7bb65f7f24605f04484f443e594f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d2a7bb65f7f24605f04484f443e594f">&#9670;&nbsp;</a></span>mhd_stat_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mhd_stat_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmhd__stat__data.html">mhd_stat_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmhd__stat__offload__data.html">mhd_stat_offload_data</a> *&#160;</td>
          <td class="paramname"><em>offload_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize MHD data struct on target. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhddata</td><td>pointer to data struct on target </td></tr>
    <tr><td class="paramname">offload_data</td><td>pointer to offload data struct </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mhd__stat_8c_source.html#l00112">112</a> of file <a class="el" href="mhd__stat_8c_source.html">mhd_stat.c</a>.</p>

</div>
</div>
<a id="a942de062f19ef52b392c7298028d6952"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a942de062f19ef52b392c7298028d6952">&#9670;&nbsp;</a></span>mhd_stat_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> mhd_stat_eval </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>mhd_dmhd</em>[10], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>includemode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structboozer__data.html">boozer_data</a> *&#160;</td>
          <td class="paramname"><em>boozerdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmhd__stat__data.html">mhd_stat_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__data.html">B_field_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the needed quantities from MHD mode for orbit following. </p>
<p>The quantities to be evaluated are alpha, phi, grad alpha, grad phi, partial t alpha, partial t phi</p>
<p>The values are stored in the given array as:</p><ul>
<li>mhd_dmhd[0] = alpha</li>
<li>mhd_dmhd[1] = dalpha/dt</li>
<li>mhd_dmhd[2] = grad alpha, r component</li>
<li>mhd_dmhd[3] = grad alpha, phi component</li>
<li>mhd_dmhd[4] = grad alpha, z component</li>
<li>mhd_dmhd[5] = phi</li>
<li>mhd_dmhd[6] = dphi/dt</li>
<li>mhd_dmhd[7] = grad phi, r component</li>
<li>mhd_dmhd[8] = grad phi, phi component</li>
<li>mhd_dmhd[9] = grad phi, z component</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mhd_dmhd</td><td></td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">t</td><td>time coordinate [s] </td></tr>
    <tr><td class="paramname">includemode</td><td>mode number to include or MHD_INCLUDE_ALL </td></tr>
    <tr><td class="paramname">boozerdata</td><td>pointer to boozer data </td></tr>
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd__stat_8c_source.html#l00174">174</a> of file <a class="el" href="mhd__stat_8c_source.html">mhd_stat.c</a>.</p>

</div>
</div>
<a id="a7d6428e4aefd0cf39446bb7c428f92bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6428e4aefd0cf39446bb7c428f92bd">&#9670;&nbsp;</a></span>mhd_stat_perturbations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="error_8h.html#a3bca029fa2975420f00b89f3cb38872e">a5err</a> mhd_stat_perturbations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>pert_field</em>[7], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pertonly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>includemode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structboozer__data.html">boozer_data</a> *&#160;</td>
          <td class="paramname"><em>boozerdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmhd__stat__data.html">mhd_stat_data</a> *&#160;</td>
          <td class="paramname"><em>mhddata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structB__field__data.html">B_field_data</a> *&#160;</td>
          <td class="paramname"><em>Bdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate perturbed fields Btilde, Etilde and potential Phi explicitly. </p>
<p>The values are stored in the given array as</p><ul>
<li>pert_field[0] = BtildeR</li>
<li>pert_field[1] = BtildePhi</li>
<li>pert_field[2] = BtildeZ</li>
<li>pert_field[3] = EtildeR</li>
<li>pert_field[4] = EtildePhi</li>
<li>pert_field[5] = EtildeZ</li>
<li>pert_field[6] = Phi</li>
</ul>
<p>Only the perturbation values for the magnetic field are returned if pertonly=1, otherwise, the total perturbed field is returned. This is done to avoid double evaluation of the magnetic field e.g. in field line tracing. For electric field only the perturbation component is returned always.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pert_field</td><td>perturbation field components </td></tr>
    <tr><td class="paramname">r</td><td>R coordinate [m] </td></tr>
    <tr><td class="paramname">phi</td><td>phi coordinate [rad] </td></tr>
    <tr><td class="paramname">z</td><td>z coordinate [m] </td></tr>
    <tr><td class="paramname">t</td><td>time coordinate [s] </td></tr>
    <tr><td class="paramname">pertonly</td><td>flag whether to return the whole field or only perturbation </td></tr>
    <tr><td class="paramname">includemode</td><td>mode number to include or MHD_INCLUDE_ALL </td></tr>
    <tr><td class="paramname">boozerdata</td><td>pointer to boozer data </td></tr>
    <tr><td class="paramname">mhddata</td><td>pointer to mhd data </td></tr>
    <tr><td class="paramname">Bdata</td><td>pointer to magnetic field data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Non-zero a5err value if evaluation failed, zero otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="mhd__stat_8c_source.html#l00299">299</a> of file <a class="el" href="mhd__stat_8c_source.html">mhd_stat.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
