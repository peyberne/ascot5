<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: offload.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">offload.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Offload functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="offload_8h_source.html">offload.h</a>&quot;</code><br />
</div>
<p><a href="offload_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9e16efa6e08de658a942cbefc9ec2bf0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="offload_8c.html#a9e16efa6e08de658a942cbefc9ec2bf0">offload_init_offload</a> (<a class="el" href="structoffload__package.html">offload_package</a> *o, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, int **int_offload_array)</td></tr>
<tr class="memdesc:a9e16efa6e08de658a942cbefc9ec2bf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize offload package.  <a href="offload_8c.html#a9e16efa6e08de658a942cbefc9ec2bf0">More...</a><br /></td></tr>
<tr class="separator:a9e16efa6e08de658a942cbefc9ec2bf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2522f11c93446eb6000b6b437f42a89f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="offload_8c.html#a2522f11c93446eb6000b6b437f42a89f">offload_free_offload</a> (<a class="el" href="structoffload__package.html">offload_package</a> *o, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, int **int_offload_array)</td></tr>
<tr class="memdesc:a2522f11c93446eb6000b6b437f42a89f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free offload array and set <a class="el" href="structoffload__package.html" title="Struct to keep track of the offload array length and unpack status.">offload_package</a> to clean state.  <a href="offload_8c.html#a2522f11c93446eb6000b6b437f42a89f">More...</a><br /></td></tr>
<tr class="separator:a2522f11c93446eb6000b6b437f42a89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab007fc10b186bccd0f8edf82d3358f9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="offload_8c.html#ab007fc10b186bccd0f8edf82d3358f9e">offload_pack</a> (<a class="el" href="structoffload__package.html">offload_package</a> *o, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **offload_array, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *pack_array, size_t pack_length, int **int_offload_array, int *int_pack_array, size_t int_pack_length)</td></tr>
<tr class="memdesc:ab007fc10b186bccd0f8edf82d3358f9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack an offload array to package array.  <a href="offload_8c.html#ab007fc10b186bccd0f8edf82d3358f9e">More...</a><br /></td></tr>
<tr class="separator:ab007fc10b186bccd0f8edf82d3358f9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a898aa698f5064914e42d7cdc897ea3e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="offload_8c.html#a898aa698f5064914e42d7cdc897ea3e7">offload_unpack</a> (<a class="el" href="structoffload__package.html">offload_package</a> *o, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *offload_array, size_t pack_length, int *int_offload_array, size_t int_pack_length, <a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **ptr, int **intptr)</td></tr>
<tr class="memdesc:a898aa698f5064914e42d7cdc897ea3e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpack offload array from the package.  <a href="offload_8c.html#a898aa698f5064914e42d7cdc897ea3e7">More...</a><br /></td></tr>
<tr class="separator:a898aa698f5064914e42d7cdc897ea3e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Offload functions. </p>
<p>An offload package that is used to collect all offload arrays into a single one so that offloading can be done nice and clean. <a class="el" href="offload_8c.html#ab007fc10b186bccd0f8edf82d3358f9e" title="Pack an offload array to package array.">offload_pack()</a> takes an offload data array and appends it to the common offload array. <a class="el" href="offload_8c.html#a898aa698f5064914e42d7cdc897ea3e7" title="Unpack offload array from the package.">offload_unpack()</a> returns a pointer at the start of the common offload array. <a class="el" href="offload_8c.html#a898aa698f5064914e42d7cdc897ea3e7" title="Unpack offload array from the package.">offload_unpack()</a> must be called in the same order as <a class="el" href="offload_8c.html#ab007fc10b186bccd0f8edf82d3358f9e" title="Pack an offload array to package array.">offload_pack()</a> was called when data was packaged.</p>
<p>Since input data may contain both floats and integers, we store those separately (i.e. there is one common offload array for floats and one common offload array for integers). </p>

<p class="definition">Definition in file <a class="el" href="offload_8c_source.html">offload.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9e16efa6e08de658a942cbefc9ec2bf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e16efa6e08de658a942cbefc9ec2bf0">&#9670;&nbsp;</a></span>offload_init_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void offload_init_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structoffload__package.html">offload_package</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>int_offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize offload package. </p>
<p>Sets offload_package.pack_array_length and <a class="el" href="structoffload__package.html#a6195bbcd9526f1ceec93b22b4a9489f6">offload_package.unpack_pos</a> to zero and assigns NULL to offload_array pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>uninitialized offload package </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to packarray </td></tr>
    <tr><td class="paramname">int_offload_array</td><td>pointer to int packarray </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="offload_8c_source.html#l00031">31</a> of file <a class="el" href="offload_8c_source.html">offload.c</a>.</p>

</div>
</div>
<a id="a2522f11c93446eb6000b6b437f42a89f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2522f11c93446eb6000b6b437f42a89f">&#9670;&nbsp;</a></span>offload_free_offload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void offload_free_offload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structoffload__package.html">offload_package</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>int_offload_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free offload array and set <a class="el" href="structoffload__package.html" title="Struct to keep track of the offload array length and unpack status.">offload_package</a> to clean state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>offload package </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload_array </td></tr>
    <tr><td class="paramname">int_offload_array</td><td>pointer to int packarray </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="offload_8c_source.html#l00049">49</a> of file <a class="el" href="offload_8c_source.html">offload.c</a>.</p>

</div>
</div>
<a id="ab007fc10b186bccd0f8edf82d3358f9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab007fc10b186bccd0f8edf82d3358f9e">&#9670;&nbsp;</a></span>offload_pack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void offload_pack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structoffload__package.html">offload_package</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>pack_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pack_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>int_offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>int_pack_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>int_pack_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pack an offload array to package array. </p>
<p>Reallocates the offload array so that the new data from the package array can be appended. Once the data has been appended, the old offload array is freed. The new length of the offload array is stored to <a class="el" href="structoffload__package.html" title="Struct to keep track of the offload array length and unpack status.">offload_package</a> struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>offload package </td></tr>
    <tr><td class="paramname">offload_array</td><td>pointer to offload array where data will be packed </td></tr>
    <tr><td class="paramname">pack_array</td><td>pack array containing the data to be appended </td></tr>
    <tr><td class="paramname">pack_length</td><td>length of the offload_array </td></tr>
    <tr><td class="paramname">int_offload_array</td><td>pointer to offload array where integer data will be packed </td></tr>
    <tr><td class="paramname">int_pack_array</td><td>pack array containing the integer data to be appended </td></tr>
    <tr><td class="paramname">int_pack_length</td><td>length of the int_offload_array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="offload_8c_source.html#l00078">78</a> of file <a class="el" href="offload_8c_source.html">offload.c</a>.</p>

</div>
</div>
<a id="a898aa698f5064914e42d7cdc897ea3e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a898aa698f5064914e42d7cdc897ea3e7">&#9670;&nbsp;</a></span>offload_unpack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void offload_unpack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structoffload__package.html">offload_package</a> *&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> *&#160;</td>
          <td class="paramname"><em>offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pack_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>int_offload_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>int_pack_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> **&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>intptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unpack offload array from the package. </p>
<p>The data is not actually moved anywhere. Unpacking means that pointers to the start of packed offload arrays are returned. Unpacking must be done in the same order as data was packed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>offload package </td></tr>
    <tr><td class="paramname">offload_array</td><td>offload array </td></tr>
    <tr><td class="paramname">pack_length</td><td>length of the data that is unpacked </td></tr>
    <tr><td class="paramname">int_offload_array</td><td>int offload array </td></tr>
    <tr><td class="paramname">int_pack_length</td><td></td></tr>
    <tr><td class="paramname">ptr</td><td>pointer where the unpacked data begins </td></tr>
    <tr><td class="paramname">intptr</td><td>pointer where the unpacked int data begins </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="offload_8c_source.html#l00137">137</a> of file <a class="el" href="offload_8c_source.html">offload.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
