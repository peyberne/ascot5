<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASCOT5: simulate/simulate_ml_adaptive.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ASCOT5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ce429edffdc5ffa3d8eb198b9fed2715.html">simulate</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">simulate_ml_adaptive.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Simulate magnetic field-lines using adaptive time-step.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;immintrin.h&gt;</code><br />
<code>#include &lt;<a class="el" href="math_8h_source.html">math.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="ascot5_8h_source.html">../ascot5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="simulate_8h_source.html">../simulate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="particle_8h_source.html">../particle.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="wall_8h_source.html">../wall.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="diag_8h_source.html">../diag.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="B__field_8h_source.html">../B_field.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="E__field_8h_source.html">../E_field.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="simulate__ml__adaptive_8h_source.html">simulate_ml_adaptive.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="step__ml__cashkarp_8h_source.html">step/step_ml_cashkarp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="endcond_8h_source.html">../endcond.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="consts_8h_source.html">../consts.h</a>&quot;</code><br />
</div>
<p><a href="simulate__ml__adaptive_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afbcb6acb6dac01cc7688d48988f8ee2b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate__ml__adaptive_8c.html#afbcb6acb6dac01cc7688d48988f8ee2b">MAGNETIC_FIELD_LINE_INISTEP</a>&#160;&#160;&#160;1.0e-2</td></tr>
<tr class="separator:afbcb6acb6dac01cc7688d48988f8ee2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407f2d4bc260e78c45346486db173d81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate__ml__adaptive_8c.html#a407f2d4bc260e78c45346486db173d81">DUMMY_STEP_VAL</a>&#160;&#160;&#160;100.0</td></tr>
<tr class="separator:a407f2d4bc260e78c45346486db173d81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1e090b3d34923a0d7c6d7f5bfcda6abb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate__ml__adaptive_8c.html#a1e090b3d34923a0d7c6d7f5bfcda6abb">simulate_ml_adaptive_inidt</a> (<a class="el" href="structsim__data.html">sim_data</a> *sim, <a class="el" href="structparticle__simd__ml.html">particle_simd_ml</a> *p, int i)</td></tr>
<tr class="memdesc:a1e090b3d34923a0d7c6d7f5bfcda6abb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates initial time step value.  <a href="simulate__ml__adaptive_8c.html#a1e090b3d34923a0d7c6d7f5bfcda6abb">More...</a><br /></td></tr>
<tr class="separator:a1e090b3d34923a0d7c6d7f5bfcda6abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e01bdd1c62ba3e6ac3440c412be9fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate__ml__adaptive_8c.html#a34e01bdd1c62ba3e6ac3440c412be9fa">simulate_ml_adaptive</a> (<a class="el" href="structparticle__queue.html">particle_queue</a> *pq, <a class="el" href="structsim__data.html">sim_data</a> *sim)</td></tr>
<tr class="memdesc:a34e01bdd1c62ba3e6ac3440c412be9fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates magnetic field-lines using adaptive time-step.  <a href="simulate__ml__adaptive_8c.html#a34e01bdd1c62ba3e6ac3440c412be9fa">More...</a><br /></td></tr>
<tr class="separator:a34e01bdd1c62ba3e6ac3440c412be9fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simulate magnetic field-lines using adaptive time-step. </p>

<p class="definition">Definition in file <a class="el" href="simulate__ml__adaptive_8c_source.html">simulate_ml_adaptive.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afbcb6acb6dac01cc7688d48988f8ee2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbcb6acb6dac01cc7688d48988f8ee2b">&#9670;&nbsp;</a></span>MAGNETIC_FIELD_LINE_INISTEP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAGNETIC_FIELD_LINE_INISTEP&#160;&#160;&#160;1.0e-2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initial step size in meters <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="simulate__ml__adaptive_8c_source.html#l00029">29</a> of file <a class="el" href="simulate__ml__adaptive_8c_source.html">simulate_ml_adaptive.c</a>.</p>

</div>
</div>
<a id="a407f2d4bc260e78c45346486db173d81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a407f2d4bc260e78c45346486db173d81">&#9670;&nbsp;</a></span>DUMMY_STEP_VAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DUMMY_STEP_VAL&#160;&#160;&#160;100.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dummy orbit step val in meters </p>

<p class="definition">Definition at line <a class="el" href="simulate__ml__adaptive_8c_source.html#l00030">30</a> of file <a class="el" href="simulate__ml__adaptive_8c_source.html">simulate_ml_adaptive.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1e090b3d34923a0d7c6d7f5bfcda6abb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e090b3d34923a0d7c6d7f5bfcda6abb">&#9670;&nbsp;</a></span>simulate_ml_adaptive_inidt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ascot5_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a> simulate_ml_adaptive_inidt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsim__data.html">sim_data</a> *&#160;</td>
          <td class="paramname"><em>sim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle__simd__ml.html">particle_simd_ml</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates initial time step value. </p>
<p>The time step value (in units of meters) is defined by MAGNETIC_FIELD_LINE_INISTEP</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sim</td><td>pointer to simulation data struct </td></tr>
    <tr><td class="paramname">p</td><td>SIMD array of markers </td></tr>
    <tr><td class="paramname">i</td><td>index of marker for which time step is assessed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Calculated time step </dd></dl>

<p class="definition">Definition at line <a class="el" href="simulate__ml__adaptive_8c_source.html#l00237">237</a> of file <a class="el" href="simulate__ml__adaptive_8c_source.html">simulate_ml_adaptive.c</a>.</p>

</div>
</div>
<a id="a34e01bdd1c62ba3e6ac3440c412be9fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34e01bdd1c62ba3e6ac3440c412be9fa">&#9670;&nbsp;</a></span>simulate_ml_adaptive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simulate_ml_adaptive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparticle__queue.html">particle_queue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsim__data.html">sim_data</a> *&#160;</td>
          <td class="paramname"><em>sim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulates magnetic field-lines using adaptive time-step. </p>
<p>The simulation includes:</p><ul>
<li>orbit-following with Cash-Karp method</li>
</ul>
<p>The simulation is carried until all markers have met some end condition or are aborted/rejected. The final state of the markers is stored in the given marker array. Other output is stored in the diagnostic array.</p>
<p>The adaptive time-step is determined by integrator error tolerances as well as user-defined limits for how much marker state can change during a single time-step.</p>
<p>Note that even though we might refer the integration time-step as "time", in reality we are integrating over distance. The time step is therefore step in meters marker orbit is intgerated. Marker does have time in its field, but it is the global time and that is not being changed during the simulation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pq</td><td>field lines to be simulated </td></tr>
    <tr><td class="paramname">sim</td><td>simulation data struct </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="simulate__ml__adaptive_8c_source.html#l00056">56</a> of file <a class="el" href="simulate__ml__adaptive_8c_source.html">simulate_ml_adaptive.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 3 2023 12:32:41 for ASCOT5 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
